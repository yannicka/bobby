(()=>{var e={731:(e,t)=>{t.N9=function(e){e||(e={}),!("serviceWorker"in navigator)||"https:"!==window.location.protocol&&"localhost"!==window.location.hostname&&0!==window.location.hostname.indexOf("127.")||navigator.serviceWorker.register("sw.js",{})}},591:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(81),r=n.n(i),o=n(645),s=n.n(o)()(r());s.push([e.id,":root {\n  --background-color: #f7f3ef;\n  --dark-background-color: #222;\n\n  --primary-color: #177355;\n  --primary-color-darker: #053123;\n\n  --secondary-color: #cf5600;\n  --secondary-color-darker: #642d06;\n}\n\nhtml,\nbody {\n  margin: 0;\n  padding: 0;\n}\n\nhtml {\n  font-size: 1.2em;\n  scrollbar-color: var(--primary-color) rgba(0, 0, 0, 0.3);\n}\n\n/* Pour les écrans tactiles : barre de défilement fine */\n@media (pointer: coarse) {\n  html {\n    scrollbar-width: thin;\n  }\n}\n\nbody {\n  background-color: var(--background-color);\n  font-family: -apple-system, 'Ubuntu', system-ui, sans-serif;\n}\n\nbutton {\n  font: inherit;\n  color: inherit;\n}\n\np {\n  padding: 8px;\n  margin: 8px;\n}\n\nh2 {\n  padding: 8px;\n  margin: 8px;\n  margin-bottom: 0;\n  font-size: 2em;\n}\n\n.center {\n  text-align: center;\n}\n\n.overflow-hidden {\n  overflow: hidden;\n}\n\n.bg-dark {\n  background-color: var(--dark-background-color);\n}\n\n.btn {\n  padding: 10px 20px;\n  display: inline-block;\n  border: none;\n  background-color: var(--secondary-color);\n  text-align: center;\n  font-size: 1.2em;\n  color: white;\n  text-decoration: none;\n  margin: 16px auto;\n}\n\n.btn:focus,\n.btn:hover {\n  outline: 3px solid var(--secondary-color-darker);\n  cursor: pointer;\n}\n\n.btn-play {\n  padding: 20px 40px;\n  display: inline-block;\n  color: var(--secondary-color);\n  border: 2px solid currentColor;\n  border-bottom-width: 12px;\n  text-align: center;\n  font-size: 2em;\n  text-transform: uppercase;\n  text-decoration: none;\n  margin: 16px auto;\n}\n\n.btn-play:focus,\n.btn-play:hover {\n  color: var(--secondary-color-darker);\n  cursor: pointer;\n  outline: none;\n}\n\n.logo {\n  margin: 0 auto 64px auto;\n  font-size: 120px;\n  color: var(--primary-color);\n  text-transform: uppercase;\n  font-weight: normal;\n}\n\n@media (max-width: 600px), (max-height: 600px) {\n  .logo {\n    font-size: 80px;\n    margin-bottom: 32px;\n  }\n}\n\n.levels {\n  list-style: none;\n  display: grid;\n  grid-template-columns: repeat(auto-fill, 60px);\n  gap: 16px;\n  margin: 12px;\n  justify-content: center;\n  padding: 16px;\n}\n\n.level a {\n  display: block;\n  background-color: #767676;\n  padding: 20px 8px;\n  color: white;\n  text-decoration: none;\n  text-align: center;\n  border: none;\n  width: 100%;\n  box-sizing: border-box;\n}\n\n.level a:focus,\n.level a:hover {\n  outline: 3px solid var(--primary-color-darker);\n  cursor: pointer;\n}\n\n.level.accessible a {\n  background-color: #842733;\n}\n\n.level.success.accessible a {\n  background-color: var(--primary-color);\n}\n\n#topbar {\n  background-color: var(--primary-color);\n  display: flex;\n}\n\n.topbar-gamename {\n  padding: 12px;\n  color: #fff;\n  margin: 0;\n  text-align: center;\n  text-transform: uppercase;\n}\n\n.topbar-level {\n  padding: 12px;\n  color: #fff;\n}\n\n.topbar-menu {\n  margin-left: auto;\n  position: relative;\n}\n\n.topbar-button {\n  padding: 12px 18px;\n  margin: 0;\n  border: none;\n  background: transparent;\n  display: inline-block;\n  color: #fff;\n  height: 100%;\n  box-sizing: border-box;\n  text-decoration: none;\n}\n\n.topbar-button:focus,\n.topbar-button:hover {\n  background-color: rgba(0, 0, 0, 0.3);\n  outline: none;\n  cursor: pointer;\n}\n\n.topbar-menu-nav {\n  position: absolute;\n  top: 100%;\n  right: 0;\n  display: flex;\n  flex-direction: column;\n  width: 290px;\n  box-shadow: 0 0 8px 0 rgba(0, 0, 0, 0.4);\n  display: none;\n}\n\n.topbar-menu-nav-displayed {\n  display: block;\n}\n\n.topbar-nav-button {\n  padding: 12px 24px;\n  border: none;\n  background: #fff;\n  text-align: left;\n  width: 100%;\n  text-decoration: none;\n  display: inline-block;\n  color: inherit;\n  box-sizing: border-box;\n}\n\n.topbar-nav-button:focus,\n.topbar-nav-button:hover {\n  background: #ccc;\n  cursor: pointer;\n}\n\n.main-wrapper {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  overflow: auto;\n}\n\n.main-wrapper-unaligned {\n  align-items: initial;\n}\n\n.main-content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n}\n\n#bottombar {\n  background-color: var(--primary-color);\n  display: flex;\n  font-size: 80%;\n  flex-wrap: wrap;\n}\n\n#bottombar .btn {\n  background-color: rgba(0, 0, 0, 0.3);\n}\n\n#bottombar .btn:focus,\n#bottombar .btn:hover {\n  outline-color: var(--primary-color-darker);\n}\n\n#app {\n  margin: 0 auto;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n}\n\n#app-wrapper {\n  height: 100%;\n  display: grid;\n  align-content: center;\n}\n\n#game {\n  image-rendering: crisp-edges;\n  image-rendering: pixelated;\n}\n\n#joystick {\n  position: fixed;\n}\n\n@keyframes end-game-text-animation {\n  0% {\n    color: var(--primary-color-darker);\n  }\n\n  100% {\n    color: var(--secondary-color-darker);\n  }\n}\n\n#end-game {\n  position: absolute;\n  top: 44%;\n  left: 0;\n  right: 0;\n  font-size: 140%;\n  font-weight: bold;\n  animation: end-game-text-animation 2s;\n  animation-direction: alternate-reverse;\n  animation-iteration-count: infinite;\n  animation-timing-function: linear;\n}\n",""]);const a=s},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",i=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),i&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),i&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,i,r,o){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(i)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(s[l]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);i&&s[u[0]]||(void 0!==o&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=o),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),t.push(u))}},t}},81:e=>{"use strict";e.exports=function(e){return e[1]}},18:(e,t,n)=>{"use strict";var i=n(178);e.exports=function(e,t,n){var r=[],o=!1,s=-1;function a(){for(s=0;s<r.length;s+=2)try{e(r[s],i(r[s+1]),l)}catch(e){n.error(e)}s=-1}function l(){o||(o=!0,t((function(){o=!1,a()})))}return l.sync=a,{mount:function(t,n){if(null!=n&&null==n.view&&"function"!=typeof n)throw new TypeError("m.mount expects a component, not a vnode.");var o=r.indexOf(t);o>=0&&(r.splice(o,2),o<=s&&(s-=2),e(t,[])),null!=n&&(r.push(t,n),e(t,i(n),l))},redraw:l}}},223:(e,t,n)=>{"use strict";var i=n(178),r=n(373),o=n(164),s=n(249),a=n(561),l=n(562),c=n(641),u=n(542),h={};function d(e){try{return decodeURIComponent(e)}catch(t){return e}}e.exports=function(e,t){var n,p,m,f,g,v,y=null==e?null:"function"==typeof e.setImmediate?e.setImmediate:e.setTimeout,b=o.resolve(),w=!1,$=!1,x=0,k=h,S={onbeforeupdate:function(){return!(!(x=x?2:1)||h===k)},onremove:function(){e.removeEventListener("popstate",L,!1),e.removeEventListener("hashchange",E,!1)},view:function(){if(x&&h!==k){var e=[i(m,f.key,f)];return k&&(e=k.render(e[0])),e}}},B=P.SKIP={};function E(){w=!1;var i=e.location.hash;"#"!==P.prefix[0]&&(i=e.location.search+i,"?"!==P.prefix[0]&&"/"!==(i=e.location.pathname+i)[0]&&(i="/"+i));var r=i.concat().replace(/(?:%[a-f89][a-f0-9])+/gim,d).slice(P.prefix.length),o=a(r);function s(e){console.error(e),A(p,null,{replace:!0})}c(o.params,e.history.state),function e(i){for(;i<n.length;i++)if(n[i].check(o)){var a=n[i].component,l=n[i].route,c=a,u=v=function(n){if(u===v){if(n===B)return e(i+1);m=null==n||"function"!=typeof n.view&&"function"!=typeof n?"div":n,f=o.params,g=r,v=null,k=a.render?a:null,2===x?t.redraw():(x=2,t.redraw.sync())}};return void(a.view||"function"==typeof a?(a={},u(c)):a.onmatch?b.then((function(){return a.onmatch(o.params,r,l)})).then(u,r===p?null:s):u("div"))}if(r===p)throw new Error("Could not resolve default route "+p+".");A(p,null,{replace:!0})}(0)}function L(){w||(w=!0,y(E))}function A(t,n,i){if(t=s(t,n),$){L();var r=i?i.state:null,o=i?i.title:null;i&&i.replace?e.history.replaceState(r,o,P.prefix+t):e.history.pushState(r,o,P.prefix+t)}else e.location.href=P.prefix+t}function P(i,r,o){if(!i)throw new TypeError("DOM element being rendered to does not exist.");if(n=Object.keys(o).map((function(e){if("/"!==e[0])throw new SyntaxError("Routes must start with a '/'.");if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw new SyntaxError("Route parameter names must be separated with either '/', '.', or '-'.");return{route:e,component:o[e],check:l(e)}})),p=r,null!=r){var s=a(r);if(!n.some((function(e){return e.check(s)})))throw new ReferenceError("Default route doesn't match any known routes.")}"function"==typeof e.history.pushState?e.addEventListener("popstate",L,!1):"#"===P.prefix[0]&&e.addEventListener("hashchange",E,!1),$=!0,t.mount(i,S),E()}return P.set=function(e,t,n){null!=v&&((n=n||{}).replace=!0),v=null,A(e,t,n)},P.get=function(){return g},P.prefix="#!",P.Link={view:function(e){var t,n,i,o=r(e.attrs.selector||"a",u(e.attrs,["options","params","selector","onclick"]),e.children);return(o.attrs.disabled=Boolean(o.attrs.disabled))?(o.attrs.href=null,o.attrs["aria-disabled"]="true"):(t=e.attrs.options,n=e.attrs.onclick,i=s(o.attrs.href,e.attrs.params),o.attrs.href=P.prefix+i,o.attrs.onclick=function(e){var r;"function"==typeof n?r=n.call(e.currentTarget,e):null==n||"object"!=typeof n||"function"==typeof n.handleEvent&&n.handleEvent(e),!1===r||e.defaultPrevented||0!==e.button&&0!==e.which&&1!==e.which||e.currentTarget.target&&"_self"!==e.currentTarget.target||e.ctrlKey||e.metaKey||e.shiftKey||e.altKey||(e.preventDefault(),e.redraw=!1,P.set(i,null,t))}),o}},P.param=function(e){return f&&null!=e?f[e]:f},P}},262:(e,t,n)=>{"use strict";var i=n(373);i.trust=n(742),i.fragment=n(621),e.exports=i},865:(e,t,n)=>{"use strict";var i=n(262),r=n(74),o=n(165),s=function(){return i.apply(this,arguments)};s.m=i,s.trust=i.trust,s.fragment=i.fragment,s.Fragment="[",s.mount=o.mount,s.route=n(843),s.render=n(358),s.redraw=o.redraw,s.request=r.request,s.jsonp=r.jsonp,s.parseQueryString=n(874),s.buildQueryString=n(478),s.parsePathname=n(561),s.buildPathname=n(249),s.vnode=n(178),s.PromisePolyfill=n(803),s.censor=n(542),e.exports=s},165:(e,t,n)=>{"use strict";var i=n(358);e.exports=n(18)(i,"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:null,"undefined"!=typeof console?console:null)},249:(e,t,n)=>{"use strict";var i=n(478),r=n(641);e.exports=function(e,t){if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw new SyntaxError("Template parameter names must be separated by either a '/', '-', or '.'.");if(null==t)return e;var n=e.indexOf("?"),o=e.indexOf("#"),s=o<0?e.length:o,a=n<0?s:n,l=e.slice(0,a),c={};r(c,t);var u=l.replace(/:([^\/\.-]+)(\.{3})?/g,(function(e,n,i){return delete c[n],null==t[n]?e:i?t[n]:encodeURIComponent(String(t[n]))})),h=u.indexOf("?"),d=u.indexOf("#"),p=d<0?u.length:d,m=h<0?p:h,f=u.slice(0,m);n>=0&&(f+=e.slice(n,s)),h>=0&&(f+=(n<0?"?":"&")+u.slice(h,p));var g=i(c);return g&&(f+=(n<0&&h<0?"?":"&")+g),o>=0&&(f+=e.slice(o)),d>=0&&(f+=(o<0?"":"&")+u.slice(d)),f}},562:(e,t,n)=>{"use strict";var i=n(561);e.exports=function(e){var t=i(e),n=Object.keys(t.params),r=[],o=new RegExp("^"+t.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,(function(e,t,n){return null==t?"\\"+e:(r.push({k:t,r:"..."===n}),"..."===n?"(.*)":"."===n?"([^/]+)\\.":"([^/]+)"+(n||""))}))+"$");return function(e){for(var i=0;i<n.length;i++)if(t.params[n[i]]!==e.params[n[i]])return!1;if(!r.length)return o.test(e.path);var s=o.exec(e.path);if(null==s)return!1;for(i=0;i<r.length;i++)e.params[r[i].k]=r[i].r?s[i+1]:decodeURIComponent(s[i+1]);return!0}}},561:(e,t,n)=>{"use strict";var i=n(874);e.exports=function(e){var t=e.indexOf("?"),n=e.indexOf("#"),r=n<0?e.length:n,o=t<0?r:t,s=e.slice(0,o).replace(/\/{2,}/g,"/");return s?("/"!==s[0]&&(s="/"+s),s.length>1&&"/"===s[s.length-1]&&(s=s.slice(0,-1))):s="/",{path:s,params:t<0?{}:i(e.slice(t+1,r))}}},803:e=>{"use strict";var t=function(e){if(!(this instanceof t))throw new Error("Promise must be called with 'new'.");if("function"!=typeof e)throw new TypeError("executor must be a function.");var n=this,i=[],r=[],o=c(i,!0),s=c(r,!1),a=n._instance={resolvers:i,rejectors:r},l="function"==typeof setImmediate?setImmediate:setTimeout;function c(e,t){return function o(c){var h;try{if(!t||null==c||"object"!=typeof c&&"function"!=typeof c||"function"!=typeof(h=c.then))l((function(){t||0!==e.length||console.error("Possible unhandled promise rejection:",c);for(var n=0;n<e.length;n++)e[n](c);i.length=0,r.length=0,a.state=t,a.retry=function(){o(c)}}));else{if(c===n)throw new TypeError("Promise can't be resolved with itself.");u(h.bind(c))}}catch(e){s(e)}}}function u(e){var t=0;function n(e){return function(n){t++>0||e(n)}}var i=n(s);try{e(n(o),i)}catch(e){i(e)}}u(e)};t.prototype.then=function(e,n){var i,r,o=this._instance;function s(e,t,n,s){t.push((function(t){if("function"!=typeof e)n(t);else try{i(e(t))}catch(e){r&&r(e)}})),"function"==typeof o.retry&&s===o.state&&o.retry()}var a=new t((function(e,t){i=e,r=t}));return s(e,o.resolvers,i,!0),s(n,o.rejectors,r,!1),a},t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(e){return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){return t.reject(n)}))}))},t.resolve=function(e){return e instanceof t?e:new t((function(t){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.all=function(e){return new t((function(t,n){var i=e.length,r=0,o=[];if(0===e.length)t([]);else for(var s=0;s<e.length;s++)!function(s){function a(e){r++,o[s]=e,r===i&&t(o)}null==e[s]||"object"!=typeof e[s]&&"function"!=typeof e[s]||"function"!=typeof e[s].then?a(e[s]):e[s].then(a,n)}(s)}))},t.race=function(e){return new t((function(t,n){for(var i=0;i<e.length;i++)e[i].then(t,n)}))},e.exports=t},164:(e,t,n)=>{"use strict";var i=n(803);"undefined"!=typeof window?(void 0===window.Promise?window.Promise=i:window.Promise.prototype.finally||(window.Promise.prototype.finally=i.prototype.finally),e.exports=window.Promise):void 0!==n.g?(void 0===n.g.Promise?n.g.Promise=i:n.g.Promise.prototype.finally||(n.g.Promise.prototype.finally=i.prototype.finally),e.exports=n.g.Promise):e.exports=i},478:e=>{"use strict";e.exports=function(e){if("[object Object]"!==Object.prototype.toString.call(e))return"";var t=[];for(var n in e)i(n,e[n]);return t.join("&");function i(e,n){if(Array.isArray(n))for(var r=0;r<n.length;r++)i(e+"["+r+"]",n[r]);else if("[object Object]"===Object.prototype.toString.call(n))for(var r in n)i(e+"["+r+"]",n[r]);else t.push(encodeURIComponent(e)+(null!=n&&""!==n?"="+encodeURIComponent(n):""))}}},874:e=>{"use strict";function t(e){try{return decodeURIComponent(e)}catch(t){return e}}e.exports=function(e){if(""===e||null==e)return{};"?"===e.charAt(0)&&(e=e.slice(1));for(var n=e.split("&"),i={},r={},o=0;o<n.length;o++){var s=n[o].split("="),a=t(s[0]),l=2===s.length?t(s[1]):"";"true"===l?l=!0:"false"===l&&(l=!1);var c=a.split(/\]\[?|\[/),u=r;a.indexOf("[")>-1&&c.pop();for(var h=0;h<c.length;h++){var d=c[h],p=c[h+1],m=""==p||!isNaN(parseInt(p,10));if(""===d)null==i[a=c.slice(0,h).join()]&&(i[a]=Array.isArray(u)?u.length:0),d=i[a]++;else if("__proto__"===d)break;if(h===c.length-1)u[d]=l;else{var f=Object.getOwnPropertyDescriptor(u,d);null!=f&&(f=f.value),null==f&&(u[d]=f=m?[]:{}),u=f}}}return r}},358:(e,t,n)=>{"use strict";e.exports=n(452)("undefined"!=typeof window?window:null)},621:(e,t,n)=>{"use strict";var i=n(178),r=n(359);e.exports=function(){var e=r.apply(0,arguments);return e.tag="[",e.children=i.normalizeChildren(e.children),e}},373:(e,t,n)=>{"use strict";var i=n(178),r=n(359),o=n(188),s=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,a={};function l(e){for(var t in e)if(o.call(e,t))return!1;return!0}e.exports=function(e){if(null==e||"string"!=typeof e&&"function"!=typeof e&&"function"!=typeof e.view)throw Error("The selector must be either a string or a component.");var t=r.apply(1,arguments);return"string"==typeof e&&(t.children=i.normalizeChildren(t.children),"["!==e)?function(e,t){var n=t.attrs,i=o.call(n,"class"),r=i?n.class:n.className;if(t.tag=e.tag,t.attrs={},!l(e.attrs)&&!l(n)){var s={};for(var a in n)o.call(n,a)&&(s[a]=n[a]);n=s}for(var a in e.attrs)o.call(e.attrs,a)&&"className"!==a&&!o.call(n,a)&&(n[a]=e.attrs[a]);for(var a in null==r&&null==e.attrs.className||(n.className=null!=r?null!=e.attrs.className?String(e.attrs.className)+" "+String(r):r:null!=e.attrs.className?e.attrs.className:null),i&&(n.class=null),n)if(o.call(n,a)&&"key"!==a){t.attrs=n;break}return t}(a[e]||function(e){for(var t,n="div",i=[],r={};t=s.exec(e);){var o=t[1],l=t[2];if(""===o&&""!==l)n=l;else if("#"===o)r.id=l;else if("."===o)i.push(l);else if("["===t[3][0]){var c=t[6];c&&(c=c.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),"class"===t[4]?i.push(c):r[t[4]]=""===c?c:c||!0}}return i.length>0&&(r.className=i.join(" ")),a[e]={tag:n,attrs:r}}(e),t):(t.tag=e,t)}},359:(e,t,n)=>{"use strict";var i=n(178);e.exports=function(){var e,t=arguments[this],n=this+1;if(null==t?t={}:("object"!=typeof t||null!=t.tag||Array.isArray(t))&&(t={},n=this),arguments.length===n+1)e=arguments[n],Array.isArray(e)||(e=[e]);else for(e=[];n<arguments.length;)e.push(arguments[n++]);return i("",t.key,t,e)}},452:(e,t,n)=>{"use strict";var i=n(178);e.exports=function(e){var t,n=e&&e.document,r={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function o(e){return e.attrs&&e.attrs.xmlns||r[e.tag]}function s(e,t){if(e.state!==t)throw new Error("'vnode.state' must not be modified.")}function a(e){var t=e.state;try{return this.apply(t,arguments)}finally{s(e,t)}}function l(){try{return n.activeElement}catch(e){return null}}function c(e,t,n,i,r,o,s){for(var a=n;a<i;a++){var l=t[a];null!=l&&u(e,l,r,s,o)}}function u(e,t,r,s,l){var h=t.tag;if("string"==typeof h)switch(t.state={},null!=t.attrs&&O(t.attrs,t,r),h){case"#":!function(e,t,i){t.dom=n.createTextNode(t.children),w(e,t.dom,i)}(e,t,l);break;case"<":d(e,t,s,l);break;case"[":!function(e,t,i,r,o){var s=n.createDocumentFragment();if(null!=t.children){var a=t.children;c(s,a,0,a.length,i,null,r)}t.dom=s.firstChild,t.domSize=s.childNodes.length,w(e,s,o)}(e,t,r,s,l);break;default:!function(e,t,i,r,s){var a=t.tag,l=t.attrs,u=l&&l.is,h=(r=o(t)||r)?u?n.createElementNS(r,a,{is:u}):n.createElementNS(r,a):u?n.createElement(a,{is:u}):n.createElement(a);if(t.dom=h,null!=l&&function(e,t,n){"input"===e.tag&&null!=t.type&&e.dom.setAttribute("type",t.type);var i=null!=t&&"input"===e.tag&&"file"===t.type;for(var r in t)L(e,r,null,t[r],n,i)}(t,l,r),w(e,h,s),!$(t)&&null!=t.children){var d=t.children;c(h,d,0,d.length,i,null,r),"select"===t.tag&&null!=l&&function(e,t){if("value"in t)if(null===t.value)-1!==e.dom.selectedIndex&&(e.dom.value=null);else{var n=""+t.value;e.dom.value===n&&-1!==e.dom.selectedIndex||(e.dom.value=n)}"selectedIndex"in t&&L(e,"selectedIndex",null,t.selectedIndex,void 0)}(t,l)}}(e,t,r,s,l)}else!function(e,t,n,r,o){(function(e,t){var n;if("function"==typeof e.tag.view){if(e.state=Object.create(e.tag),null!=(n=e.state.view).$$reentrantLock$$)return;n.$$reentrantLock$$=!0}else{if(e.state=void 0,null!=(n=e.tag).$$reentrantLock$$)return;n.$$reentrantLock$$=!0,e.state=null!=e.tag.prototype&&"function"==typeof e.tag.prototype.view?new e.tag(e):e.tag(e)}if(O(e.state,e,t),null!=e.attrs&&O(e.attrs,e,t),e.instance=i.normalize(a.call(e.state.view,e)),e.instance===e)throw Error("A view cannot return the vnode it received as argument");n.$$reentrantLock$$=null})(t,n),null!=t.instance?(u(e,t.instance,n,r,o),t.dom=t.instance.dom,t.domSize=null!=t.dom?t.instance.domSize:0):t.domSize=0}(e,t,r,s,l)}var h={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function d(e,t,i,r){var o=t.children.match(/^\s*?<(\w+)/im)||[],s=n.createElement(h[o[1]]||"div");"http://www.w3.org/2000/svg"===i?(s.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+t.children+"</svg>",s=s.firstChild):s.innerHTML=t.children,t.dom=s.firstChild,t.domSize=s.childNodes.length,t.instance=[];for(var a,l=n.createDocumentFragment();a=s.firstChild;)t.instance.push(a),l.appendChild(a);w(e,l,r)}function p(e,t,n,i,r,o){if(t!==n&&(null!=t||null!=n))if(null==t||0===t.length)c(e,n,0,n.length,i,r,o);else if(null==n||0===n.length)x(e,t,0,t.length);else{var s=null!=t[0]&&null!=t[0].key,a=null!=n[0]&&null!=n[0].key,l=0,h=0;if(!s)for(;h<t.length&&null==t[h];)h++;if(!a)for(;l<n.length&&null==n[l];)l++;if(s!==a)x(e,t,h,t.length),c(e,n,l,n.length,i,r,o);else if(a){for(var d,p,b,w,$,S=t.length-1,B=n.length-1;S>=h&&B>=l&&(b=t[S],w=n[B],b.key===w.key);)b!==w&&m(e,b,w,i,r,o),null!=w.dom&&(r=w.dom),S--,B--;for(;S>=h&&B>=l&&(d=t[h],p=n[l],d.key===p.key);)h++,l++,d!==p&&m(e,d,p,i,v(t,h,r),o);for(;S>=h&&B>=l&&l!==B&&d.key===w.key&&b.key===p.key;)y(e,b,$=v(t,h,r)),b!==p&&m(e,b,p,i,$,o),++l<=--B&&y(e,d,r),d!==w&&m(e,d,w,i,r,o),null!=w.dom&&(r=w.dom),h++,b=t[--S],w=n[B],d=t[h],p=n[l];for(;S>=h&&B>=l&&b.key===w.key;)b!==w&&m(e,b,w,i,r,o),null!=w.dom&&(r=w.dom),B--,b=t[--S],w=n[B];if(l>B)x(e,t,h,S+1);else if(h>S)c(e,n,l,B+1,i,r,o);else{var E,L,A=r,P=B-l+1,M=new Array(P),T=0,z=0,H=2147483647,j=0;for(z=0;z<P;z++)M[z]=-1;for(z=B;z>=l;z--){null==E&&(E=f(t,h,S+1));var C=E[(w=n[z]).key];null!=C&&(H=C<H?C:-1,M[z-l]=C,b=t[C],t[C]=null,b!==w&&m(e,b,w,i,r,o),null!=w.dom&&(r=w.dom),j++)}if(r=A,j!==S-h+1&&x(e,t,h,S+1),0===j)c(e,n,l,B+1,i,r,o);else if(-1===H)for(L=function(e){var t=[0],n=0,i=0,r=0,o=g.length=e.length;for(r=0;r<o;r++)g[r]=e[r];for(r=0;r<o;++r)if(-1!==e[r]){var s=t[t.length-1];if(e[s]<e[r])g[r]=s,t.push(r);else{for(n=0,i=t.length-1;n<i;){var a=(n>>>1)+(i>>>1)+(n&i&1);e[t[a]]<e[r]?n=a+1:i=a}e[r]<e[t[n]]&&(n>0&&(g[r]=t[n-1]),t[n]=r)}}for(i=t[(n=t.length)-1];n-- >0;)t[n]=i,i=g[i];return g.length=0,t}(M),T=L.length-1,z=B;z>=l;z--)p=n[z],-1===M[z-l]?u(e,p,i,o,r):L[T]===z-l?T--:y(e,p,r),null!=p.dom&&(r=n[z].dom);else for(z=B;z>=l;z--)p=n[z],-1===M[z-l]&&u(e,p,i,o,r),null!=p.dom&&(r=n[z].dom)}}else{var I=t.length<n.length?t.length:n.length;for(l=l<h?l:h;l<I;l++)(d=t[l])===(p=n[l])||null==d&&null==p||(null==d?u(e,p,i,o,v(t,l+1,r)):null==p?k(e,d):m(e,d,p,i,v(t,l+1,r),o));t.length>I&&x(e,t,l,t.length),n.length>I&&c(e,n,l,n.length,i,r,o)}}}function m(e,t,n,r,s,l){var c=t.tag;if(c===n.tag){if(n.state=t.state,n.events=t.events,function(e,t){do{var n;if(null!=e.attrs&&"function"==typeof e.attrs.onbeforeupdate&&void 0!==(n=a.call(e.attrs.onbeforeupdate,e,t))&&!n)break;if("string"!=typeof e.tag&&"function"==typeof e.state.onbeforeupdate&&void 0!==(n=a.call(e.state.onbeforeupdate,e,t))&&!n)break;return!1}while(0);return e.dom=t.dom,e.domSize=t.domSize,e.instance=t.instance,e.attrs=t.attrs,e.children=t.children,e.text=t.text,!0}(n,t))return;if("string"==typeof c)switch(null!=n.attrs&&N(n.attrs,n,r),c){case"#":!function(e,t){e.children.toString()!==t.children.toString()&&(e.dom.nodeValue=t.children),t.dom=e.dom}(t,n);break;case"<":!function(e,t,n,i,r){t.children!==n.children?(S(e,t),d(e,n,i,r)):(n.dom=t.dom,n.domSize=t.domSize,n.instance=t.instance)}(e,t,n,l,s);break;case"[":!function(e,t,n,i,r,o){p(e,t.children,n.children,i,r,o);var s=0,a=n.children;if(n.dom=null,null!=a){for(var l=0;l<a.length;l++){var c=a[l];null!=c&&null!=c.dom&&(null==n.dom&&(n.dom=c.dom),s+=c.domSize||1)}1!==s&&(n.domSize=s)}}(e,t,n,r,s,l);break;default:!function(e,t,n,i){var r=t.dom=e.dom;i=o(t)||i,"textarea"===t.tag&&null==t.attrs&&(t.attrs={}),function(e,t,n,i){if(t&&t===n&&console.warn("Don't reuse attrs object, use new object for every redraw, this will throw in next major"),null!=n){"input"===e.tag&&null!=n.type&&e.dom.setAttribute("type",n.type);var r="input"===e.tag&&"file"===n.type;for(var o in n)L(e,o,t&&t[o],n[o],i,r)}var s;if(null!=t)for(var o in t)null==(s=t[o])||null!=n&&null!=n[o]||A(e,o,s,i)}(t,e.attrs,t.attrs,i),$(t)||p(r,e.children,t.children,n,null,i)}(t,n,r,l)}else!function(e,t,n,r,o,s){if(n.instance=i.normalize(a.call(n.state.view,n)),n.instance===n)throw Error("A view cannot return the vnode it received as argument");N(n.state,n,r),null!=n.attrs&&N(n.attrs,n,r),null!=n.instance?(null==t.instance?u(e,n.instance,r,s,o):m(e,t.instance,n.instance,r,o,s),n.dom=n.instance.dom,n.domSize=n.instance.domSize):null!=t.instance?(k(e,t.instance),n.dom=void 0,n.domSize=0):(n.dom=t.dom,n.domSize=t.domSize)}(e,t,n,r,s,l)}else k(e,t),u(e,n,r,l,s)}function f(e,t,n){for(var i=Object.create(null);t<n;t++){var r=e[t];if(null!=r){var o=r.key;null!=o&&(i[o]=t)}}return i}var g=[];function v(e,t,n){for(;t<e.length;t++)if(null!=e[t]&&null!=e[t].dom)return e[t].dom;return n}function y(e,t,i){var r=n.createDocumentFragment();b(e,r,t),w(e,r,i)}function b(e,t,n){for(;null!=n.dom&&n.dom.parentNode===e;){if("string"!=typeof n.tag){if(null!=(n=n.instance))continue}else if("<"===n.tag)for(var i=0;i<n.instance.length;i++)t.appendChild(n.instance[i]);else if("["!==n.tag)t.appendChild(n.dom);else if(1===n.children.length){if(null!=(n=n.children[0]))continue}else for(i=0;i<n.children.length;i++){var r=n.children[i];null!=r&&b(e,t,r)}break}}function w(e,t,n){null!=n?e.insertBefore(t,n):e.appendChild(t)}function $(e){if(null==e.attrs||null==e.attrs.contenteditable&&null==e.attrs.contentEditable)return!1;var t=e.children;if(null!=t&&1===t.length&&"<"===t[0].tag){var n=t[0].children;e.dom.innerHTML!==n&&(e.dom.innerHTML=n)}else if(null!=t&&0!==t.length)throw new Error("Child node of a contenteditable must be trusted.");return!0}function x(e,t,n,i){for(var r=n;r<i;r++){var o=t[r];null!=o&&k(e,o)}}function k(e,t){var n,i,r,o=0,l=t.state;if("string"!=typeof t.tag&&"function"==typeof t.state.onbeforeremove&&null!=(r=a.call(t.state.onbeforeremove,t))&&"function"==typeof r.then&&(o=1,n=r),t.attrs&&"function"==typeof t.attrs.onbeforeremove&&null!=(r=a.call(t.attrs.onbeforeremove,t))&&"function"==typeof r.then&&(o|=2,i=r),s(t,l),o){if(null!=n){var c=function(){1&o&&((o&=2)||u())};n.then(c,c)}null!=i&&(c=function(){2&o&&((o&=1)||u())},i.then(c,c))}else E(t),B(e,t);function u(){s(t,l),E(t),B(e,t)}}function S(e,t){for(var n=0;n<t.instance.length;n++)e.removeChild(t.instance[n])}function B(e,t){for(;null!=t.dom&&t.dom.parentNode===e;){if("string"!=typeof t.tag){if(null!=(t=t.instance))continue}else if("<"===t.tag)S(e,t);else{if("["!==t.tag&&(e.removeChild(t.dom),!Array.isArray(t.children)))break;if(1===t.children.length){if(null!=(t=t.children[0]))continue}else for(var n=0;n<t.children.length;n++){var i=t.children[n];null!=i&&B(e,i)}}break}}function E(e){if("string"!=typeof e.tag&&"function"==typeof e.state.onremove&&a.call(e.state.onremove,e),e.attrs&&"function"==typeof e.attrs.onremove&&a.call(e.attrs.onremove,e),"string"!=typeof e.tag)null!=e.instance&&E(e.instance);else{var t=e.children;if(Array.isArray(t))for(var n=0;n<t.length;n++){var i=t[n];null!=i&&E(i)}}}function L(e,t,i,r,o,s){if(!("key"===t||"is"===t||null==r||P(t)||i===r&&!function(e,t){return"value"===t||"checked"===t||"selectedIndex"===t||"selected"===t&&e.dom===l()||"option"===e.tag&&e.dom.parentNode===n.activeElement}(e,t)&&"object"!=typeof r||"type"===t&&"input"===e.tag)){if("o"===t[0]&&"n"===t[1])return F(e,t,r);if("xlink:"===t.slice(0,6))e.dom.setAttributeNS("http://www.w3.org/1999/xlink",t.slice(6),r);else if("style"===t)C(e.dom,i,r);else if(M(e,t,o)){if("value"===t){if(("input"===e.tag||"textarea"===e.tag)&&e.dom.value===""+r&&(s||e.dom===l()))return;if("select"===e.tag&&null!==i&&e.dom.value===""+r)return;if("option"===e.tag&&null!==i&&e.dom.value===""+r)return;if(s&&""+r!="")return void console.error("`value` is read-only on file inputs!")}e.dom[t]=r}else"boolean"==typeof r?r?e.dom.setAttribute(t,""):e.dom.removeAttribute(t):e.dom.setAttribute("className"===t?"class":t,r)}}function A(e,t,n,i){if("key"!==t&&"is"!==t&&null!=n&&!P(t))if("o"===t[0]&&"n"===t[1])F(e,t,void 0);else if("style"===t)C(e.dom,n,null);else if(!M(e,t,i)||"className"===t||"title"===t||"value"===t&&("option"===e.tag||"select"===e.tag&&-1===e.dom.selectedIndex&&e.dom===l())||"input"===e.tag&&"type"===t){var r=t.indexOf(":");-1!==r&&(t=t.slice(r+1)),!1!==n&&e.dom.removeAttribute("className"===t?"class":t)}else e.dom[t]=null}function P(e){return"oninit"===e||"oncreate"===e||"onupdate"===e||"onremove"===e||"onbeforeremove"===e||"onbeforeupdate"===e}function M(e,t,n){return void 0===n&&(e.tag.indexOf("-")>-1||null!=e.attrs&&e.attrs.is||"href"!==t&&"list"!==t&&"form"!==t&&"width"!==t&&"height"!==t)&&t in e.dom}var T,z=/[A-Z]/g;function H(e){return"-"+e.toLowerCase()}function j(e){return"-"===e[0]&&"-"===e[1]?e:"cssFloat"===e?"float":e.replace(z,H)}function C(e,t,n){if(t===n);else if(null==n)e.style.cssText="";else if("object"!=typeof n)e.style.cssText=n;else if(null==t||"object"!=typeof t)for(var i in e.style.cssText="",n)null!=(r=n[i])&&e.style.setProperty(j(i),String(r));else{for(var i in n){var r;null!=(r=n[i])&&(r=String(r))!==String(t[i])&&e.style.setProperty(j(i),r)}for(var i in t)null!=t[i]&&null==n[i]&&e.style.removeProperty(j(i))}}function I(){this._=t}function F(e,n,i){if(null!=e.events){if(e.events._=t,e.events[n]===i)return;null==i||"function"!=typeof i&&"object"!=typeof i?(null!=e.events[n]&&e.dom.removeEventListener(n.slice(2),e.events,!1),e.events[n]=void 0):(null==e.events[n]&&e.dom.addEventListener(n.slice(2),e.events,!1),e.events[n]=i)}else null==i||"function"!=typeof i&&"object"!=typeof i||(e.events=new I,e.dom.addEventListener(n.slice(2),e.events,!1),e.events[n]=i)}function O(e,t,n){"function"==typeof e.oninit&&a.call(e.oninit,t),"function"==typeof e.oncreate&&n.push(a.bind(e.oncreate,t))}function N(e,t,n){"function"==typeof e.onupdate&&n.push(a.bind(e.onupdate,t))}return I.prototype=Object.create(null),I.prototype.handleEvent=function(e){var t,n=this["on"+e.type];"function"==typeof n?t=n.call(e.currentTarget,e):"function"==typeof n.handleEvent&&n.handleEvent(e),this._&&!1!==e.redraw&&(0,this._)(),!1===t&&(e.preventDefault(),e.stopPropagation())},function(e,n,r){if(!e)throw new TypeError("DOM element being rendered to does not exist.");if(null!=T&&e.contains(T))throw new TypeError("Node is currently being rendered to and thus is locked.");var o=t,s=T,a=[],c=l(),u=e.namespaceURI;T=e,t="function"==typeof r?r:void 0;try{null==e.vnodes&&(e.textContent=""),n=i.normalizeChildren(Array.isArray(n)?n:[n]),p(e,e.vnodes,n,a,null,"http://www.w3.org/1999/xhtml"===u?void 0:u),e.vnodes=n,null!=c&&l()!==c&&"function"==typeof c.focus&&c.focus();for(var h=0;h<a.length;h++)a[h]()}finally{t=o,T=s}}}},742:(e,t,n)=>{"use strict";var i=n(178);e.exports=function(e){return null==e&&(e=""),i("<",void 0,void 0,e,void 0,void 0)}},178:e=>{"use strict";function t(e,t,n,i,r,o){return{tag:e,key:t,attrs:n,children:i,text:r,dom:o,domSize:void 0,state:void 0,events:void 0,instance:void 0}}t.normalize=function(e){return Array.isArray(e)?t("[",void 0,void 0,t.normalizeChildren(e),void 0,void 0):null==e||"boolean"==typeof e?null:"object"==typeof e?e:t("#",void 0,void 0,String(e),void 0,void 0)},t.normalizeChildren=function(e){var n=[];if(e.length){for(var i=null!=e[0]&&null!=e[0].key,r=1;r<e.length;r++)if((null!=e[r]&&null!=e[r].key)!==i)throw new TypeError(!i||null==e[r]&&"boolean"!=typeof e[r]?"In fragments, vnodes must either all have keys or none have keys.":"In fragments, vnodes must either all have keys or none have keys. You may wish to consider using an explicit keyed empty fragment, m.fragment({key: ...}), instead of a hole.");for(r=0;r<e.length;r++)n[r]=t.normalize(e[r])}return n},e.exports=t},74:(e,t,n)=>{"use strict";var i=n(164),r=n(165);e.exports=n(775)("undefined"!=typeof window?window:null,i,r.redraw)},775:(e,t,n)=>{"use strict";var i=n(249),r=n(188);e.exports=function(e,t,n){var o=0;function s(e){return new t(e)}function a(e){return function(r,o){"string"!=typeof r?(o=r,r=r.url):null==o&&(o={});var a=new t((function(t,n){e(i(r,o.params),o,(function(e){if("function"==typeof o.type)if(Array.isArray(e))for(var n=0;n<e.length;n++)e[n]=new o.type(e[n]);else e=new o.type(e);t(e)}),n)}));if(!0===o.background)return a;var l=0;function c(){0==--l&&"function"==typeof n&&n()}return function e(t){var n=t.then;return t.constructor=s,t.then=function(){l++;var i=n.apply(t,arguments);return i.then(c,(function(e){if(c(),0===l)throw e})),e(i)},t}(a)}}function l(e,t){for(var n in e.headers)if(r.call(e.headers,n)&&n.toLowerCase()===t)return!0;return!1}return s.prototype=t.prototype,s.__proto__=t,{request:a((function(t,n,i,o){var s,a=null!=n.method?n.method.toUpperCase():"GET",c=n.body,u=(null==n.serialize||n.serialize===JSON.serialize)&&!(c instanceof e.FormData||c instanceof e.URLSearchParams),h=n.responseType||("function"==typeof n.extract?"":"json"),d=new e.XMLHttpRequest,p=!1,m=!1,f=d,g=d.abort;for(var v in d.abort=function(){p=!0,g.call(this)},d.open(a,t,!1!==n.async,"string"==typeof n.user?n.user:void 0,"string"==typeof n.password?n.password:void 0),u&&null!=c&&!l(n,"content-type")&&d.setRequestHeader("Content-Type","application/json; charset=utf-8"),"function"==typeof n.deserialize||l(n,"accept")||d.setRequestHeader("Accept","application/json, text/*"),n.withCredentials&&(d.withCredentials=n.withCredentials),n.timeout&&(d.timeout=n.timeout),d.responseType=h,n.headers)r.call(n.headers,v)&&d.setRequestHeader(v,n.headers[v]);d.onreadystatechange=function(e){if(!p&&4===e.target.readyState)try{var r,s=e.target.status>=200&&e.target.status<300||304===e.target.status||/^file:\/\//i.test(t),a=e.target.response;if("json"===h){if(!e.target.responseType&&"function"!=typeof n.extract)try{a=JSON.parse(e.target.responseText)}catch(e){a=null}}else h&&"text"!==h||null==a&&(a=e.target.responseText);if("function"==typeof n.extract?(a=n.extract(e.target,n),s=!0):"function"==typeof n.deserialize&&(a=n.deserialize(a)),s)i(a);else{var l=function(){try{r=e.target.responseText}catch(e){r=a}var t=new Error(r);t.code=e.target.status,t.response=a,o(t)};0===d.status?setTimeout((function(){m||l()})):l()}}catch(e){o(e)}},d.ontimeout=function(e){m=!0;var t=new Error("Request timed out");t.code=e.target.status,o(t)},"function"==typeof n.config&&(d=n.config(d,n,t)||d)!==f&&(s=d.abort,d.abort=function(){p=!0,s.call(this)}),null==c?d.send():"function"==typeof n.serialize?d.send(n.serialize(c)):c instanceof e.FormData||c instanceof e.URLSearchParams?d.send(c):d.send(JSON.stringify(c))})),jsonp:a((function(t,n,i,r){var s=n.callbackName||"_mithril_"+Math.round(1e16*Math.random())+"_"+o++,a=e.document.createElement("script");e[s]=function(t){delete e[s],a.parentNode.removeChild(a),i(t)},a.onerror=function(){delete e[s],a.parentNode.removeChild(a),r(new Error("JSONP request failed"))},a.src=t+(t.indexOf("?")<0?"?":"&")+encodeURIComponent(n.callbackKey||"callback")+"="+encodeURIComponent(s),e.document.documentElement.appendChild(a)}))}}},843:(e,t,n)=>{"use strict";var i=n(165);e.exports=n(223)("undefined"!=typeof window?window:null,i)},641:(e,t,n)=>{"use strict";var i=n(188);e.exports=Object.assign||function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n])}},542:(e,t,n)=>{"use strict";var i=n(188),r=new RegExp("^(?:key|oninit|oncreate|onbeforeupdate|onupdate|onbeforeremove|onremove)$");e.exports=function(e,t){var n={};if(null!=t)for(var o in e)i.call(e,o)&&!r.test(o)&&t.indexOf(o)<0&&(n[o]=e[o]);else for(var o in e)i.call(e,o)&&!r.test(o)&&(n[o]=e[o]);return n}},188:e=>{"use strict";e.exports={}.hasOwnProperty},379:e=>{"use strict";var t=[];function n(e){for(var n=-1,i=0;i<t.length;i++)if(t[i].identifier===e){n=i;break}return n}function i(e,i){for(var o={},s=[],a=0;a<e.length;a++){var l=e[a],c=i.base?l[0]+i.base:l[0],u=o[c]||0,h="".concat(c," ").concat(u);o[c]=u+1;var d=n(h),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)t[d].references++,t[d].updater(p);else{var m=r(p,i);i.byIndex=a,t.splice(a,0,{identifier:h,updater:m,references:1})}s.push(h)}return s}function r(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var o=i(e=e||[],r=r||{});return function(e){e=e||[];for(var s=0;s<o.length;s++){var a=n(o[s]);t[a].references--}for(var l=i(e,r),c=0;c<o.length;c++){var u=n(o[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}o=l}}},569:e=>{"use strict";var t={};e.exports=function(e,n){var i=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={id:i,exports:{}};return e[i](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");if(i.length)for(var r=i.length-1;r>-1&&!e;)e=i[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),n.nc=void 0,(()=>{"use strict";var e=n(865),t=n.n(e);class i{constructor(e,t){this.position=e,this.size=t}getPosition(){return this.position}setPosition(e){this.position=e}getSize(){return this.size}setSize(e){this.size=e}}function r(e,t,n){return Math.min(n,Math.max(t,e))}class o{constructor(e,t,n,i,{frameDuration:r=1,loop:o=!0}){this.image=e,this.frames=t,this.frameWidth=n,this.frameHeight=i,this.frameDuration=r,this.loop=o,this.timer=0,this.currentIndex=0,this.finished=!1}update(e){if(!(this.finished||this.frames.length<=1))for(this.timer+=e;this.timer>this.frameDuration;)this.currentIndex+=1,this.currentIndex>=this.frames.length&&(this.loop?this.currentIndex=0:(this.finished=!0,this.currentIndex-=1)),this.timer=this.timer-this.frameDuration}render(e){!function(e,t,n,i,r,o,s){const a=Math.ceil(t.width/o),l=r%a*o,c=Math.floor(r/a)*s;e.drawImage(t,l,c,o,s,0,0,o,s)}(e,this.image,0,0,this.getCurrentFrame(),this.frameWidth,this.frameHeight)}restart(){this.timer=0,this.currentIndex=0,this.finished=!1}getCurrentFrame(){return this.frames[this.currentIndex]}}class s{constructor(e,t,n){this.image=e,this.frameWidth=t,this.frameHeight=n,this.animations={},this.currentAnimation=null}update(e){this.currentAnimation instanceof o&&this.currentAnimation.update(e)}render(e){this.currentAnimation instanceof o&&this.currentAnimation.render(e)}addAnimation(e,t,n={}){const i=new o(this.image,t,this.frameWidth,this.frameHeight,n);this.animations[e]=i}play(e,t=!1){const n=this.animations[e];(this.currentAnimation!==n||t)&&(this.currentAnimation=n,n.restart())}}class a{static getImage(e){return a.images[e]}static load(e){const t=new Array;for(const[n,i]of Object.entries(e)){const e=document.createElement("img"),r=new Promise(((t,r)=>{e.addEventListener("load",(()=>{a.images[n]=e,t(e)})),e.addEventListener("error",(e=>{console.error(e),r(`Impossible de charger l'image « ${i} »`)}))}));e.src=i,t.push(r)}return t}}a.images={};const l=16;class c{constructor(e){this.position=e;const t=a.getImage("tiles");this.animationManager=new s(t,l,l)}update(e){this.animationManager.update(e)}render(e){e.save(),e.translate(this.position.x*l,this.position.y*l),this.animationManager.render(e),e.restore()}onBeforePlayerIn(e){}onAfterPlayerIn(e,t){return this}onAfterPlayerOut(){}canEnter(e){return!1}canLeave(e){return!1}getPosition(){return this.position}getAnimationManager(){return this.animationManager}}class u extends c{constructor(e){super(e),this.getAnimationManager().addAnimation("idle",[0]),this.getAnimationManager().play("idle")}canEnter(){return!0}}class h extends c{constructor(e,t){super(e),this.value=t,this.getAnimationManager().addAnimation("activated",[80]),this.getAnimationManager().addAnimation("deactivated-1",[81]),this.getAnimationManager().addAnimation("deactivated-2",[82]),this.getAnimationManager().addAnimation("deactivated-3",[83]),this.getAnimationManager().play(`deactivated-${this.value}`)}onAfterPlayerOut(){this.value-=1,0===this.value?this.getAnimationManager().play("activated"):this.getAnimationManager().play(`deactivated-${this.value}`)}canEnter(e){return 0===this.value}}class d extends c{constructor(e,t){super(e),this.direction=t,this.getAnimationManager().addAnimation((0).toString(),[30,31,32,33],{frameDuration:.08}),this.getAnimationManager().addAnimation(2..toString(),[40,41,42,43],{frameDuration:.08}),this.getAnimationManager().addAnimation(1..toString(),[50,51,52,53],{frameDuration:.08}),this.getAnimationManager().addAnimation(3..toString(),[60,61,62,63],{frameDuration:.08}),this.getAnimationManager().play(t.toString())}onAfterPlayerIn(e,t){return e.move(this.direction,"idle"),this}}class p extends c{constructor(e,t){super(e),this.angle=t,this.getAnimationManager().addAnimation(1..toString(),[70]),this.getAnimationManager().addAnimation((0).toString(),[71]),this.getAnimationManager().addAnimation(2..toString(),[72]),this.getAnimationManager().addAnimation(3..toString(),[73]),this.getAnimationManager().addAnimation(5..toString(),[74]),this.getAnimationManager().addAnimation(4..toString(),[75]),this.getAnimationManager().addAnimation(6..toString(),[76]),this.getAnimationManager().addAnimation(7..toString(),[77]),this.getAnimationManager().addAnimation(8..toString(),[78]),this.getAnimationManager().addAnimation(9..toString(),[79]),this.getAnimationManager().play(t.toString())}onAfterPlayerOut(){switch(this.angle){case 0:this.angle=2;break;case 1:this.angle=0;break;case 2:this.angle=3;break;case 3:this.angle=1;break;case 4:this.angle=5;break;case 5:this.angle=4;break;case 6:this.angle=7;break;case 7:this.angle=8;break;case 8:this.angle=9;break;case 9:this.angle=6}this.getAnimationManager().play(this.angle.toString())}canEnter(e){switch(this.angle){case 0:return[1,3].includes(e);case 1:return[1,2].includes(e);case 2:return[0,3].includes(e);case 3:return[0,2].includes(e);case 4:return[2,3].includes(e);case 5:return[0,1].includes(e);case 6:return 1===e;case 7:return 3===e;case 8:return 0===e;case 9:return 2===e}}canLeave(e){switch(this.angle){case 0:return[0,2].includes(e);case 1:return[0,3].includes(e);case 2:return[1,2].includes(e);case 3:return[1,3].includes(e);case 4:return[2,3].includes(e);case 5:return[0,1].includes(e);case 6:return 0===e;case 7:return 2===e;case 8:return 1===e;case 9:return 3===e}}}class m extends c{constructor(e){super(e)}render(e){}}class f extends c{constructor(e){super(e),this.active=!1,this.getAnimationManager().addAnimation("inactive",[20]),this.getAnimationManager().addAnimation("active",[21,22,23,24,23,22],{frameDuration:.1}),this.getAnimationManager().play("inactive")}onAfterPlayerIn(e,t){return this.isActive()&&(e.setImmobility(!0),e.getAnimationManager().play("turn"),setTimeout((()=>{t.nextLevel()}),480)),this}activate(){this.active=!0,this.getAnimationManager().play("active")}isActive(){return this.active}}class g extends c{constructor(e){super(e),this.getAnimationManager().addAnimation("idle",[10]),this.getAnimationManager().play("idle")}onAfterPlayerIn(e,t){return null}}class v extends c{constructor(e){super(e),this.getAnimationManager().addAnimation("idle",[2]),this.getAnimationManager().play("idle")}onAfterPlayerIn(e,t){return e.move(e.getDirection(),"idle"),this}}class y extends c{constructor(e){super(e),this.getAnimationManager().addAnimation("idle",[1]),this.getAnimationManager().play("idle")}onBeforePlayerIn(e){e.getAnimationManager().play(`jump-${1..toString()}`,!0)}onAfterPlayerIn(e,t){return e.move(e.getDirection(),null),this}canEnter(e){return 1!==e}}const b={"#":e=>new u(e),S:e=>new m(e),E:e=>new f(e),$:e=>new g(e),"^":e=>new d(e,0),v:e=>new d(e,1),">":e=>new d(e,2),"<":e=>new d(e,3),T:e=>new p(e,0),F:e=>new p(e,1),J:e=>new p(e,2),L:e=>new p(e,3),"=":e=>new p(e,5),H:e=>new p(e,4),8:e=>new p(e,6),6:e=>new p(e,7),2:e=>new p(e,8),4:e=>new p(e,9),B:e=>new h(e,1),B2:e=>new h(e,2),B3:e=>new h(e,3),"!":e=>new v(e),U:e=>new y(e)};class w{constructor(e,t){this.x=e,this.y=t}clone(){return new w(this.x,this.y)}static angleBetween(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}}class ${constructor(){this.canvas=document.getElementById("joystick"),this.ctx=this.canvas.getContext("2d"),this.outerRadius=8,this.innerRadius=5,this.startPosition=new w(0,0),this.pointerPosition=new w(0,0),this.scale=1}render(){const e=120;this.canvas.width=2*this.outerRadius*this.scale+e,this.canvas.height=2*this.outerRadius*this.scale+e,this.canvas.style.left=this.startPosition.x-this.canvas.width/2+"px",this.canvas.style.top=this.startPosition.y-this.canvas.height/2+"px",this.ctx.save(),this.ctx.scale(this.scale,this.scale),this.ctx.translate(e/this.scale/2,e/this.scale/2),this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.arc(this.outerRadius,this.outerRadius,this.outerRadius,0,2*Math.PI,!1),this.ctx.fillStyle="#999",this.ctx.fill(),this.ctx.strokeStyle="#666",this.ctx.stroke();const t=this.getAxisValues();t.x*=this.innerRadius,t.y*=this.innerRadius,this.ctx.beginPath(),this.ctx.arc(this.outerRadius+t.x,this.outerRadius+t.y,this.innerRadius,0,2*Math.PI,!1),this.ctx.fillStyle="#555",this.ctx.fill(),this.ctx.strokeStyle="#333",this.ctx.stroke(),this.ctx.restore()}getStartPosition(){return this.startPosition}setStartPosition(e){this.startPosition=e}getPointerPosition(){return this.pointerPosition}setPointerPosition(e){this.pointerPosition=e}show(){this.canvas.style.display="block"}hide(){this.canvas.style.display="none"}getScale(){return this.scale}setScale(e){this.scale=e}getAxisValues(){const e=this.startPosition.clone();e.x/=this.scale,e.y/=this.scale;const t=this.pointerPosition.clone();t.x/=this.scale,t.y/=this.scale;const n=w.angleBetween(e,t),i=t.x-e.x,r=t.y-e.y;let o=Math.sqrt(i*i+r*r);const s=new w(0,0);return o=Math.min(o,this.innerRadius),s.x=o*Math.cos(n),s.y=o*Math.sin(n),s.x/=this.innerRadius,s.y/=this.innerRadius,s}}class x{constructor(e,t){this.width=e,this.height=t}clone(){return new x(this.width,this.height)}}class k{constructor(e){this.cells=[];for(let t=0;t<e.length;t+=1){this.cells[t]=[];for(let n=0;n<e[t].length;n+=1){const i=e[t][n];"."!==i&&(this.cells[t][n]=b[i](new w(n,t)))}}this.endCell=this.getEndCell(),this.nbCoins=null}update(e){0===this.nbCoins&&(this.endCell.isActive()||this.endCell.activate()),this.nbCoins=0;for(let t=0;t<this.cells.length;t+=1)for(let n=0;n<this.cells[t].length;n+=1){const i=this.cells[t][n];void 0!==i&&i.update(e),i instanceof g&&(this.nbCoins+=1)}}render(e){for(let t=0;t<this.cells.length;t+=1)for(let n=0;n<this.cells[t].length;n+=1){const i=this.cells[t][n];void 0!==i&&i.render(e)}}getCell(e){return void 0!==this.cells[e.y]&&void 0!==this.cells[e.y][e.x]?this.cells[e.y][e.x]:null}getCellAt(e,t){return this.getCell(new w(e,t))}onAfterPlayerOut(e){const t=this.getCellAt(e.x,e.y);null!==t&&t.onAfterPlayerOut()}onAfterPlayerIn(e,t,n){const i=this.getCellAt(e.x,e.y);if(null!==i){const r=i.onAfterPlayerIn(t,n);i!==r&&(this.cells[e.y][e.x]=null===r?void 0:r)}}getStartPosition(){for(let e=0;e<this.cells.length;e+=1)for(let t=0;t<this.cells[e].length;t+=1){const n=this.cells[e][t];if(n instanceof m)return n.getPosition().clone()}return null}getSize(){return new x(this.cells[0].length,this.cells.length)}getDisplayedSize(){const e=this.getSize().clone();return e.width*=l,e.height*=l,e}getEndCell(){if(this.endCell instanceof f)return this.endCell;for(let e=0;e<this.cells.length;e+=1)for(let t=0;t<this.cells[e].length;t+=1){const n=this.cells[e][t];if(n instanceof f)return n}return null}}function S(e,t,n){return e*(1-n)+t*n}class B{constructor(e){this.game=e,this.map=this.game.getMap();const t=this.map.getStartPosition(),n=t.x,i=t.y;this.position=new w(n,i),this.previousPosition=this.position.clone(),this.startPosition=new w(n*l,i*l),this.targetPosition=this.startPosition.clone(),this.displayPosition=this.startPosition.clone(),this.canmove=!0,this.immobility=!1,this.timer=0,this.direction=1;const r=a.getImage("player");this.animationManager=new s(r,14,19),this.animationManager.addAnimation(`idle-${(0).toString()}`,[3]),this.animationManager.addAnimation(`idle-${1..toString()}`,[9]),this.animationManager.addAnimation(`idle-${2..toString()}`,[6]),this.animationManager.addAnimation(`idle-${3..toString()}`,[0]),this.animationManager.addAnimation(`walk-${(0).toString()}`,[3,4,5,3],{frameDuration:.08,loop:!1}),this.animationManager.addAnimation(`walk-${1..toString()}`,[9,10,11,9],{frameDuration:.08,loop:!1}),this.animationManager.addAnimation(`walk-${2..toString()}`,[6,7,6],{frameDuration:.08,loop:!1}),this.animationManager.addAnimation(`walk-${3..toString()}`,[0,1,0],{frameDuration:.08,loop:!1}),this.animationManager.addAnimation(`jump-${1..toString()}`,[12,13,9],{frameDuration:.1,loop:!1}),this.animationManager.addAnimation("turn",[9,0,3,6],{frameDuration:.1,loop:!0}),this.animationManager.play("turn"),setTimeout((()=>{this.animationManager.play(`idle-${this.direction.toString()}`)}),480)}update(e){if(this.animationManager.update(e),!this.canmove){if(this.timer+=5*e,this.displayPosition.x=S(this.startPosition.x,this.targetPosition.x,this.timer),this.displayPosition.y=S(this.startPosition.y,this.targetPosition.y,this.timer),this.timer>=.5){const e=this.map.getSize();if(this.position.x<=-1)return this.runEvents(),void this.moveFromBound(3);if(this.position.y<=-1)return this.runEvents(),void this.moveFromBound(0);if(this.position.x>=e.width)return this.runEvents(),void this.moveFromBound(2);if(this.position.y>=e.height)return this.runEvents(),void this.moveFromBound(1)}this.timer>=1&&(this.timer=0,this.canmove=!0,this.displayPosition=this.targetPosition.clone(),this.runEvents())}}render(e){e.save(),e.translate(this.displayPosition.x+1,this.displayPosition.y-8),this.animationManager.render(e),e.restore()}move(e,t="walk"){if(this.immobility)return;if(!this.canmove)return;switch(t){case"walk":this.animationManager.play(`walk-${e.toString()}`,!0);break;case"idle":this.animationManager.play(`idle-${e.toString()}`,!0)}let n=this.computeNewMapPosition(e,!0);const i=this.map.getCell(this.position),r=this.map.getCell(n);i instanceof c&&i.canLeave(e)||r instanceof c&&r.canEnter(e)||(this.direction=e,r instanceof c&&r.onBeforePlayerIn(this),n=this.computeNewMapPosition(e),this.moveTo(n))}isAbleToMove(){return this.canmove}moveTo(e){this.previousPosition=this.position,this.position=e,this.canmove=!1,this.startPosition=this.targetPosition.clone(),this.targetPosition.x=this.position.x*l,this.targetPosition.y=this.position.y*l}getDirection(){return this.direction}getDisplayPosition(){return this.displayPosition}getAnimationManager(){return this.animationManager}setImmobility(e){this.immobility=e}moveFromBound(e){const t=this.map.getSize();switch(this.canmove=!0,e){case 3:this.position.x=t.width,this.startPosition=new w((this.position.x+1)*l,this.position.y*l);break;case 2:this.position.x=-1,this.startPosition=new w((this.position.x-1)*l,this.position.y*l);break;case 0:this.position.y=t.height,this.startPosition=new w(this.position.x*l,(this.position.y+1)*l);break;case 1:this.position.y=-1,this.startPosition=new w(this.position.x*l,(this.position.y-1)*l)}this.targetPosition=this.startPosition.clone(),this.move(e)}runEvents(){this.map.onAfterPlayerOut(this.previousPosition),this.map.onAfterPlayerIn(this.position,this,this.game)}computeNewMapPosition(e,t=!1){const n=this.position.clone();switch(e){case 0:n.y-=1;break;case 1:n.y+=1;break;case 2:n.x+=1;break;case 3:n.x-=1}if(t){const e=this.map.getSize();n.x<=-1&&(n.x=e.width-1),n.y<=-1&&(n.y=e.height-1),n.x>=e.width&&(n.x=0),n.y>=e.height&&(n.y=0)}return n}}const E={Halley:{map:"\n      # # # # # # # # #\n      # # # . E . # # #\n      # # . . . . . # #\n      # $ . . . . . $ #\n      # $ . . . . . $ #\n      # $ . . . . . $ #\n      # # . . S . . # #\n      # # # . . . # # #\n      # # # # # # # # #\n    "},Encke:{map:"\n      # # # # # # # # # # #\n      # $ . . . . . . . $ #\n      # . . . . . . . . . #\n      # . . # # . # # . . #\n      # . . # $ . $ # . . #\n      # . . . . E . . . . #\n      # . . # $ . $ # . . #\n      # . . # # . # # . . #\n      # . . . . S . . . . #\n      # $ . . . . . . . $ #\n      # # # # # # # # # # #\n    "},Biela:{map:"\n      # # # # # # # # #\n      # # . . E . . # #\n      # # . . . . . # #\n      # $ > . . . < $ #\n      # $ # . # . # $ #\n      # $ < . . . > $ #\n      # # . . S . . # #\n      # # . . . . . # #\n      # # # # # # # # #\n    "},Faye:{map:"\n      # # # # # # # # #\n      # # # # E # # # #\n      # # # # . # # # #\n      # . . > . > . . #\n      # $ . # # # . $ #\n      # # ^ # $ # v # #\n      # # ^ . . . v # #\n      # . . . S . . . #\n      # # # # # # # # #\n    "},Brorsen:{map:"\n      # # # # # # # # #\n      # S . ! ! ! ! . #\n      # # # # # # ! . #\n      # $ $ $ $ $ # . #\n      # # # # ! ! # . #\n      # ! ! ! # ! # . #\n      # ! $ ! . ! # . #\n      # ! ! ! . . . E #\n      # # # # # # # # #\n    "},Tuttle:{map:"\n      # # # # # # # # #\n      # S # . . . . . #\n      # . ! # . . . $ #\n      # # ! $ # $ . . #\n      # . ! ! ! ! # . #\n      # . # . # # . . #\n      # . . . # . . . #\n      # . $ . # . . E #\n      # # # # # # # # #\n    "},Tempel:{map:"\n      # # # # # # # # #\n      # . . . S . . . #\n      # . . # . # . . #\n      # # # # $ # # # #\n      # . . $ H $ . . #\n      # . # # $ # # . #\n      # . . # . # . . #\n      # . . . E . . . #\n      # # # # # # # # #\n    "},Olbers:{map:"\n      # # # # # # # # #\n      # . . . . . . . #\n      # . . # # # . . #\n      # . # # $ # # . #\n      # S . $ J $ # . #\n      # . # # $ # # . #\n      # . . # # # . . #\n      # . . . E . . . #\n      # # # # # # # # #\n    "},Wolf:{map:"\n      # # # # # # # # #\n      # $ . . # . . $ #\n      # . . # # # . . #\n      # . . . # . . . #\n      # S . . B . . E #\n      # . . . # . . . #\n      # . . # # # . . #\n      # $ . . # . . $ #\n      # # # # # # # # #\n    "},Finlay:{map:"\n      # # # # # # # # #\n      # S . B . . . $ #\n      # . . # . # . . #\n      # . # . . . # . #\n      # . B . $ . # . #\n      # B # . . . # . #\n      # . . # # # # # #\n      # $ . . . . . E #\n      # # # # # # # # #\n    "},Brooks:{map:"\n      # # # # # # # # #\n      # S . . # . . . #\n      # . . . # # . $ #\n      # # # L = # . . #\n      # . # L T $ . . #\n      # . # # # # . . #\n      # . . . . . $ . #\n      # . . . E . . . #\n      # # # # # # # # #\n    "},Holmes:{map:"\n      # # # # # # # # #\n      # . . . . . . . #\n      # . S . . $ $ # #\n      # . . . # . . . #\n      # . . = ! ! ! ! #\n      # . . # . # # # #\n      # $ . # . . . . #\n      # . . # $ . . E #\n      # # # # # # # # #\n    "},Borrelly:{map:"\n      # # # # # # # # #\n      # S # # # . ! # #\n      # . . ! ! $ ! $ #\n      # # # ! ! . ! . #\n      # . . ! ! ! ! ! #\n      # . . . ! # . # #\n      # # # # ! # . . #\n      # . $ . $ # . E #\n      # # # # # # # # #\n    "},Westphal:{map:"\n      # # # # # # # # # # # #\n      # $ . = . . . . . . . #\n      # . . # . . $ . . . . #\n      # # H # . # # # . . . #\n      # . . . = S E . J . $ #\n      # # H # . # # # . . . #\n      # . . # . . $ . . . . #\n      # $ . = . . . . . . . #\n      # # # # # # # # # # # #\n    "},Kopff:{map:"\n      # # # # # # # # # # # # # # # # # # # #\n      # S . . . . . . . . . . . . # . . . $ #\n      # . # # # # # # # # # . # . # . # . . #\n      # . . . . # . . . . . . # . # # # . # #\n      # # # # . # . # # # # # # . # . . . . #\n      # . . . . # . # . # . . . . # . # # . #\n      # . # # . # . # . # . # # # # . # . . #\n      # . . # . . . . . # . . . . . . # . # #\n      # # . # # # # # . # # # # . # . # . . #\n      # . . # . . . # . # . . . . # . # # # #\n      # . # # . # . # . # # # # . # . . . . #\n      # . . . . # . # . # . . . . # # # # . #\n      # # # # # # . # . # . # # # # . # . . #\n      # . # . . . . # . # . . # . . . # . # #\n      # . . . # . # # . # # . # . # # # . . #\n      # . # # # . # . . . . . # . # . # # . #\n      # . # . . . # # # # # # # . # . . . . #\n      # . # # # # # . # . . . # . # . # # # #\n      # $ . . . . . . . . # . . . # . . . E #\n      # # # # # # # # # # # # # # # # # # # #\n    "},Schaumasse:{map:"\n      # # # # # # # # #\n      # $ . # S # $ . #\n      # . . ! ! ! . . #\n      # ! ! ! ! ! ! ! #\n      # ! $ ! B ! $ ! #\n      # ! ! ! ! ! ! ! #\n      # # # . . . # # #\n      # . . . . . . E #\n      # # # # # # # # #\n    "},Crommelin:{map:"\n      # # # # # # # # #\n      # S . . ! . . . #\n      # . $ # ! . $ . #\n      # # # # ! # # # #\n      # ! ! ! L ! ! ! #\n      # B # # ! # # . #\n      # . $ # ! . $ . #\n      # . . B ! # . E #\n      # # # # # # # # #\n    "},Reinmuth:{map:"\n      # # # # # # # # #\n      # $ . . E . . $ #\n      # $ $ . . . $ $ #\n      # # # # ^ # # # #\n      # $ B B $ B B $ #\n      # B # # ^ # # B #\n      # B # # ^ # # B #\n      # $ B B $ B B $ #\n      # B # # B # # ^ #\n      # B # # B # # ^ #\n      # $ B B $ B B $ #\n      # B # # ^ # # B #\n      # B # # ^ # # B #\n      # $ B B S B B $ #\n      # # # # # # # # #\n    "},Daniel:{screenWidth:13,screenHeight:13,map:"\n      # # # # # # # # # # # # #\n      # $ . . . . . B . . . $ #\n      # . . . . . . # . . . . #\n      # ^ # # # # # # B # # # #\n      # . . . . . . . . # . . #\n      # . $ . T = T . . # . $ #\n      # . $ . H $ H . . # . $ #\n      # . $ . F = T . . # . $ #\n      # . . . . . . . . # . . #\n      # ^ # B # # # # # # . . #\n      # . . . . . . . . # . . #\n      # . S . $ $ $ . . > . E #\n      # # # # # # # # # # # # #\n    "},Gale:{map:"\n      #  #  #  #  #  #  #  #  #\n      #  S  #  .  .  .  .  .  #\n      #  .  #  #  .  .  $  .  #\n      #  .  .  #  #  .  .  .  #\n      #  .  $  .  #  #  B2 #  #\n      #  .  $  $  .  .  .  .  #\n      #  #  .  $  .  .  .  .  #\n      #  #  #  .  .  .  .  E  #\n      #  #  #  #  #  #  #  #  #\n    "},Whipple:{map:"\n      #  #  #  #  #  #  #  #  #\n      #  S  .  .  #  .  .  .  #\n      #  .  $  .  #  .  $  .  #\n      #  .  .  #  .  .  .  .  #\n      #  v  v  #  B2 #  ^  ^  #\n      #  .  .  .  .  #  .  .  #\n      #  .  $  .  #  .  $  .  #\n      #  .  .  .  B  .  .  E  #\n      #  #  #  #  #  #  #  #  #\n    "},Forbes:{map:"\n      # # # # # # # # #\n      # # S . E . . # #\n      # . . . $ . . . #\n      # . # # # # 2 # #\n      # . # $ $ $ $ . #\n      # $ # . # . # . #\n      # . 6 B B B B B #\n      # . # $ $ $ $ # #\n      # # # # # # # # #\n    "},Oterma:{screenWidth:11,screenHeight:9,map:"\n      # # # # # # # # # # #\n      # $ . B . $ . B . $ #\n      # . . # . . . # . . #\n      # B # # # B # # # B #\n      # $ . B . S . B . $ #\n      # B # # # B # # # B #\n      # . . # . . . # . . #\n      # $ . B . E . B . $ #\n      # # # # # # # # # # #\n    "},Wirtanen:{map:"\n      # # # # # # # # #\n      # # # # E # # # #\n      # B . . . . . B #\n      # $ # # . # # $ #\n      # B . $ B $ . B #\n      # # # $ B $ # # #\n      # # # # . # # # #\n      # . . . S . . . #\n      # # # # # # # # #\n    "},Johnson:{map:"\n      # # # # # # # # #\n      # S . . # . # # #\n      # . . . B . . # #\n      # . . # # # . . #\n      # . $ T $ F $ . #\n      # . . . # . . . #\n      # # . . B . . . #\n      # # # . # . . E #\n      # # # # # # # # #\n    "},Arend:{map:"\n      # # # # # # # # #\n      # S # . # . . . #\n      # . # . # . # . #\n      # . 6 . 8 . $ . #\n      # B # # # . # . #\n      # $ < . < . $ . #\n      # . # . # . # . #\n      # . # . # . . E #\n      # # # # # # # # #\n    "},Harrington:{map:"\n      # # # # . # # # #\n      # S # # . . . . #\n      # . # # # # # . #\n      # . # . . # # . #\n      . . # # $ # # . .\n      # # # # . # # # #\n      . . . . . # . . .\n      # . . # . # . E #\n      # # # # . # # # #\n    "},Tsuchinshan:{map:"\n      #  #  #  #  #  #  #  #  #\n      #  $  B  $  #  .  .  #  #\n      #  B  2  B2 $  T  .  .  #\n      #  S  #  B  #  B  #  .  #\n      #  B  2  B2 $  J  .  .  #\n      #  .  #  $  #  $  #  .  #\n      #  .  #  B  #  #  #  .  #\n      #  .  .  .  .  .  .  E  #\n      #  #  #  #  #  #  #  #  #\n    "},Wild:{map:"\n      # # # # # # # # #\n      # . . . . < . $ #\n      # # . # v # # ^ #\n      # . . > $ B . . #\n      # S # # F B B E #\n      # . . > $ B . . #\n      # # . # ^ # # v #\n      # . . . . < . $ #\n      # # # # # # # # #\n    "},Kojima:{map:"\n      # # # # # # # # #\n      # S # . $ = $ . #\n      # . # . . # . . #\n      # $ = . B # B T #\n      # . F . J . T . #\n      # F B # # . B $ #\n      # . . # . . # . #\n      # . $ = $ . # E #\n      # # # # # # # # #\n    "},Taylor:{map:"\n      # # # # # # # # # # # # #\n      # . . . . . # . . . . . #\n      # . $ . . . # . . . $ . #\n      # . . . # F > . # . . . #\n      # . . # F J . L T # . . #\n      # . . . J . . . L T . . #\n      # # # ^ . . S . . v # # #\n      # . . L T . E . F . . . #\n      # . . # L T . F J # . . #\n      # . . . # . < J # . . . #\n      # . $ . . . # . . . $ . #\n      # . . . . . # . . . . . #\n      # # # # # # # # # # # # #\n    "},Klemola:{screenWidth:10,screenHeight:10,map:"\n      # # # # # # # # # #\n      # # # . . . . # # #\n      # # . . . . . . # #\n      # . . J J L L . . #\n      # S . H J $ H . . #\n      # . . H $ F H . E #\n      # . . T T F F . . #\n      # # . . . . . . # #\n      # # # . . . . # # #\n      # # # # # # # # # #\n    "},Kohoutek:{screenWidth:13,screenHeight:13,map:"\n      # # . # # # # # # # . # #\n      # . . . # . . . # . . . #\n      . . $ . # . $ . B . $ . .\n      # . . . # . . . # . . . #\n      # # B # # # B # # # B # #\n      # . . . # . . . # . . . #\n      # . $ . # . S . B . $ . #\n      # . . . # . . . # . . . #\n      # # B # # # B # # # B # #\n      # . . . # . . . # . . . #\n      # . $ . # . E . # . $ . #\n      # . . . # . . . # . . . #\n      # # . # # # # # # # . # #\n    "},Clark:{map:"\n      #  #  #  #  #  #  #  #  #\n      #  S  #  $  #  $  #  $  #\n      #  $  #  $  B  T  B  $  #\n      #  $  #  $  #  $  #  $  #\n      #  $  B  F  B2 $  #  $  #\n      #  $  #  $  #  $  #  $  #\n      #  $  #  $  B  J  B  $  #\n      #  $  B  $  #  $  #  E  #\n      #  #  #  #  #  #  #  #  #\n    "},Longmore:{map:"\n      #  #  #  #  #  #  #  #  #\n      #  $  L  $  8  =  8  .  #\n      #  .  F  B2 #  .  6  .  #\n      #  H  #  4  #  4  #  #  #\n      #  .  .  .  .  .  .  .  #\n      #  .  .  .  S  .  .  .  #\n      #  #  .  .  E  .  .  #  #\n      #  #  #  .  .  .  #  #  #\n      #  #  #  #  #  #  #  #  #\n    "},Gunn:{screenWidth:13,screenHeight:13,map:"\n      # # # # # # # # # # # # #\n      # $ . . . # $ . ! ! . $ #\n      # . . . . # . . ! ! . . #\n      # # # ! ! T ! ! ! ! # # #\n      # $ . ! ! ! B ! ! ! . $ #\n      # # v ! ! . # # ! ! # # #\n      # . . ! ! . $ . ! ! . $ #\n      # # # ! ! # B . ! ! # # #\n      # S . ! ! # ! ! ! ! . $ #\n      # # ! ! ! ! ! ! # ! # # #\n      # . . ! ! . . . # . . . #\n      # $ . ! ! . $ . # . . E #\n      # # # # # # # # # # # # #\n    "},Gehrels:{map:"\n      # # # # # # # # #\n      # ! . . # . . ! #\n      # ! $ . # . $ ! #\n      # ! . J B L . ! #\n      # ^ # H # H # ^ #\n      # ! $ L ! J $ ! #\n      # ! . ! ! ! . ! #\n      # ! S # E # . ! #\n      # # # # # # # # #\n    "},Helin:{map:"\n      # # # # # # # # #\n      # S . B . # . $ #\n      # . $ J $ 6 . . #\n      # . B # . # # 4 #\n      # B $ . J v . . #\n      # 4 # # . < v # #\n      # . . B ^ < . $ #\n      # $ . < . $ < E #\n      # # # # # # # # #\n    "},Russell:{screenWidth:11,screenHeight:11,map:"\n      # # # . # # # . # # #\n      # . . . $ S $ . . . #\n      # # # # # # # # # . #\n      B . $ . # . . $ # . .\n      # . # # # B # . 6 B #\n      # L . # $ . # # # . #\n      # . # # # B # . # . #\n      . . . . = . # . $ . .\n      # . # . # . # # # # #\n      # $ # . # . . . . E #\n      # # # . # # # . # # #\n    "},Giclas:{screenWidth:13,screenHeight:13,map:"\n      # # # # # # # # # # # # #\n      # . . . . . # . . . . . #\n      # # . $ . . # . . $ . # #\n      # . # . . F = T . . # . #\n      # . . # . H . H . # . . #\n      # . $ . F J . L T . $ . #\n      # . . . H . E . H . . . #\n      # # # F J . . . L T # # #\n      # . . H . . . . . H . . #\n      # . . L = = 8 = = J . . #\n      # $ . B . = 2 = . B . $ #\n      # . . # . . S . . # . . #\n      # # # # # # # # # # # # #\n    "},Boethin:{screenWidth:13,screenHeight:9,map:"\n      # # # # # # # # # # # # #\n      # $ . B . . $ . . B . $ #\n      # . F = T # H # F = T . #\n      # . H $ H $ H $ H $ . . #\n      # # 4 = J # H # 4 = = # #\n      # . H . . . H . H . . . #\n      # . H . S . H . H . E . #\n      # . . . . . . . . . . . #\n      # # # # # # # # # # # # #\n    "},Bus:{screenWidth:13,screenHeight:10,map:"\n      # # # # # # # # # # # # #\n      # . . B . $ # $ . B . . #\n      # . $ . # . # . # . $ . #\n      # . . # # F B T # # . . #\n      # . B 4 $ . . . $ 6 B . #\n      # # # . # . . . # . # # #\n      # # . L B # B # B J . # #\n      # # . B . . S . . B . # #\n      # . $ . # # E # # . $ . #\n      # # # # # # # # # # # # #\n    "},Howell:{map:"\n      # # # # # # # # #\n      # $ . . # . . $ #\n      # . F = 8 = T . #\n      # . H B S B H . #\n      # # 4 ! ! ! 6 # #\n      # . H B E B H . #\n      # . L = 2 = J . #\n      # $ . . # . . $ #\n      # # # # # # # # #\n    "},Sanguin:{map:"\n      # # # # # # # # #\n      # $ . . F . . . #\n      # # # B H B S . #\n      # . B . H . B . #\n      # L = = B = = J #\n      # . B . H . B $ #\n      # $ # B H B # # #\n      # E # . L . $ . #\n      # # # # # # # # #\n    "},Lovas:{map:"\n      # # # # # # # # #\n      # S # . B . # . #\n      # . B $ # $ B # #\n      # . J . B . J . #\n      # . B # . # # . #\n      # . J $ J $ # . #\n      # E # # $ # # . #\n      # . < . B . . $ #\n      # # # # # # # # #\n    "},Chiron:{screenWidth:13,screenHeight:13,map:"\n      # # # # # # # # # # # # #\n      # ! ! ! ! # ! ! ! ! ! # #\n      # ! $ ! ! ! ! ! ! ! T . #\n      # ! ! ! ! ! ! ! ! # . . #\n      # ! ! ! ! # B # # . $ . #\n      # ! ! ! # . . . # . . . #\n      # 6 # # # . S . # # # 6 #\n      # . . . # . E . # . . . #\n      # . $ . # # B # # . $ . #\n      # . . # . . H . . # . . #\n      # . L = = T 6 F = = J . #\n      # # . . . L 2 J . . . . #\n      # # # # # # # # # # # # #\n    "},Machholz:{map:"\n      # # . # . # . # #\n      # $ . # $ # . $ #\n      . # B # . # B # .\n      T . . F H T . . F\n      4 = = = S = = = 6\n      J . . L H J . . L\n      . # B # . # B # .\n      # $ . # $ # . $ #\n      # # . # E # . # #\n    "},Takamizawa:{screenWidth:11,screenHeight:11,map:"\n      # # # # # # # # # # # # #\n      # E . . . B . $ . $ . . #\n      # . . . . # # # # # # . #\n      # # # # B T $ $ $ $ . . #\n      # $ . . . H $ $ $ $ # . #\n      # # # $ . L = F = = T # #\n      # # # F = = = H = = J # #\n      # . . H . $ . H . $ . # #\n      # . . H # # # H # # # . #\n      # . . H . $ . ! . $ $ . #\n      # . . . . $ . ! . $ $ . #\n      # . . . S . . B . . . . #\n      # # # # # # # # # # # # #\n    "},Kowal:{screenWidth:13,screenHeight:13,map:"\n      # # # # # # # # # # # # #\n      # . . . # . . . # . . . #\n      # . $ . # . E . # . $ . #\n      # . . . F T . F T . . . #\n      # . . F J L = J L T . . #\n      # # # H $ . # . $ H # # #\n      # . . L T . # . F J . . #\n      # . . . L T # F J . . . #\n      # . . . . L F J . . . . #\n      # # . . . . H . . . . # #\n      # # # . . . . . . . # # #\n      # # # # . . S . . # # # #\n      # # # # # # # # # # # # #\n    "},Hartley:{screenWidth:13,screenHeight:13,map:"\n      # # # # # # # # # # # # #\n      # . . . # . . . # . . . #\n      # . $ . 4 . $ . 6 . $ . #\n      # . . . # . . . # . . . #\n      # # # 8 B F # T B 8 # # #\n      # . . . # . . . # . . . #\n      # . $ . 6 . S . 4 . $ . #\n      # . . . # . . . # . . . #\n      # # # 2 B L # J B 2 # # #\n      # . . . # . . . # . . . #\n      # . $ . 4 . E . 6 . $ . #\n      # . . . # . . . # . . . #\n      # # # # # # # # # # # # #\n    "}};function L(e){let t=e.replace(/^ +/gm,"");t=t.replace(/ +/g," ");let n=t.split(/\n/);n=n.filter((e=>e.length>0));const i=[];for(const e of n){const t=e.split(" ");i.push(t)}return i}class A{getLevels(){const e={};let t=1;for(const[n,i]of Object.entries(E)){const r={map:L(i.map),number:t,name:n,screenWidth:"screenWidth"in i?i.screenWidth:9,screenHeight:"screenHeight"in i?i.screenHeight:9};e[n]=r,t+=1}return e}}const P="levels";class M{constructor(e){this.levelManager=e}getLevels(){const e={},t=this.getLevelsUser();let n=null;for(const[i,r]of Object.entries(this.levelManager.getLevels())){let o=!1;o=!!t[i].success||null===n||n.user.success;const s={fixed:r,dynamic:{accessible:o},user:t[i]};e[i]=s,n=s}return e}successfulLevel(e){const t=this.getStoredLevels();t[e].success=!0,this.saveLevels(t)}reset(){localStorage.clear()}getNextLevelOf(e){const t=this.getLevels(),n=Object.keys(t),i=n.indexOf(e)+1,r=n[i];return r in t?t[r]:null}areAllLevelsSucceeded(){const e=this.getLevels();for(const[t,n]of Object.entries(e))if(!n.user.success)return!1;return!0}getLevelsUser(){const e={};for(const[t]of Object.entries(this.levelManager.getLevels()))e[t]={success:!1};const t=this.getStoredLevels();for(const[n,i]of Object.entries(t))n in e&&(e[n]=i);return this.saveLevels(e),e}getStoredLevels(){if(null!==localStorage.getItem(P)){const e=localStorage.getItem(P);let t={};try{t=JSON.parse(e)}catch(e){return{}}return t}return{}}saveLevels(e){localStorage.setItem(P,JSON.stringify(e))}}const T=new class{constructor(){const e=new A;this.storage=new M(e)}getStorage(){return this.storage}loadLevels(){this.levels=this.storage.getLevels()}getLevels(){return this.levels}},z=new x(144,144),H=z.clone();function j(e=!1){const t=e?H:z,n=document.getElementById("topbar"),i=n instanceof HTMLElement?n.clientHeight:0,r=window.innerWidth/t.width,o=(window.innerHeight-i)/t.height,s=Math.min(r,o),a=t.width*s,l=t.height*s;return{size:new x(a,l),zoom:s}}class C{constructor(e,n){this.gameScreen=e,this.canvas=document.getElementById("game"),this.ctx=this.canvas.getContext("2d"),this.lastUpdate=Date.now(),this.zoom=1,this.listen(),this.keyboard=this.gameScreen.getKeyboard(),this.pointer=this.gameScreen.getPointer(),this.joystick=new $,this.joystick.setScale(this.zoom),this.currentLevelName=n,this.storage=T.getStorage(),this.storage.getLevels()[this.currentLevelName].dynamic.accessible||t().route.set("/choose-level"),this.runLevel(),this.update()}update(){const e=Date.now(),t=(e-this.lastUpdate)/1e3;if(this.lastUpdate=e,this.pointer.press()){const e=document.getElementById("topbar"),t=this.pointer.getLastEvent().target;if(!e.contains(t)){const e=this.pointer.getPosition().clone();this.joystick.setStartPosition(e),this.joystick.show()}}this.pointer.release()&&this.joystick.hide(),this.keyboard.press("KeyR")&&this.runLevel(),this.updateCamera(t),this.movePlayer(t),this.map.update(t),this.player.update(t),this.render(this.ctx),this.pointer.update(t),this.animationFrame=requestAnimationFrame((()=>this.update()))}render(e){e.clearRect(0,0,this.canvas.width,this.canvas.height),e.fillStyle="black",e.fillRect(0,0,this.canvas.width,this.canvas.height);const t=this.map.getSize().clone();t.width*=l,t.height*=l;const n=a.getImage("background"),i=e.createPattern(n,"repeat");e.save(),e.translate(this.camera.getPosition().x,this.camera.getPosition().y),e.beginPath(),e.rect(0,0,t.width,t.height),e.fillStyle=i,e.fill(),this.map.render(e),this.player.render(e),e.restore(),this.joystick.render()}listen(){window.addEventListener("resize",this)}unlisten(){window.removeEventListener("resize",this)}handleEvent(e){"resize"===e.type&&this.resize(e)}stop(){cancelAnimationFrame(this.animationFrame)}getZoom(){return this.zoom}getMap(){return this.map}nextLevel(){this.storage.successfulLevel(this.currentLevelName);const e=this.storage.getNextLevelOf(this.currentLevelName);if(e){const n=e.fixed.name;t().route.set(`/level/${n}`,{},{replace:!0})}else t().route.set("/end-game")}runLevel(){const e=this.storage.getLevels()[this.currentLevelName];var t,n;t=e.fixed.screenWidth,n=e.fixed.screenHeight,H.width=t*l,H.height=n*l,this.map=new k(this.storage.getLevels()[this.currentLevelName].fixed.map),this.camera=new i(new w(0,0),new x(100,100)),this.player=new B(this),this.resize()}resize(e=null){const t=j(!0);this.zoom=t.zoom,this.canvas.width=t.size.width/t.zoom,this.canvas.height=t.size.height/t.zoom,this.canvas.style.width=`${t.size.width}px`,this.canvas.style.height=`${t.size.height}px`,this.joystick.setScale(this.zoom),he.resize()}getScreenSize(){return H}getJoystick(){return this.joystick}updateCamera(e){const t=this.getScreenSize().clone(),n=this.map.getDisplayedSize().clone(),i=this.player.getDisplayPosition().clone();i.x=-i.x,i.y=-i.y,i.x-=8,i.y-=8,i.x+=t.width/2,i.y+=t.height/2,i.x=r(i.x,-n.width+t.width,0),i.y=r(i.y,-n.height+t.height,0),this.camera.setPosition(i)}movePlayer(e){if(this.player.isAbleToMove()){let e=!1;(this.keyboard.down("ArrowUp")||this.keyboard.down("KeyW"))&&(0===this.player.getDirection()?e=!0:this.player.move(0)),(this.keyboard.down("ArrowDown")||this.keyboard.down("KeyS"))&&(1===this.player.getDirection()?e=!0:this.player.move(1)),(this.keyboard.down("ArrowRight")||this.keyboard.down("KeyD"))&&(2===this.player.getDirection()?e=!0:this.player.move(2)),(this.keyboard.down("ArrowLeft")||this.keyboard.down("KeyA"))&&(3===this.player.getDirection()?e=!0:this.player.move(3)),e&&this.player.move(this.player.getDirection())}this.updatePlayerFromJoystick()}updatePlayerFromJoystick(){if(this.pointer.down()){const e=document.getElementById("topbar"),t=this.pointer.getLastEvent().target;if(!e.contains(t)){this.joystick.setPointerPosition(this.pointer.getPosition());const e=this.getJoystick().getAxisValues(),t=.65;Math.abs(e.x)>Math.abs(e.y)?(e.x>=t&&this.player.move(2),e.x<=-t&&this.player.move(3)):(e.y>=t&&this.player.move(1),e.y<=-t&&this.player.move(0))}}}}class I{view(e){const n=e.attrs.level,i=[];i.push("level"),i.push(n.dynamic.accessible?"accessible":"unaccessible"),i.push(n.user.success?"success":"unsuccess");const r=i.join(" ");return t()("div",{class:r},[t()(t().route.Link,{href:`/level/${n.fixed.name}`,onclick:e=>this.gotoLevel(e,n.fixed.name)},n.fixed.number)])}oncreate(){he.resize()}gotoLevel(e,n){e.preventDefault(),T.getStorage().getLevels()[n].dynamic.accessible&&t().route.set("/level/:level",{level:n})}}class F{oninit(){T.loadLevels()}view(e){const n=T.getLevels(),i=Object.values(n).map((e=>{const n={level:e};return t()(I,n)}));return[t()("div",{id:"topbar"},[t()("div",{class:"topbar-gamename"},"Bobby"),t()("div",{class:"topbar-menu"},[t()(t().route.Link,{href:"/",class:"topbar-button"},"Retour")])]),t()("div",{class:"main-wrapper main-wrapper-unaligned",role:"main"},[t()("div",{class:"main-content"},[t()("div",{class:"levels"},i)])])]}}function O(e,t){return Math.floor(Math.random()*(t-e+1))+e}const N=["#222","#177355","#053123","#cf5600","#642d06"];class R{constructor(e){this.position=new w(0,0),this.position.x=O(0,e),this.position.y=0,this.velocity=new w(0,0),this.velocity.x=O(-40,40),this.velocity.y=O(180,360),this.color=N[O(0,N.length-1)],this.length=O(10,16),this.angle=O(-10,10)}update(e){this.velocity.y+=120*e,this.position.x+=this.velocity.x*e,this.position.y+=this.velocity.y*e}render(e){e.beginPath(),e.lineWidth=this.length/2,e.strokeStyle=this.color,e.moveTo(this.position.x,this.position.y),e.lineTo(this.position.x+this.angle,this.position.y+this.length),e.stroke()}isOutOfHeight(e){return this.position.y>e}}class D{constructor(){this.canvas=document.getElementById("game"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=800,this.canvas.height=500,this.lastUpdate=Date.now(),this.particles=[],this.listen(),this.resize(),this.update()}update(){const e=Date.now(),t=(e-this.lastUpdate)/1e3;this.lastUpdate=e,Math.random()>.7&&this.particles.push(new R(this.canvas.width));for(const e of this.particles)e.update(t),e.isOutOfHeight(this.canvas.height)&&(this.particles=this.particles.filter((t=>t!==e)));this.render(this.ctx),this.animationFrame=requestAnimationFrame((()=>this.update()))}stop(){cancelAnimationFrame(this.animationFrame)}render(e){e.clearRect(0,0,this.canvas.width,this.canvas.height);for(const t of this.particles)t.render(e)}listen(){window.addEventListener("resize",this)}unlisten(){window.removeEventListener("resize",this)}handleEvent(e){"resize"===e.type&&this.resize(e)}resize(e=null){const t=j(!0);this.canvas.width=t.size.width,this.canvas.height=t.size.height,this.canvas.style.width=`${t.size.width}px`,this.canvas.style.height=`${t.size.height}px`,he.resize()}}class J{view(){return[t()("div",{id:"topbar"},[t()("div",{class:"topbar-gamename"},"Bobby"),t()("div",{class:"topbar-menu"},[t()(t().route.Link,{href:"/",class:"topbar-button"},"Aller à l'écran d'accueil")])]),t()("div",{id:"app-wrapper",role:"main"},[t()("canvas",{id:"game"}),t()("div",{id:"end-game"},[t()("p",{class:"center"},"Félicitations, vous avez fini le jeu. 🎉"),t()("p",{class:"center"},"🥳 Merci d'avoir joué !")])])]}oncreate(e){T.getStorage().areAllLevelsSucceeded()||t().route.set("/choose-level"),he.resize(),this.endGame=new D}onremove(e){this.endGame.stop(),this.endGame.unlisten()}}class W{constructor(){this.keys={},this.lasts=[],this.listen()}listen(){document.addEventListener("keyup",this),document.addEventListener("keydown",this)}unlisten(){document.removeEventListener("keyup",this),document.removeEventListener("keydown",this)}handleEvent(e){switch(e.type){case"keyup":this.onkeyup(e);break;case"keydown":this.onkeydown(e)}}up(e){return!this.keys[e]}down(e){return this.keys[e]}press(e){const t=this.keys[e];return this.keys[e]=!1,t}release(e){const t=this.lasts[this.lasts.indexOf(e)];return void 0!==t&&this.lasts.splice(this.lasts.indexOf(e),1),t===e}onkeyup(e){this.lasts.push(e.code),this.keys[e.code]=!1}onkeydown(e){this.keys[e.code]=!0}}class U{constructor(){this.position=new w(0,0)}setPosition(e){this.position=e}getPosition(){return this.position}}var q;!function(e){e[e.None=0]="None",e[e.Top=1]="Top",e[e.Bottom=2]="Bottom"}(q||(q={}));class _ extends U{constructor(e=null){super(),this.click=null,this.mtime=0,this.loose=null,this.wheelValue=0,this.element=e instanceof HTMLElement?e:document.body,this.lastEvent=null,this.listen()}listen(){this.element.addEventListener("mousedown",this),this.element.addEventListener("mousemove",this),this.element.addEventListener("mouseup",this),this.element.addEventListener("wheel",this)}unlisten(){this.element.removeEventListener("mousedown",this),this.element.removeEventListener("mousemove",this),this.element.removeEventListener("mouseup",this),this.element.removeEventListener("wheel",this)}handleEvent(e){switch(this.lastEvent=e,e.type){case"mousedown":this.onMouseDown(e);break;case"mousemove":this.onMouseMove(e);break;case"mouseup":this.onMouseUp(e);break;case"wheel":this.onWheel(e)}}update(){this.mtime+=1,this.wheelValue=0}up(){return null===this.click}down(){return null!==this.click}press(){return this.click===this.mtime}release(){return this.loose===this.mtime}wheel(){return this.wheelValue<0?q.Top:this.wheelValue>0?q.Bottom:q.None}getLastEvent(){return this.lastEvent}onMouseDown(e){this.onMouseMove(e),this.click=this.mtime}onMouseMove(e){const t=new w(e.pageX-this.element.offsetLeft,e.pageY-this.element.offsetTop);this.setPosition(t)}onMouseUp(e){this.loose=this.mtime,this.click=null}onWheel(e){this.wheelValue=e.deltaY}}class K extends U{constructor(e=null){super(),this.click=null,this.mtime=0,this.loose=null,this.element=e instanceof HTMLElement?e:document.body,this.lastEvent=null,this.listen()}listen(){this.element.addEventListener("touchstart",this),this.element.addEventListener("touchmove",this),this.element.addEventListener("touchend",this)}unlisten(){this.element.removeEventListener("touchstart",this),this.element.removeEventListener("touchmove",this),this.element.removeEventListener("touchend",this)}handleEvent(e){switch(this.lastEvent=e,e.type){case"touchstart":this.onTouchDown(e);break;case"touchmove":this.onTouchMove(e);break;case"touchend":this.onTouchUp(e)}}update(){this.mtime+=1}up(){return null===this.click}down(){return null!==this.click}press(){return this.click===this.mtime}release(){return this.loose===this.mtime}wheel(){return q.None}getLastEvent(){return this.lastEvent}onTouchDown(e){this.onTouchMove(e),this.click=this.mtime}onTouchMove(e){const t=new w(e.targetTouches[0].pageX-this.element.offsetLeft,e.targetTouches[0].pageY-this.element.offsetTop);this.setPosition(t)}onTouchUp(e){this.loose=this.mtime,this.click=null}}class V{view(){return[t()("div",{id:"topbar"},[t()("div",{class:"topbar-level"},"Niveau X/Y"),t()("div",{class:"topbar-menu"},[t()("button",{onclick:Z,class:"topbar-button",title:"Recommencer le niveau"},"⟳"),t()("button",{onclick:G,class:"topbar-button topbar-button-menu"},"Menu"),t()("nav",{class:"topbar-menu-nav"},[t()("button",{onclick:Z,class:"topbar-nav-button"},"Recommencer le niveau"),t()(t().route.Link,{href:"/choose-level",class:"topbar-nav-button"},"Retourner au menu")])])]),t()("div",{id:"app-wrapper",role:"main"},[t()("canvas",{id:"game"}),t()("canvas",{id:"joystick",style:"display: none;"})])]}oncreate(e){he.resize(),this.keyboard=new W,function(){const e=" -webkit- -moz- -o- -ms- ".split(" ");if("ontouchstart"in window)return!0;return t=["(",e.join("touch-enabled),("),"heartz",")"].join(""),window.matchMedia(t).matches;var t}()?this.pointer=new K:this.pointer=new _;const t=e.attrs.level;this.game=new C(this,t),Y(t),document.addEventListener("click",X),document.body.classList.add("bg-dark","overflow-hidden")}onupdate(e){const t=e.attrs;this.game.stop(),this.game.unlisten();const n=t.level;this.game=new C(this,n),Y(n)}onremove(e){this.game.stop(),this.game.unlisten(),document.removeEventListener("click",X),document.body.classList.remove("bg-dark","overflow-hidden"),this.keyboard.unlisten(),this.pointer.unlisten()}getKeyboard(){return this.keyboard}getPointer(){return this.pointer}}function G(e){e.redraw=!1;const t=document.querySelector(".topbar-menu-nav");t instanceof HTMLElement&&t.classList.toggle("topbar-menu-nav-displayed")}function Z(e){e.redraw=!0;const t=document.querySelector(".topbar-menu-nav");t instanceof HTMLElement&&t.classList.remove("topbar-menu-nav-displayed")}function Y(e){const t=document.querySelector(".topbar-level");if(t instanceof HTMLElement){const n=T.getStorage().getLevels(),i=Object.keys(n).length,r=n[e].fixed.number;t.innerText=`${r}/${i}`}}function X(e){const t=document.querySelector(".topbar-button-menu"),n=document.querySelector(".topbar-menu-nav"),i=e.target;n.contains(i)||i===t||n.classList.remove("topbar-menu-nav-displayed")}class Q{view(){return[t()("div",{id:"topbar"},[t()("div",{class:"topbar-gamename"},"Bobby"),t()("div",{class:"topbar-menu"},[t()(t().route.Link,{href:"/",class:"topbar-button"},"Retour")])]),t()("div",{class:"main-wrapper main-wrapper-unaligned",role:"main"},[t()("div",{class:"main-content"},[t()("h2","Touches"),t()("p","Déplacer le personnage avec les flèches directionnelles ↑ ← ↓ → ou ZQSD, ou bien via la souris ou l'écran tactile (appuyer n'importe où pour faire apparaitre le joystick)."),t()("h2","Objectif"),t()("p","Réussir tous les niveaux."),t()("p","Pour chaque niveau, récupérer toutes les pièces puis atteindre la sortie."),t()("h2","Blocs"),t()("p","Les rochers vous bloquent."),t()("p","Les tapis roulant vous emmènent dans une direction donnée."),t()("p","Les boutons ne vous permettent qu'un nombre restreint de passages."),t()("p","Les tourniquets vous bloquent certaines directions et tournent dans le sens horaire quand vous en sortez."),t()("p","La glace vous fait glisser jusqu'au prochain vide ou bloc solide que vous rencontrez.")])])]}oncreate(){he.resize()}}class ee{view(){return[t()("div",{id:"topbar"},[t()("div",{class:"topbar-gamename"},"Bobby")]),t()("div",{class:"main-wrapper",role:"main"},[t()("div",{class:"main-content"},[t()("h1",{class:"logo"},"Bobby"),t()(t().route.Link,{href:"/choose-level",class:"btn-play"},"Jouer")])]),t()("div",{id:"bottombar"},[t()(t().route.Link,{href:"/help",class:"btn"},"Instructions"),t()(t().route.Link,{href:"/credits",class:"btn"},"Crédits"),t()(t().route.Link,{href:"/options",class:"btn"},"Options")])]}oncreate(){he.resize()}}class te{view(){let e="";return e="1"==localStorage.getItem("high-contrast")?"Utiliser un contraste faible":"Utiliser un contraste fort",[t()("div",{id:"topbar"},[t()("div",{class:"topbar-gamename"},"Bobby"),t()("div",{class:"topbar-menu"},[t()(t().route.Link,{href:"/",class:"topbar-button"},"Retour")])]),t()("div",{class:"main-wrapper",role:"main"},[t()("div",{class:"main-content"},[t()("button",{onclick:ne,class:"btn"},"Remise à zéro"),t()("p",{class:"center"},"Cela effacera votre progression et vous ramènera au niveau 1."),t()("button",{onclick:ie,class:"btn"},e)])])]}oncreate(){he.resize()}}function ne(e){confirm("Êtes-vous sûr de vouloir effacer votre progression ?")&&(T.getStorage().reset(),alert("Votre progression a bien été effacée."))}function ie(e){"1"===localStorage.getItem("high-contrast")?(localStorage.setItem("high-contrast","0"),alert("Vous utilisez désormais un contraste faible.")):(localStorage.setItem("high-contrast","1"),alert("Vous utilisez désormais un contraste fort.")),window.location.reload()}const re=["Yannick A. « Pif » : idée, code, graphisme."],oe=["Merci à Aur36 pour son aide sur la réalisation de niveaux, ses nombreux\n  tests et retours et son enthousiasme sans limite.","Merci à oräkle - Ethan G. pour son assistance graphique.","Merci à Alceste_ pour ses améliorations de code et de fonctionnement\n  global.","Merci à Polyson pour sa proposition de niveaux à bords ouverts et ses divers\n  conseils et retours.","Merci aux membres du groupe de développement dont je fais partie pour leur\n  soutien dans le développement du projet, et pour leurs divers retours."];class se{view(){return[t()("div",{id:"topbar"},[t()("div",{class:"topbar-gamename"},"Bobby"),t()("div",{class:"topbar-menu"},[t()(t().route.Link,{href:"/",class:"topbar-button"},"Retour")])]),t()("div",{class:"main-wrapper main-wrapper-unaligned",role:"main"},[t()("div",{class:"main-content"},[t()("h2","Crédits"),re.map((e=>t()("p",e))),t()("h2","Remerciements"),oe.map((e=>t()("p",e))),t()("h2","Code source"),t()("p","Code source sous licence libre AGPLv3+."),t()("p",[t()("a",{href:"https://gitlab.com/yannicka/bobby"},"https://gitlab.com/yannicka/bobby")])])])]}oncreate(){he.resize()}}const ae=n.p+"7ff4cd8bde819c245725fc7bd2aa13c5.png",le=n.p+"d97d7a9c3693111bc7afc3f0d2c0d00f.png",ce=n.p+"b2040711e41243c1d0d633d0da9e73e7.png",ue=n.p+"61afff70749f0a13dbb33483bab09382.png";class he{constructor(){const e=a.load({background:ae,player:le,tiles:"1"==localStorage.getItem("high-contrast")?ue:ce});this.app=document.getElementById("app"),Promise.all(e).then((()=>{this.init()}))}init(){window.addEventListener("resize",he.resize),t().route(this.app,"/",{"/":ee,"/options":te,"/help":Q,"/credits":se,"/choose-level":F,"/level/:level":V,"/end-game":J}),he.resize()}static resize(e=null){const t=document.getElementById("app"),n=j(!!document.getElementById("game")),i=window.innerHeight;t.style.width=`${n.size.width}px`,t.style.height=`${i}px`}}var de=n(731),pe=n(379),me=n.n(pe),fe=n(795),ge=n.n(fe),ve=n(569),ye=n.n(ve),be=n(565),we=n.n(be),$e=n(216),xe=n.n($e),ke=n(589),Se=n.n(ke),Be=n(591),Ee={};Ee.styleTagTransform=Se(),Ee.setAttributes=we(),Ee.insert=ye().bind(null,"head"),Ee.domAPI=ge(),Ee.insertStyleElement=xe(),me()(Be.Z,Ee),Be.Z&&Be.Z.locals&&Be.Z.locals,new he,de.N9()})()})();