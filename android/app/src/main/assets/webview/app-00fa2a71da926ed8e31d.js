!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=32)}([function(e,t,n){"use strict";var i=n(16),r=n(19),o=n(3),s=function(){return i.apply(this,arguments)};s.m=i,s.trust=i.trust,s.fragment=i.fragment,s.mount=o.mount,s.route=n(25),s.render=n(11),s.redraw=o.redraw,s.request=r.request,s.jsonp=r.jsonp,s.parseQueryString=n(14),s.buildQueryString=n(12),s.parsePathname=n(5),s.buildPathname=n(4),s.vnode=n(1),s.PromisePolyfill=n(9),e.exports=s},function(e,t,n){"use strict";function i(e,t,n,i,r,o){return{tag:e,key:t,attrs:n,children:i,text:r,dom:o,domSize:void 0,state:void 0,events:void 0,instance:void 0}}i.normalize=function(e){return Array.isArray(e)?i("[",void 0,void 0,i.normalizeChildren(e),void 0,void 0):null==e||"boolean"==typeof e?null:"object"==typeof e?e:i("#",void 0,void 0,String(e),void 0,void 0)},i.normalizeChildren=function(e){var t=[];if(e.length){for(var n=null!=e[0]&&null!=e[0].key,r=1;r<e.length;r++)if((null!=e[r]&&null!=e[r].key)!==n)throw new TypeError("Vnodes must either always have keys or never have keys!");for(r=0;r<e.length;r++)t[r]=i.normalize(e[r])}return t},e.exports=i},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";var i=n(11);e.exports=n(23)(i,requestAnimationFrame,console)},function(e,t,n){"use strict";var i=n(12),r=n(13);e.exports=function(e,t){if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw new SyntaxError("Template parameter names *must* be separated");if(null==t)return e;var n=e.indexOf("?"),o=e.indexOf("#"),s=o<0?e.length:o,a=n<0?s:n,l=e.slice(0,a),c={};r(c,t);var u=l.replace(/:([^\/\.-]+)(\.{3})?/g,(function(e,n,i){return delete c[n],null==t[n]?e:i?t[n]:encodeURIComponent(String(t[n]))})),h=u.indexOf("?"),d=u.indexOf("#"),f=d<0?u.length:d,m=h<0?f:h,p=u.slice(0,m);n>=0&&(p+=e.slice(n,s)),h>=0&&(p+=(n<0?"?":"&")+u.slice(h,f));var v=i(c);return v&&(p+=(n<0&&h<0?"?":"&")+v),o>=0&&(p+=e.slice(o)),d>=0&&(p+=(o<0?"":"&")+u.slice(d)),p}},function(e,t,n){"use strict";var i=n(14);e.exports=function(e){var t=e.indexOf("?"),n=e.indexOf("#"),r=n<0?e.length:n,o=t<0?r:t,s=e.slice(0,o).replace(/\/{2,}/g,"/");return s?("/"!==s[0]&&(s="/"+s),s.length>1&&"/"===s[s.length-1]&&(s=s.slice(0,-1))):s="/",{path:s,params:t<0?{}:i(e.slice(t+1,r))}}},function(e,t,n){"use strict";var i=n(1),r=n(7),o=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,s={},a={}.hasOwnProperty;function l(e){for(var t in e)if(a.call(e,t))return!1;return!0}function c(e){for(var t,n="div",i=[],r={};t=o.exec(e);){var a=t[1],l=t[2];if(""===a&&""!==l)n=l;else if("#"===a)r.id=l;else if("."===a)i.push(l);else if("["===t[3][0]){var c=t[6];c&&(c=c.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),"class"===t[4]?i.push(c):r[t[4]]=""===c?c:c||!0}}return i.length>0&&(r.className=i.join(" ")),s[e]={tag:n,attrs:r}}function u(e,t){var n=t.attrs,r=i.normalizeChildren(t.children),o=a.call(n,"class"),s=o?n.class:n.className;if(t.tag=e.tag,t.attrs=null,t.children=void 0,!l(e.attrs)&&!l(n)){var c={};for(var u in n)a.call(n,u)&&(c[u]=n[u]);n=c}for(var u in e.attrs)a.call(e.attrs,u)&&"className"!==u&&!a.call(n,u)&&(n[u]=e.attrs[u]);for(var u in null==s&&null==e.attrs.className||(n.className=null!=s?null!=e.attrs.className?String(e.attrs.className)+" "+String(s):s:null!=e.attrs.className?e.attrs.className:null),o&&(n.class=null),n)if(a.call(n,u)&&"key"!==u){t.attrs=n;break}return Array.isArray(r)&&1===r.length&&null!=r[0]&&"#"===r[0].tag?t.text=r[0].children:t.children=r,t}e.exports=function(e){if(null==e||"string"!=typeof e&&"function"!=typeof e&&"function"!=typeof e.view)throw Error("The selector must be either a string or a component.");var t=r.apply(1,arguments);return"string"==typeof e&&(t.children=i.normalizeChildren(t.children),"["!==e)?u(s[e]||c(e),t):(t.tag=e,t)}},function(e,t,n){"use strict";var i=n(1);e.exports=function(){var e,t=arguments[this],n=this+1;if(null==t?t={}:("object"!=typeof t||null!=t.tag||Array.isArray(t))&&(t={},n=this),arguments.length===n+1)e=arguments[n],Array.isArray(e)||(e=[e]);else for(e=[];n<arguments.length;)e.push(arguments[n++]);return i("",t.key,t,e)}},function(e,t,n){"use strict";(function(t){var i=n(9);"undefined"!=typeof window?(void 0===window.Promise?window.Promise=i:window.Promise.prototype.finally||(window.Promise.prototype.finally=i.prototype.finally),e.exports=window.Promise):void 0!==t?(void 0===t.Promise?t.Promise=i:t.Promise.prototype.finally||(t.Promise.prototype.finally=i.prototype.finally),e.exports=t.Promise):e.exports=i}).call(this,n(2))},function(e,t,n){"use strict";(function(t){var n=function(e){if(!(this instanceof n))throw new Error("Promise must be called with `new`");if("function"!=typeof e)throw new TypeError("executor must be a function");var i=this,r=[],o=[],s=u(r,!0),a=u(o,!1),l=i._instance={resolvers:r,rejectors:o},c="function"==typeof t?t:setTimeout;function u(e,t){return function n(s){var u;try{if(!t||null==s||"object"!=typeof s&&"function"!=typeof s||"function"!=typeof(u=s.then))c((function(){t||0!==e.length||console.error("Possible unhandled promise rejection:",s);for(var i=0;i<e.length;i++)e[i](s);r.length=0,o.length=0,l.state=t,l.retry=function(){n(s)}}));else{if(s===i)throw new TypeError("Promise can't be resolved w/ itself");h(u.bind(s))}}catch(e){a(e)}}}function h(e){var t=0;function n(e){return function(n){t++>0||e(n)}}var i=n(a);try{e(n(s),i)}catch(e){i(e)}}h(e)};n.prototype.then=function(e,t){var i,r,o=this._instance;function s(e,t,n,s){t.push((function(t){if("function"!=typeof e)n(t);else try{i(e(t))}catch(e){r&&r(e)}})),"function"==typeof o.retry&&s===o.state&&o.retry()}var a=new n((function(e,t){i=e,r=t}));return s(e,o.resolvers,i,!0),s(t,o.rejectors,r,!1),a},n.prototype.catch=function(e){return this.then(null,e)},n.prototype.finally=function(e){return this.then((function(t){return n.resolve(e()).then((function(){return t}))}),(function(t){return n.resolve(e()).then((function(){return n.reject(t)}))}))},n.resolve=function(e){return e instanceof n?e:new n((function(t){t(e)}))},n.reject=function(e){return new n((function(t,n){n(e)}))},n.all=function(e){return new n((function(t,n){var i=e.length,r=0,o=[];if(0===e.length)t([]);else for(var s=0;s<e.length;s++)!function(s){function a(e){r++,o[s]=e,r===i&&t(o)}null==e[s]||"object"!=typeof e[s]&&"function"!=typeof e[s]||"function"!=typeof e[s].then?a(e[s]):e[s].then(a,n)}(s)}))},n.race=function(e){return new n((function(t,n){for(var i=0;i<e.length;i++)e[i].then(t,n)}))},e.exports=n}).call(this,n(10).setImmediate)},function(e,t,n){(function(e){var i=void 0!==e&&e||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(r.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new o(r.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(20),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(2))},function(e,t,n){"use strict";e.exports=n(22)(window)},function(e,t,n){"use strict";e.exports=function(e){if("[object Object]"!==Object.prototype.toString.call(e))return"";var t=[];for(var n in e)i(n,e[n]);return t.join("&");function i(e,n){if(Array.isArray(n))for(var r=0;r<n.length;r++)i(e+"["+r+"]",n[r]);else if("[object Object]"===Object.prototype.toString.call(n))for(var r in n)i(e+"["+r+"]",n[r]);else t.push(encodeURIComponent(e)+(null!=n&&""!==n?"="+encodeURIComponent(n):""))}}},function(e,t,n){"use strict";e.exports=Object.assign||function(e,t){t&&Object.keys(t).forEach((function(n){e[n]=t[n]}))}},function(e,t,n){"use strict";e.exports=function(e){if(""===e||null==e)return{};"?"===e.charAt(0)&&(e=e.slice(1));for(var t=e.split("&"),n={},i={},r=0;r<t.length;r++){var o=t[r].split("="),s=decodeURIComponent(o[0]),a=2===o.length?decodeURIComponent(o[1]):"";"true"===a?a=!0:"false"===a&&(a=!1);var l=s.split(/\]\[?|\[/),c=i;s.indexOf("[")>-1&&l.pop();for(var u=0;u<l.length;u++){var h=l[u],d=l[u+1],f=""==d||!isNaN(parseInt(d,10));if(""===h)null==n[s=l.slice(0,u).join()]&&(n[s]=Array.isArray(c)?c.length:0),h=n[s]++;else if("__proto__"===h)break;if(u===l.length-1)c[h]=a;else{var m=Object.getOwnPropertyDescriptor(c,h);null!=m&&(m=m.value),null==m&&(c[h]=m=f?[]:{}),c=m}}}return i}},function(e,t){function n(){return"serviceWorker"in navigator&&("https:"===window.location.protocol||"localhost"===window.location.hostname||0===window.location.hostname.indexOf("127."))}t.install=function(e){if(e||(e={}),n())navigator.serviceWorker.register("sw.js",{});else;},t.applyUpdate=function(e,t){},t.update=function(){n()&&navigator.serviceWorker.getRegistration().then((function(e){if(e)return e.update()}))}},function(e,t,n){"use strict";var i=n(6);i.trust=n(17),i.fragment=n(18),e.exports=i},function(e,t,n){"use strict";var i=n(1);e.exports=function(e){return null==e&&(e=""),i("<",void 0,void 0,e,void 0,void 0)}},function(e,t,n){"use strict";var i=n(1),r=n(7);e.exports=function(){var e=r.apply(0,arguments);return e.tag="[",e.children=i.normalizeChildren(e.children),e}},function(e,t,n){"use strict";var i=n(8),r=n(3);e.exports=n(24)(window,i,r.redraw)},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var i,r,o,s,a,l=1,c={},u=!1,h=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?i=function(e){t.nextTick((function(){m(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){m(e.data)},i=function(e){o.port2.postMessage(e)}):h&&"onreadystatechange"in h.createElement("script")?(r=h.documentElement,i=function(e){var t=h.createElement("script");t.onreadystatechange=function(){m(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):i=function(e){setTimeout(m,0,e)}:(s="setImmediate$"+Math.random()+"$",a=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(s)&&m(+t.data.slice(s.length))},e.addEventListener?e.addEventListener("message",a,!1):e.attachEvent("onmessage",a),i=function(t){e.postMessage(s+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return c[l]=r,i(l),l++},d.clearImmediate=f}function f(e){delete c[e]}function m(e){if(u)setTimeout(m,0,e);else{var t=c[e];if(t){u=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{f(e),u=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(2),n(21))},function(e,t){var n,i,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var l,c=[],u=!1,h=-1;function d(){u&&l&&(u=!1,l.length?c=l.concat(c):h=-1,c.length&&f())}function f(){if(!u){var e=a(d);u=!0;for(var t=c.length;t;){for(l=c,c=[];++h<t;)l&&l[h].run();h=-1,t=c.length}l=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new m(e,t)),1!==c.length||u||a(f)},m.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,n){"use strict";var i=n(1);e.exports=function(e){var t,n=e&&e.document,r={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function o(e){return e.attrs&&e.attrs.xmlns||r[e.tag]}function s(e,t){if(e.state!==t)throw new Error("`vnode.state` must not be modified")}function a(e){var t=e.state;try{return this.apply(t,arguments)}finally{s(e,t)}}function l(){try{return n.activeElement}catch(e){return null}}function c(e,t,n,i,r,o,s){for(var a=n;a<i;a++){var l=t[a];null!=l&&u(e,l,r,s,o)}}function u(e,t,r,s,l){var h=t.tag;if("string"==typeof h)switch(t.state={},null!=t.attrs&&I(t.attrs,t,r),h){case"#":!function(e,t,i){t.dom=n.createTextNode(t.children),b(e,t.dom,i)}(e,t,l);break;case"<":d(e,t,s,l);break;case"[":!function(e,t,i,r,o){var s=n.createDocumentFragment();if(null!=t.children){var a=t.children;c(s,a,0,a.length,i,null,r)}t.dom=s.firstChild,t.domSize=s.childNodes.length,b(e,s,o)}(e,t,r,s,l);break;default:!function(e,t,r,s,a){var l=t.tag,u=t.attrs,h=u&&u.is,d=(s=o(t)||s)?h?n.createElementNS(s,l,{is:h}):n.createElementNS(s,l):h?n.createElement(l,{is:h}):n.createElement(l);t.dom=d,null!=u&&function(e,t,n){for(var i in t)E(e,i,null,t[i],n)}(t,u,s);if(b(e,d,a),!w(t)&&(null!=t.text&&(""!==t.text?d.textContent=t.text:t.children=[i("#",void 0,void 0,t.text,void 0,void 0)]),null!=t.children)){var f=t.children;c(d,f,0,f.length,r,null,s),"select"===t.tag&&null!=u&&function(e,t){if("value"in t)if(null===t.value)-1!==e.dom.selectedIndex&&(e.dom.value=null);else{var n=""+t.value;e.dom.value===n&&-1!==e.dom.selectedIndex||(e.dom.value=n)}"selectedIndex"in t&&E(e,"selectedIndex",null,t.selectedIndex,void 0)}(t,u)}}(e,t,r,s,l)}else!function(e,t,n,r,o){(function(e,t){var n;if("function"==typeof e.tag.view){if(e.state=Object.create(e.tag),null!=(n=e.state.view).$$reentrantLock$$)return;n.$$reentrantLock$$=!0}else{if(e.state=void 0,null!=(n=e.tag).$$reentrantLock$$)return;n.$$reentrantLock$$=!0,e.state=null!=e.tag.prototype&&"function"==typeof e.tag.prototype.view?new e.tag(e):e.tag(e)}I(e.state,e,t),null!=e.attrs&&I(e.attrs,e,t);if(e.instance=i.normalize(a.call(e.state.view,e)),e.instance===e)throw Error("A view cannot return the vnode it received as argument");n.$$reentrantLock$$=null})(t,n),null!=t.instance?(u(e,t.instance,n,r,o),t.dom=t.instance.dom,t.domSize=null!=t.dom?t.instance.domSize:0):t.domSize=0}(e,t,r,s,l)}var h={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function d(e,t,i,r){var o=t.children.match(/^\s*?<(\w+)/im)||[],s=n.createElement(h[o[1]]||"div");"http://www.w3.org/2000/svg"===i?(s.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+t.children+"</svg>",s=s.firstChild):s.innerHTML=t.children,t.dom=s.firstChild,t.domSize=s.childNodes.length,t.instance=[];for(var a,l=n.createDocumentFragment();a=s.firstChild;)t.instance.push(a),l.appendChild(a);b(e,l,r)}function f(e,t,n,i,r,o){if(t!==n&&(null!=t||null!=n))if(null==t||0===t.length)c(e,n,0,n.length,i,r,o);else if(null==n||0===n.length)$(e,t,0,t.length);else{var s=null!=t[0]&&null!=t[0].key,a=null!=n[0]&&null!=n[0].key,l=0,h=0;if(!s)for(;h<t.length&&null==t[h];)h++;if(!a)for(;l<n.length&&null==n[l];)l++;if(null===a&&null==s)return;if(s!==a)$(e,t,h,t.length),c(e,n,l,n.length,i,r,o);else if(a){for(var d,f,b,w,k,S=t.length-1,B=n.length-1;S>=h&&B>=l&&(b=t[S],w=n[B],b.key===w.key);)b!==w&&m(e,b,w,i,r,o),null!=w.dom&&(r=w.dom),S--,B--;for(;S>=h&&B>=l&&(d=t[h],f=n[l],d.key===f.key);)h++,l++,d!==f&&m(e,d,f,i,g(t,h,r),o);for(;S>=h&&B>=l&&l!==B&&d.key===w.key&&b.key===f.key;)y(e,b,k=g(t,h,r)),b!==f&&m(e,b,f,i,k,o),++l<=--B&&y(e,d,r),d!==w&&m(e,d,w,i,r,o),null!=w.dom&&(r=w.dom),h++,b=t[--S],w=n[B],d=t[h],f=n[l];for(;S>=h&&B>=l&&b.key===w.key;)b!==w&&m(e,b,w,i,r,o),null!=w.dom&&(r=w.dom),B--,b=t[--S],w=n[B];if(l>B)$(e,t,h,S+1);else if(h>S)c(e,n,l,B+1,i,r,o);else{var E,L,A=r,M=B-l+1,T=new Array(M),P=0,z=0,H=2147483647,j=0;for(z=0;z<M;z++)T[z]=-1;for(z=B;z>=l;z--){null==E&&(E=p(t,h,S+1));var C=E[(w=n[z]).key];null!=C&&(H=C<H?C:-1,T[z-l]=C,b=t[C],t[C]=null,b!==w&&m(e,b,w,i,r,o),null!=w.dom&&(r=w.dom),j++)}if(r=A,j!==S-h+1&&$(e,t,h,S+1),0===j)c(e,n,l,B+1,i,r,o);else if(-1===H)for(P=(L=function(e){var t=[0],n=0,i=0,r=0,o=v.length=e.length;for(r=0;r<o;r++)v[r]=e[r];for(r=0;r<o;++r)if(-1!==e[r]){var s=t[t.length-1];if(e[s]<e[r])v[r]=s,t.push(r);else{for(n=0,i=t.length-1;n<i;){var a=(n>>>1)+(i>>>1)+(n&i&1);e[t[a]]<e[r]?n=a+1:i=a}e[r]<e[t[n]]&&(n>0&&(v[r]=t[n-1]),t[n]=r)}}n=t.length,i=t[n-1];for(;n-- >0;)t[n]=i,i=v[i];return v.length=0,t}(T)).length-1,z=B;z>=l;z--)f=n[z],-1===T[z-l]?u(e,f,i,o,r):L[P]===z-l?P--:y(e,f,r),null!=f.dom&&(r=n[z].dom);else for(z=B;z>=l;z--)f=n[z],-1===T[z-l]&&u(e,f,i,o,r),null!=f.dom&&(r=n[z].dom)}}else{var I=t.length<n.length?t.length:n.length;for(l=l<h?l:h;l<I;l++)(d=t[l])===(f=n[l])||null==d&&null==f||(null==d?u(e,f,i,o,g(t,l+1,r)):null==f?x(e,d):m(e,d,f,i,g(t,l+1,r),o));t.length>I&&$(e,t,l,t.length),n.length>I&&c(e,n,l,n.length,i,r,o)}}}function m(e,t,n,r,s,l){var c=t.tag;if(c===n.tag){if(n.state=t.state,n.events=t.events,function(e,t){do{var n;if(null!=e.attrs&&"function"==typeof e.attrs.onbeforeupdate)if(void 0!==(n=a.call(e.attrs.onbeforeupdate,e,t))&&!n)break;if("string"!=typeof e.tag&&"function"==typeof e.state.onbeforeupdate)if(void 0!==(n=a.call(e.state.onbeforeupdate,e,t))&&!n)break;return!1}while(0);return e.dom=t.dom,e.domSize=t.domSize,e.instance=t.instance,e.attrs=t.attrs,e.children=t.children,e.text=t.text,!0}(n,t))return;if("string"==typeof c)switch(null!=n.attrs&&O(n.attrs,n,r),c){case"#":!function(e,t){e.children.toString()!==t.children.toString()&&(e.dom.nodeValue=t.children);t.dom=e.dom}(t,n);break;case"<":!function(e,t,n,i,r){t.children!==n.children?(k(e,t),d(e,n,i,r)):(n.dom=t.dom,n.domSize=t.domSize,n.instance=t.instance)}(e,t,n,l,s);break;case"[":!function(e,t,n,i,r,o){f(e,t.children,n.children,i,r,o);var s=0,a=n.children;if(n.dom=null,null!=a){for(var l=0;l<a.length;l++){var c=a[l];null!=c&&null!=c.dom&&(null==n.dom&&(n.dom=c.dom),s+=c.domSize||1)}1!==s&&(n.domSize=s)}}(e,t,n,r,s,l);break;default:!function(e,t,n,r){var s=t.dom=e.dom;r=o(t)||r,"textarea"===t.tag&&(null==t.attrs&&(t.attrs={}),null!=t.text&&(t.attrs.value=t.text,t.text=void 0));(function(e,t,n,i){if(null!=n)for(var r in n)E(e,r,t&&t[r],n[r],i);var o;if(null!=t)for(var r in t)null==(o=t[r])||null!=n&&null!=n[r]||L(e,r,o,i)})(t,e.attrs,t.attrs,r),w(t)||(null!=e.text&&null!=t.text&&""!==t.text?e.text.toString()!==t.text.toString()&&(e.dom.firstChild.nodeValue=t.text):(null!=e.text&&(e.children=[i("#",void 0,void 0,e.text,void 0,e.dom.firstChild)]),null!=t.text&&(t.children=[i("#",void 0,void 0,t.text,void 0,void 0)]),f(s,e.children,t.children,n,null,r)))}(t,n,r,l)}else!function(e,t,n,r,o,s){if(n.instance=i.normalize(a.call(n.state.view,n)),n.instance===n)throw Error("A view cannot return the vnode it received as argument");O(n.state,n,r),null!=n.attrs&&O(n.attrs,n,r);null!=n.instance?(null==t.instance?u(e,n.instance,r,s,o):m(e,t.instance,n.instance,r,o,s),n.dom=n.instance.dom,n.domSize=n.instance.domSize):null!=t.instance?(x(e,t.instance),n.dom=void 0,n.domSize=0):(n.dom=t.dom,n.domSize=t.domSize)}(e,t,n,r,s,l)}else x(e,t),u(e,n,r,l,s)}function p(e,t,n){for(var i=Object.create(null);t<n;t++){var r=e[t];if(null!=r){var o=r.key;null!=o&&(i[o]=t)}}return i}var v=[];function g(e,t,n){for(;t<e.length;t++)if(null!=e[t]&&null!=e[t].dom)return e[t].dom;return n}function y(e,t,i){var r=n.createDocumentFragment();!function e(t,n,i){for(;null!=i.dom&&i.dom.parentNode===t;){if("string"!=typeof i.tag){if(null!=(i=i.instance))continue}else if("<"===i.tag)for(var r=0;r<i.instance.length;r++)n.appendChild(i.instance[r]);else if("["!==i.tag)n.appendChild(i.dom);else if(1===i.children.length){if(null!=(i=i.children[0]))continue}else for(r=0;r<i.children.length;r++){var o=i.children[r];null!=o&&e(t,n,o)}break}}(e,r,t),b(e,r,i)}function b(e,t,n){null!=n?e.insertBefore(t,n):e.appendChild(t)}function w(e){if(null==e.attrs||null==e.attrs.contenteditable&&null==e.attrs.contentEditable)return!1;var t=e.children;if(null!=t&&1===t.length&&"<"===t[0].tag){var n=t[0].children;e.dom.innerHTML!==n&&(e.dom.innerHTML=n)}else if(null!=e.text||null!=t&&0!==t.length)throw new Error("Child node of a contenteditable must be trusted");return!0}function $(e,t,n,i){for(var r=n;r<i;r++){var o=t[r];null!=o&&x(e,o)}}function x(e,t){var n,i,r,o=0,l=t.state;"string"!=typeof t.tag&&"function"==typeof t.state.onbeforeremove&&(null!=(r=a.call(t.state.onbeforeremove,t))&&"function"==typeof r.then&&(o=1,n=r));t.attrs&&"function"==typeof t.attrs.onbeforeremove&&(null!=(r=a.call(t.attrs.onbeforeremove,t))&&"function"==typeof r.then&&(o|=2,i=r));if(s(t,l),o){if(null!=n){var c=function(){1&o&&((o&=2)||u())};n.then(c,c)}if(null!=i){c=function(){2&o&&((o&=1)||u())};i.then(c,c)}}else B(t),S(e,t);function u(){s(t,l),B(t),S(e,t)}}function k(e,t){for(var n=0;n<t.instance.length;n++)e.removeChild(t.instance[n])}function S(e,t){for(;null!=t.dom&&t.dom.parentNode===e;){if("string"!=typeof t.tag){if(null!=(t=t.instance))continue}else if("<"===t.tag)k(e,t);else{if("["!==t.tag&&(e.removeChild(t.dom),!Array.isArray(t.children)))break;if(1===t.children.length){if(null!=(t=t.children[0]))continue}else for(var n=0;n<t.children.length;n++){var i=t.children[n];null!=i&&S(e,i)}}break}}function B(e){if("string"!=typeof e.tag&&"function"==typeof e.state.onremove&&a.call(e.state.onremove,e),e.attrs&&"function"==typeof e.attrs.onremove&&a.call(e.attrs.onremove,e),"string"!=typeof e.tag)null!=e.instance&&B(e.instance);else{var t=e.children;if(Array.isArray(t))for(var n=0;n<t.length;n++){var i=t[n];null!=i&&B(i)}}}function E(e,t,i,r,o){if("key"!==t&&"is"!==t&&null!=r&&!A(t)&&(i!==r||function(e,t){return"value"===t||"checked"===t||"selectedIndex"===t||"selected"===t&&e.dom===l()||"option"===e.tag&&e.dom.parentNode===n.activeElement}(e,t)||"object"==typeof r)){if("o"===t[0]&&"n"===t[1])return C(e,t,r);if("xlink:"===t.slice(0,6))e.dom.setAttributeNS("http://www.w3.org/1999/xlink",t.slice(6),r);else if("style"===t)H(e.dom,i,r);else if(M(e,t,o)){if("value"===t){if(("input"===e.tag||"textarea"===e.tag)&&e.dom.value===""+r&&e.dom===l())return;if("select"===e.tag&&null!==i&&e.dom.value===""+r)return;if("option"===e.tag&&null!==i&&e.dom.value===""+r)return}"input"===e.tag&&"type"===t?e.dom.setAttribute(t,r):e.dom[t]=r}else"boolean"==typeof r?r?e.dom.setAttribute(t,""):e.dom.removeAttribute(t):e.dom.setAttribute("className"===t?"class":t,r)}}function L(e,t,n,i){if("key"!==t&&"is"!==t&&null!=n&&!A(t))if("o"!==t[0]||"n"!==t[1]||A(t))if("style"===t)H(e.dom,n,null);else if(!M(e,t,i)||"className"===t||"value"===t&&("option"===e.tag||"select"===e.tag&&-1===e.dom.selectedIndex&&e.dom===l())||"input"===e.tag&&"type"===t){var r=t.indexOf(":");-1!==r&&(t=t.slice(r+1)),!1!==n&&e.dom.removeAttribute("className"===t?"class":t)}else e.dom[t]=null;else C(e,t,void 0)}function A(e){return"oninit"===e||"oncreate"===e||"onupdate"===e||"onremove"===e||"onbeforeremove"===e||"onbeforeupdate"===e}function M(e,t,n){return void 0===n&&(e.tag.indexOf("-")>-1||null!=e.attrs&&e.attrs.is||"href"!==t&&"list"!==t&&"form"!==t&&"width"!==t&&"height"!==t)&&t in e.dom}var T=/[A-Z]/g;function P(e){return"-"+e.toLowerCase()}function z(e){return"-"===e[0]&&"-"===e[1]?e:"cssFloat"===e?"float":e.replace(T,P)}function H(e,t,n){if(t===n);else if(null==n)e.style.cssText="";else if("object"!=typeof n)e.style.cssText=n;else if(null==t||"object"!=typeof t)for(var i in e.style.cssText="",n){null!=(r=n[i])&&e.style.setProperty(z(i),String(r))}else{for(var i in n){var r;null!=(r=n[i])&&(r=String(r))!==String(t[i])&&e.style.setProperty(z(i),r)}for(var i in t)null!=t[i]&&null==n[i]&&e.style.removeProperty(z(i))}}function j(){this._=t}function C(e,t,n){if(null!=e.events){if(e.events[t]===n)return;null==n||"function"!=typeof n&&"object"!=typeof n?(null!=e.events[t]&&e.dom.removeEventListener(t.slice(2),e.events,!1),e.events[t]=void 0):(null==e.events[t]&&e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=n)}else null==n||"function"!=typeof n&&"object"!=typeof n||(e.events=new j,e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=n)}function I(e,t,n){"function"==typeof e.oninit&&a.call(e.oninit,t),"function"==typeof e.oncreate&&n.push(a.bind(e.oncreate,t))}function O(e,t,n){"function"==typeof e.onupdate&&n.push(a.bind(e.onupdate,t))}return j.prototype=Object.create(null),j.prototype.handleEvent=function(e){var t,n=this["on"+e.type];"function"==typeof n?t=n.call(e.currentTarget,e):"function"==typeof n.handleEvent&&n.handleEvent(e),this._&&!1!==e.redraw&&(0,this._)(),!1===t&&(e.preventDefault(),e.stopPropagation())},function(e,n,r){if(!e)throw new TypeError("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var o=[],s=l(),a=e.namespaceURI;null==e.vnodes&&(e.textContent=""),n=i.normalizeChildren(Array.isArray(n)?n:[n]);var c=t;try{t="function"==typeof r?r:void 0,f(e,e.vnodes,n,o,null,"http://www.w3.org/1999/xhtml"===a?void 0:a)}finally{t=c}e.vnodes=n,null!=s&&l()!==s&&"function"==typeof s.focus&&s.focus();for(var u=0;u<o.length;u++)o[u]()}}},function(e,t,n){"use strict";var i=n(1);e.exports=function(e,t,n){var r=[],o=!1,s=!1;function a(){if(o)throw new Error("Nested m.redraw.sync() call");o=!0;for(var t=0;t<r.length;t+=2)try{e(r[t],i(r[t+1]),l)}catch(e){n.error(e)}o=!1}function l(){s||(s=!0,t((function(){s=!1,a()})))}return l.sync=a,{mount:function(t,n){if(null!=n&&null==n.view&&"function"!=typeof n)throw new TypeError("m.mount(element, component) expects a component, not a vnode");var o=r.indexOf(t);o>=0&&(r.splice(o,2),e(t,[],l)),null!=n&&(r.push(t,n),e(t,i(n),l))},redraw:l}}},function(e,t,n){"use strict";var i=n(4);e.exports=function(e,t,n){var r=0;function o(e){return new t(e)}function s(e){return function(r,s){"string"!=typeof r?(s=r,r=r.url):null==s&&(s={});var a=new t((function(t,n){e(i(r,s.params),s,(function(e){if("function"==typeof s.type)if(Array.isArray(e))for(var n=0;n<e.length;n++)e[n]=new s.type(e[n]);else e=new s.type(e);t(e)}),n)}));if(!0===s.background)return a;var l=0;function c(){0==--l&&"function"==typeof n&&n()}return function e(t){var n=t.then;return t.constructor=o,t.then=function(){l++;var i=n.apply(t,arguments);return i.then(c,(function(e){if(c(),0===l)throw e})),e(i)},t}(a)}}function a(e,t){for(var n in e.headers)if({}.hasOwnProperty.call(e.headers,n)&&t.test(n))return!0;return!1}return o.prototype=t.prototype,o.__proto__=t,{request:s((function(t,n,i,r){var o,s=null!=n.method?n.method.toUpperCase():"GET",l=n.body,c=!(null!=n.serialize&&n.serialize!==JSON.serialize||l instanceof e.FormData),u=n.responseType||("function"==typeof n.extract?"":"json"),h=new e.XMLHttpRequest,d=!1,f=h,m=h.abort;for(var p in h.abort=function(){d=!0,m.call(this)},h.open(s,t,!1!==n.async,"string"==typeof n.user?n.user:void 0,"string"==typeof n.password?n.password:void 0),c&&null!=l&&!a(n,/^content-type$/i)&&h.setRequestHeader("Content-Type","application/json; charset=utf-8"),"function"==typeof n.deserialize||a(n,/^accept$/i)||h.setRequestHeader("Accept","application/json, text/*"),n.withCredentials&&(h.withCredentials=n.withCredentials),n.timeout&&(h.timeout=n.timeout),h.responseType=u,n.headers)({}).hasOwnProperty.call(n.headers,p)&&h.setRequestHeader(p,n.headers[p]);h.onreadystatechange=function(e){if(!d&&4===e.target.readyState)try{var o,s=e.target.status>=200&&e.target.status<300||304===e.target.status||/^file:\/\//i.test(t),a=e.target.response;if("json"===u?e.target.responseType||"function"==typeof n.extract||(a=JSON.parse(e.target.responseText)):u&&"text"!==u||null==a&&(a=e.target.responseText),"function"==typeof n.extract?(a=n.extract(e.target,n),s=!0):"function"==typeof n.deserialize&&(a=n.deserialize(a)),s)i(a);else{try{o=e.target.responseText}catch(e){o=a}var l=new Error(o);l.code=e.target.status,l.response=a,r(l)}}catch(e){r(e)}},"function"==typeof n.config&&(h=n.config(h,n,t)||h)!==f&&(o=h.abort,h.abort=function(){d=!0,o.call(this)}),null==l?h.send():"function"==typeof n.serialize?h.send(n.serialize(l)):l instanceof e.FormData?h.send(l):h.send(JSON.stringify(l))})),jsonp:s((function(t,n,i,o){var s=n.callbackName||"_mithril_"+Math.round(1e16*Math.random())+"_"+r++,a=e.document.createElement("script");e[s]=function(t){delete e[s],a.parentNode.removeChild(a),i(t)},a.onerror=function(){delete e[s],a.parentNode.removeChild(a),o(new Error("JSONP request failed"))},a.src=t+(t.indexOf("?")<0?"?":"&")+encodeURIComponent(n.callbackKey||"callback")+"="+encodeURIComponent(s),e.document.documentElement.appendChild(a)}))}}},function(e,t,n){"use strict";var i=n(3);e.exports=n(26)(window,i)},function(e,t,n){"use strict";(function(t){var i=n(1),r=n(6),o=n(8),s=n(4),a=n(5),l=n(27),c=n(13),u={};e.exports=function(e,n){var h;function d(t,n,i){if(t=s(t,n),null!=h){h();var r=i?i.state:null,o=i?i.title:null;i&&i.replace?e.history.replaceState(r,o,b.prefix+t):e.history.pushState(r,o,b.prefix+t)}else e.location.href=b.prefix+t}var f,m,p,v,g=u,y=b.SKIP={};function b(r,s,w){if(null==r)throw new Error("Ensure the DOM element that was passed to `m.route` is not undefined");var $,x=0,k=Object.keys(w).map((function(e){if("/"!==e[0])throw new SyntaxError("Routes must start with a `/`");if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw new SyntaxError("Route parameter names must be separated with either `/`, `.`, or `-`");return{route:e,component:w[e],check:l(e)}})),S="function"==typeof t?t:setTimeout,B=o.resolve(),E=!1;if(h=null,null!=s){var L=a(s);if(!k.some((function(e){return e.check(L)})))throw new ReferenceError("Default route doesn't match any known routes")}function A(){E=!1;var t=e.location.hash;"#"!==b.prefix[0]&&(t=e.location.search+t,"?"!==b.prefix[0]&&"/"!==(t=e.location.pathname+t)[0]&&(t="/"+t));var i=t.concat().replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent).slice(b.prefix.length),r=a(i);function o(){if(i===s)throw new Error("Could not resolve default route "+s);d(s,null,{replace:!0})}c(r.params,e.history.state),function e(t){for(;t<k.length;t++)if(k[t].check(r)){var s=k[t].component,a=k[t].route,l=s,c=v=function(o){if(c===v){if(o===y)return e(t+1);f=null==o||"function"!=typeof o.view&&"function"!=typeof o?"div":o,m=r.params,p=i,v=null,g=s.render?s:null,2===x?n.redraw():(x=2,n.redraw.sync())}};return void(s.view||"function"==typeof s?(s={},c(l)):s.onmatch?B.then((function(){return s.onmatch(r.params,i,a)})).then(c,o):c("div"))}o()}(0)}return h=function(){E||(E=!0,S(A))},"function"==typeof e.history.pushState?($=function(){e.removeEventListener("popstate",h,!1)},e.addEventListener("popstate",h,!1)):"#"===b.prefix[0]&&(h=null,$=function(){e.removeEventListener("hashchange",A,!1)},e.addEventListener("hashchange",A,!1)),n.mount(r,{onbeforeupdate:function(){return!(!(x=x?2:1)||u===g)},oncreate:A,onremove:$,view:function(){if(x&&u!==g){var e=[i(f,m.key,m)];return g&&(e=g.render(e[0])),e}}})}return b.set=function(e,t,n){null!=v&&((n=n||{}).replace=!0),v=null,d(e,t,n)},b.get=function(){return p},b.prefix="#!",b.Link={view:function(e){var t,n,i=e.attrs.options,o={};c(o,e.attrs),o.selector=o.options=o.key=o.oninit=o.oncreate=o.onbeforeupdate=o.onupdate=o.onbeforeremove=o.onremove=null;var s=r(e.attrs.selector||"a",o,e.children);return(s.attrs.disabled=Boolean(s.attrs.disabled))?(s.attrs.href=null,s.attrs["aria-disabled"]="true",s.attrs.onclick=null):(t=s.attrs.onclick,n=s.attrs.href,s.attrs.href=b.prefix+n,s.attrs.onclick=function(e){var r;"function"==typeof t?r=t.call(e.currentTarget,e):null==t||"object"!=typeof t||"function"==typeof t.handleEvent&&t.handleEvent(e),!1===r||e.defaultPrevented||0!==e.button&&0!==e.which&&1!==e.which||e.currentTarget.target&&"_self"!==e.currentTarget.target||e.ctrlKey||e.metaKey||e.shiftKey||e.altKey||(e.preventDefault(),e.redraw=!1,b.set(n,null,i))}),s}},b.param=function(e){return m&&null!=e?m[e]:m},b}}).call(this,n(10).setImmediate)},function(e,t,n){"use strict";var i=n(5);e.exports=function(e){var t=i(e),n=Object.keys(t.params),r=[],o=new RegExp("^"+t.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,(function(e,t,n){return null==t?"\\"+e:(r.push({k:t,r:"..."===n}),"..."===n?"(.*)":"."===n?"([^/]+)\\.":"([^/]+)"+(n||""))}))+"$");return function(e){for(var i=0;i<n.length;i++)if(t.params[n[i]]!==e.params[n[i]])return!1;if(!r.length)return o.test(e.path);var s=o.exec(e.path);if(null==s)return!1;for(i=0;i<r.length;i++)e.params[r[i].k]=r[i].r?s[i+1]:decodeURIComponent(s[i+1]);return!0}}},function(e,t,n){var i=n(29),r=n(30);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1};i(r,o);e.exports=r.locals||{}},function(e,t,n){"use strict";var i,r=function(){return void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i},o=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),s=[];function a(e){for(var t=-1,n=0;n<s.length;n++)if(s[n].identifier===e){t=n;break}return t}function l(e,t){for(var n={},i=[],r=0;r<e.length;r++){var o=e[r],l=t.base?o[0]+t.base:o[0],c=n[l]||0,u="".concat(l," ").concat(c);n[l]=c+1;var h=a(u),d={css:o[1],media:o[2],sourceMap:o[3]};-1!==h?(s[h].references++,s[h].updater(d)):s.push({identifier:u,updater:v(d,t),references:1}),i.push(u)}return i}function c(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var r=n.nc;r&&(i.nonce=r)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var s=o(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}var u,h=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function d(e,t,n,i){var r=n?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=h(t,r);else{var o=document.createTextNode(r),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(o,s[t]):e.appendChild(o)}}function f(e,t,n){var i=n.css,r=n.media,o=n.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),o&&btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var m=null,p=0;function v(e,t){var n,i,r;if(t.singleton){var o=p++;n=m||(m=c(t)),i=d.bind(null,n,o,!1),r=d.bind(null,n,o,!0)}else n=c(t),i=f.bind(null,n,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=r());var n=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<n.length;i++){var r=a(n[i]);s[r].references--}for(var o=l(e,t),c=0;c<n.length;c++){var u=a(n[c]);0===s[u].references&&(s[u].updater(),s.splice(u,1))}n=o}}}},function(e,t,n){(t=n(31)(!1)).push([e.i,":root {\n  --background-color: #f7f3ef;\n  --dark-background-color: #222;\n\n  --primary-color: #177355;\n  --primary-color-darker: #053123;\n\n  --secondary-color: #cf5600;\n  --secondary-color-darker: #642d06;\n}\n\nhtml,\nbody {\n  margin: 0;\n  padding: 0;\n}\n\nhtml {\n  font-size: 1.2em;\n  scrollbar-color: var(--primary-color) rgba(0, 0, 0, 0.3);\n}\n\n/* Pour les écrans tactiles : barre de défilement fine */\n@media (pointer: coarse) {\n  html {\n    scrollbar-width: thin;\n  }\n}\n\nbody {\n  background-color: var(--background-color);\n  font-family: -apple-system, 'Ubuntu', system-ui, sans-serif;\n}\n\nbutton {\n  font: inherit;\n  color: inherit;\n}\n\np {\n  padding: 8px;\n  margin: 8px;\n}\n\nh2 {\n  padding: 8px;\n  margin: 8px;\n  margin-bottom: 0;\n  font-size: 2em;\n}\n\n.center {\n  text-align: center;\n}\n\n.overflow-hidden {\n  overflow: hidden;\n}\n\n.bg-dark {\n  background-color: var(--dark-background-color);\n}\n\n.btn {\n  padding: 10px 20px;\n  display: inline-block;\n  border: none;\n  background-color: var(--secondary-color);\n  text-align: center;\n  font-size: 1.2em;\n  color: white;\n  text-decoration: none;\n  margin: 16px auto;\n}\n\n.btn:focus,\n.btn:hover {\n  outline: 3px solid var(--secondary-color-darker);\n  cursor: pointer;\n}\n\n.btn-play {\n  padding: 20px 40px;\n  display: inline-block;\n  color: var(--secondary-color);\n  border: 2px solid currentColor;\n  border-bottom-width: 12px;\n  text-align: center;\n  font-size: 2em;\n  text-transform: uppercase;\n  text-decoration: none;\n  margin: 16px auto;\n}\n\n.btn-play:focus,\n.btn-play:hover {\n  color: var(--secondary-color-darker);\n  cursor: pointer;\n  outline: none;\n}\n\n.logo {\n  margin: 0 auto 64px auto;\n  font-size: 120px;\n  color: var(--primary-color);\n  text-transform: uppercase;\n  font-weight: normal;\n}\n\n@media (max-width: 600px), (max-height: 600px) {\n  .logo {\n    font-size: 80px;\n    margin-bottom: 32px;\n  }\n}\n\n.levels {\n  list-style: none;\n  display: grid;\n  grid-template-columns: repeat(auto-fill, 60px);\n  gap: 16px;\n  margin: 12px;\n  justify-content: center;\n  padding: 16px;\n}\n\n.level a {\n  display: block;\n  background-color: #767676;\n  padding: 20px 8px;\n  color: white;\n  text-decoration: none;\n  text-align: center;\n  border: none;\n  width: 100%;\n  box-sizing: border-box;\n}\n\n.level a:focus,\n.level a:hover {\n  outline: 3px solid var(--primary-color-darker);\n  cursor: pointer;\n}\n\n.level.accessible a {\n  background-color: #842733;\n}\n\n.level.success.accessible a {\n  background-color: var(--primary-color);\n}\n\n#topbar {\n  background-color: var(--primary-color);\n  display: flex;\n}\n\n.topbar-gamename {\n  padding: 12px;\n  color: #fff;\n  margin: 0;\n  text-align: center;\n  text-transform: uppercase;\n}\n\n.topbar-level {\n  padding: 12px;\n  color: #fff;\n}\n\n.topbar-menu {\n  margin-left: auto;\n  position: relative;\n}\n\n.topbar-button {\n  padding: 12px 18px;\n  margin: 0;\n  border: none;\n  background: transparent;\n  display: inline-block;\n  color: #fff;\n  height: 100%;\n  box-sizing: border-box;\n  text-decoration: none;\n}\n\n.topbar-button:focus,\n.topbar-button:hover {\n  background-color: rgba(0, 0, 0, 0.3);\n  outline: none;\n  cursor: pointer;\n}\n\n.topbar-menu-nav {\n  position: absolute;\n  top: 100%;\n  right: 0;\n  display: flex;\n  flex-direction: column;\n  width: 290px;\n  box-shadow: 0 0 8px 0 rgba(0, 0, 0, 0.4);\n  display: none;\n}\n\n.topbar-menu-nav-displayed {\n  display: block;\n}\n\n.topbar-nav-button {\n  padding: 12px 24px;\n  border: none;\n  background: #fff;\n  text-align: left;\n  width: 100%;\n  text-decoration: none;\n  display: inline-block;\n  color: inherit;\n  box-sizing: border-box;\n}\n\n.topbar-nav-button:focus,\n.topbar-nav-button:hover {\n  background: #ccc;\n  cursor: pointer;\n}\n\n.main-wrapper {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  overflow: auto;\n}\n\n.main-wrapper-unaligned {\n  align-items: initial;\n}\n\n.main-content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n}\n\n#bottombar {\n  background-color: var(--primary-color);\n  display: flex;\n  font-size: 80%;\n  flex-wrap: wrap;\n}\n\n#bottombar .btn {\n  background-color: rgba(0, 0, 0, 0.3);\n}\n\n#bottombar .btn:focus,\n#bottombar .btn:hover {\n  outline-color: var(--primary-color-darker);\n}\n\n#app {\n  margin: 0 auto;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n}\n\n#app-wrapper {\n  height: 100%;\n  display: grid;\n  align-content: center;\n}\n\n#game {\n  image-rendering: crisp-edges;\n  image-rendering: pixelated;\n}\n\n#joystick {\n  position: fixed;\n}\n\n@keyframes end-game-text-animation {\n  0% {\n    color: var(--primary-color-darker);\n  }\n\n  100% {\n    color: var(--secondary-color-darker);\n  }\n}\n\n#end-game {\n  position: absolute;\n  top: 44%;\n  left: 0;\n  right: 0;\n  font-size: 140%;\n  font-weight: bold;\n  animation: end-game-text-animation 2s;\n  animation-direction: alternate-reverse;\n  animation-iteration-count: infinite;\n  animation-timing-function: linear;\n}\n",""]),e.exports=t},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",i=e[3];if(!i)return n;if(t&&"function"==typeof btoa){var r=(s=i,a=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(l," */")),o=i.sources.map((function(e){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(e," */")}));return[n].concat(o).concat([r]).join("\n")}var s,a,l;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,i){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(i)for(var o=0;o<this.length;o++){var s=this[o][0];null!=s&&(r[s]=!0)}for(var a=0;a<e.length;a++){var l=[].concat(e[a]);i&&r[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),t.push(l))}},t}},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i);class o{constructor(e,t){this.position=e,this.size=t}getPosition(){return this.position}setPosition(e){this.position=e}getSize(){return this.size}setSize(e){this.size=e}}function s(e,t,n){return Math.min(n,Math.max(t,e))}class a{constructor(e,t,n,i,{frameDuration:r=1,loop:o=!0}){this.image=e,this.frames=t,this.frameWidth=n,this.frameHeight=i,this.frameDuration=r,this.loop=o,this.timer=0,this.currentIndex=0,this.finished=!1}update(e){if(!(this.finished||this.frames.length<=1))for(this.timer+=e;this.timer>this.frameDuration;)this.currentIndex+=1,this.currentIndex>=this.frames.length&&(this.loop?this.currentIndex=0:(this.finished=!0,this.currentIndex-=1)),this.timer=this.timer-this.frameDuration}render(e){!function(e,t,n,i,r,o,s){const a=Math.ceil(t.width/o),l=r%a*o,c=Math.floor(r/a)*s;e.drawImage(t,l,c,o,s,n,i,o,s)}(e,this.image,0,0,this.getCurrentFrame(),this.frameWidth,this.frameHeight)}restart(){this.timer=0,this.currentIndex=0,this.finished=!1}getCurrentFrame(){return this.frames[this.currentIndex]}}class l{constructor(e,t,n){this.image=e,this.frameWidth=t,this.frameHeight=n,this.animations={},this.currentAnimation=null}update(e){this.currentAnimation instanceof a&&this.currentAnimation.update(e)}render(e){this.currentAnimation instanceof a&&this.currentAnimation.render(e)}addAnimation(e,t,n={}){const i=new a(this.image,t,this.frameWidth,this.frameHeight,n);this.animations[e]=i}play(e,t=!1){const n=this.animations[e];(this.currentAnimation!==n||t)&&(this.currentAnimation=n,n.restart())}}class c{static getImage(e){return c.images[e]}static load(e){const t=new Array;for(const[n,i]of Object.entries(e)){const e=document.createElement("img"),r=new Promise((t,r)=>{e.addEventListener("load",()=>{c.images[n]=e,t(e)}),e.addEventListener("error",e=>{console.error(e),r(`Impossible de charger l'image « ${i} »`)})});e.src=i,t.push(r)}return t}}c.images={};class u{constructor(e){this.position=e;const t=c.getImage("tiles");this.animationManager=new l(t,16,16)}update(e){this.animationManager.update(e)}render(e){e.save(),e.translate(16*this.position.x,16*this.position.y),this.animationManager.render(e),e.restore()}onBeforePlayerIn(e){}onAfterPlayerIn(e,t){return this}onAfterPlayerOut(){}canEnter(e){return!1}canLeave(e){return!1}getPosition(){return this.position}getAnimationManager(){return this.animationManager}}class h extends u{constructor(e){super(e),this.getAnimationManager().addAnimation("idle",[0]),this.getAnimationManager().play("idle")}canEnter(){return!0}}class d extends u{constructor(e,t){super(e),this.value=t,this.getAnimationManager().addAnimation("activated",[80]),this.getAnimationManager().addAnimation("deactivated-1",[81]),this.getAnimationManager().addAnimation("deactivated-2",[82]),this.getAnimationManager().addAnimation("deactivated-3",[83]),this.getAnimationManager().play("deactivated-"+this.value)}onAfterPlayerOut(){this.value-=1,0===this.value?this.getAnimationManager().play("activated"):this.getAnimationManager().play("deactivated-"+this.value)}canEnter(e){return 0===this.value}}class f extends u{constructor(e,t){super(e),this.direction=t,this.getAnimationManager().addAnimation((0).toString(),[30,31,32,33],{frameDuration:.08}),this.getAnimationManager().addAnimation(2..toString(),[40,41,42,43],{frameDuration:.08}),this.getAnimationManager().addAnimation(1..toString(),[50,51,52,53],{frameDuration:.08}),this.getAnimationManager().addAnimation(3..toString(),[60,61,62,63],{frameDuration:.08}),this.getAnimationManager().play(t.toString())}onAfterPlayerIn(e,t){return e.move(this.direction,"idle"),this}}class m extends u{constructor(e,t){super(e),this.angle=t,this.getAnimationManager().addAnimation(1..toString(),[70]),this.getAnimationManager().addAnimation((0).toString(),[71]),this.getAnimationManager().addAnimation(2..toString(),[72]),this.getAnimationManager().addAnimation(3..toString(),[73]),this.getAnimationManager().addAnimation(5..toString(),[74]),this.getAnimationManager().addAnimation(4..toString(),[75]),this.getAnimationManager().addAnimation(6..toString(),[76]),this.getAnimationManager().addAnimation(7..toString(),[77]),this.getAnimationManager().addAnimation(8..toString(),[78]),this.getAnimationManager().addAnimation(9..toString(),[79]),this.getAnimationManager().play(t.toString())}onAfterPlayerOut(){switch(this.angle){case 0:this.angle=2;break;case 1:this.angle=0;break;case 2:this.angle=3;break;case 3:this.angle=1;break;case 4:this.angle=5;break;case 5:this.angle=4;break;case 6:this.angle=7;break;case 7:this.angle=8;break;case 8:this.angle=9;break;case 9:this.angle=6}this.getAnimationManager().play(this.angle.toString())}canEnter(e){switch(this.angle){case 0:return[1,3].includes(e);case 1:return[1,2].includes(e);case 2:return[0,3].includes(e);case 3:return[0,2].includes(e);case 4:return[2,3].includes(e);case 5:return[0,1].includes(e);case 6:return 1===e;case 7:return 3===e;case 8:return 0===e;case 9:return 2===e}}canLeave(e){switch(this.angle){case 0:return[0,2].includes(e);case 1:return[0,3].includes(e);case 2:return[1,2].includes(e);case 3:return[1,3].includes(e);case 4:return[2,3].includes(e);case 5:return[0,1].includes(e);case 6:return 0===e;case 7:return 2===e;case 8:return 1===e;case 9:return 3===e}}}class p extends u{constructor(e){super(e)}render(e){}}class v extends u{constructor(e){super(e),this.active=!1,this.getAnimationManager().addAnimation("inactive",[20]),this.getAnimationManager().addAnimation("active",[21,22,23,24,23,22],{frameDuration:.1}),this.getAnimationManager().play("inactive")}onAfterPlayerIn(e,t){return this.isActive()&&(e.setImmobility(!0),e.getAnimationManager().play("turn"),setTimeout(()=>{t.nextLevel()},480)),this}activate(){this.active=!0,this.getAnimationManager().play("active")}isActive(){return this.active}}class g extends u{constructor(e){super(e),this.getAnimationManager().addAnimation("idle",[10]),this.getAnimationManager().play("idle")}onAfterPlayerIn(e,t){return null}}class y extends u{constructor(e){super(e),this.getAnimationManager().addAnimation("idle",[2]),this.getAnimationManager().play("idle")}onAfterPlayerIn(e,t){return e.move(e.getDirection(),"idle"),this}}class b extends u{constructor(e){super(e),this.getAnimationManager().addAnimation("idle",[1]),this.getAnimationManager().play("idle")}onBeforePlayerIn(e){e.getAnimationManager().play("jump-"+1..toString(),!0)}onAfterPlayerIn(e,t){return e.move(e.getDirection(),null),this}canEnter(e){return 1!==e}}const w={"#":e=>new h(e),S:e=>new p(e),E:e=>new v(e),$:e=>new g(e),"^":e=>new f(e,0),v:e=>new f(e,1),">":e=>new f(e,2),"<":e=>new f(e,3),T:e=>new m(e,0),F:e=>new m(e,1),J:e=>new m(e,2),L:e=>new m(e,3),"=":e=>new m(e,5),H:e=>new m(e,4),8:e=>new m(e,6),6:e=>new m(e,7),2:e=>new m(e,8),4:e=>new m(e,9),B:e=>new d(e,1),B2:e=>new d(e,2),B3:e=>new d(e,3),"!":e=>new y(e),U:e=>new b(e)};class ${constructor(e,t){this.x=e,this.y=t}clone(){return new $(this.x,this.y)}static angleBetween(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}}class x{constructor(){this.canvas=document.getElementById("joystick"),this.ctx=this.canvas.getContext("2d"),this.outerRadius=8,this.innerRadius=5,this.startPosition=new $(0,0),this.pointerPosition=new $(0,0),this.scale=1}render(){this.canvas.width=2*this.outerRadius*this.scale+120,this.canvas.height=2*this.outerRadius*this.scale+120,this.canvas.style.left=this.startPosition.x-this.canvas.width/2+"px",this.canvas.style.top=this.startPosition.y-this.canvas.height/2+"px",this.ctx.save(),this.ctx.scale(this.scale,this.scale),this.ctx.translate(120/this.scale/2,120/this.scale/2),this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.arc(this.outerRadius,this.outerRadius,this.outerRadius,0,2*Math.PI,!1),this.ctx.fillStyle="#999",this.ctx.fill(),this.ctx.strokeStyle="#666",this.ctx.stroke();const e=this.getAxisValues();e.x*=this.innerRadius,e.y*=this.innerRadius,this.ctx.beginPath(),this.ctx.arc(this.outerRadius+e.x,this.outerRadius+e.y,this.innerRadius,0,2*Math.PI,!1),this.ctx.fillStyle="#555",this.ctx.fill(),this.ctx.strokeStyle="#333",this.ctx.stroke(),this.ctx.restore()}getStartPosition(){return this.startPosition}setStartPosition(e){this.startPosition=e}getPointerPosition(){return this.pointerPosition}setPointerPosition(e){this.pointerPosition=e}show(){this.canvas.style.display="block"}hide(){this.canvas.style.display="none"}getScale(){return this.scale}setScale(e){this.scale=e}getAxisValues(){const e=this.startPosition.clone();e.x/=this.scale,e.y/=this.scale;const t=this.pointerPosition.clone();t.x/=this.scale,t.y/=this.scale;const n=$.angleBetween(e,t),i=t.x-e.x,r=t.y-e.y;let o=Math.sqrt(i*i+r*r);const s=new $(0,0);return o=Math.min(o,this.innerRadius),s.x=o*Math.cos(n),s.y=o*Math.sin(n),s.x/=this.innerRadius,s.y/=this.innerRadius,s}}class k{constructor(e,t){this.width=e,this.height=t}clone(){return new k(this.width,this.height)}}class S{constructor(e){this.cells=[];for(let t=0;t<e.length;t+=1){this.cells[t]=[];for(let n=0;n<e[t].length;n+=1){const i=e[t][n];"."!==i&&(this.cells[t][n]=w[i](new $(n,t)))}}this.endCell=this.getEndCell(),this.nbCoins=null}update(e){0===this.nbCoins&&(this.endCell.isActive()||this.endCell.activate()),this.nbCoins=0;for(let t=0;t<this.cells.length;t+=1)for(let n=0;n<this.cells[t].length;n+=1){const i=this.cells[t][n];void 0!==i&&i.update(e),i instanceof g&&(this.nbCoins+=1)}}render(e){for(let t=0;t<this.cells.length;t+=1)for(let n=0;n<this.cells[t].length;n+=1){const i=this.cells[t][n];void 0!==i&&i.render(e)}}getCell(e){return void 0!==this.cells[e.y]&&void 0!==this.cells[e.y][e.x]?this.cells[e.y][e.x]:null}getCellAt(e,t){return this.getCell(new $(e,t))}onAfterPlayerOut(e){const t=this.getCellAt(e.x,e.y);null!==t&&t.onAfterPlayerOut()}onAfterPlayerIn(e,t,n){const i=this.getCellAt(e.x,e.y);if(null!==i){const r=i.onAfterPlayerIn(t,n);i!==r&&(this.cells[e.y][e.x]=null===r?void 0:r)}}getStartPosition(){for(let e=0;e<this.cells.length;e+=1)for(let t=0;t<this.cells[e].length;t+=1){const n=this.cells[e][t];if(n instanceof p)return n.getPosition().clone()}return null}getSize(){return new k(this.cells[0].length,this.cells.length)}getDisplayedSize(){const e=this.getSize().clone();return e.width*=16,e.height*=16,e}getEndCell(){if(this.endCell instanceof v)return this.endCell;for(let e=0;e<this.cells.length;e+=1)for(let t=0;t<this.cells[e].length;t+=1){const n=this.cells[e][t];if(n instanceof v)return n}return null}}function B(e,t,n){return e*(1-n)+t*n}class E{constructor(e){this.game=e,this.map=this.game.getMap();const t=this.map.getStartPosition(),n=t.x,i=t.y;this.position=new $(n,i),this.previousPosition=this.position.clone(),this.startPosition=new $(16*n,16*i),this.targetPosition=this.startPosition.clone(),this.displayPosition=this.startPosition.clone(),this.canmove=!0,this.immobility=!1,this.timer=0,this.direction=1;const r=c.getImage("player");this.animationManager=new l(r,14,19),this.animationManager.addAnimation("idle-"+(0).toString(),[3]),this.animationManager.addAnimation("idle-"+1..toString(),[9]),this.animationManager.addAnimation("idle-"+2..toString(),[6]),this.animationManager.addAnimation("idle-"+3..toString(),[0]),this.animationManager.addAnimation("walk-"+(0).toString(),[3,4,5,3],{frameDuration:.08,loop:!1}),this.animationManager.addAnimation("walk-"+1..toString(),[9,10,11,9],{frameDuration:.08,loop:!1}),this.animationManager.addAnimation("walk-"+2..toString(),[6,7,6],{frameDuration:.08,loop:!1}),this.animationManager.addAnimation("walk-"+3..toString(),[0,1,0],{frameDuration:.08,loop:!1}),this.animationManager.addAnimation("jump-"+1..toString(),[12,13,9],{frameDuration:.1,loop:!1}),this.animationManager.addAnimation("turn",[9,0,3,6],{frameDuration:.1,loop:!0}),this.animationManager.play("turn"),setTimeout(()=>{this.animationManager.play("idle-"+this.direction.toString())},480)}update(e){if(this.animationManager.update(e),!this.canmove){if(this.timer+=5*e,this.displayPosition.x=B(this.startPosition.x,this.targetPosition.x,this.timer),this.displayPosition.y=B(this.startPosition.y,this.targetPosition.y,this.timer),this.timer>=.5){const e=this.map.getSize();if(this.position.x<=-1)return this.runEvents(),void this.moveFromBound(3);if(this.position.y<=-1)return this.runEvents(),void this.moveFromBound(0);if(this.position.x>=e.width)return this.runEvents(),void this.moveFromBound(2);if(this.position.y>=e.height)return this.runEvents(),void this.moveFromBound(1)}this.timer>=1&&(this.timer=0,this.canmove=!0,this.displayPosition=this.targetPosition.clone(),this.runEvents())}}render(e){e.save(),e.translate(this.displayPosition.x+1,this.displayPosition.y-8),this.animationManager.render(e),e.restore()}move(e,t="walk"){if(this.immobility)return;if(!this.canmove)return;switch(t){case"walk":this.animationManager.play("walk-"+e.toString(),!0);break;case"idle":this.animationManager.play("idle-"+e.toString(),!0)}let n=this.computeNewMapPosition(e,!0);const i=this.map.getCell(this.position),r=this.map.getCell(n);i instanceof u&&i.canLeave(e)||r instanceof u&&r.canEnter(e)||(this.direction=e,r instanceof u&&r.onBeforePlayerIn(this),n=this.computeNewMapPosition(e),this.moveTo(n))}isAbleToMove(){return this.canmove}moveTo(e){this.previousPosition=this.position,this.position=e,this.canmove=!1,this.startPosition=this.targetPosition.clone(),this.targetPosition.x=16*this.position.x,this.targetPosition.y=16*this.position.y}getDirection(){return this.direction}getDisplayPosition(){return this.displayPosition}getAnimationManager(){return this.animationManager}setImmobility(e){this.immobility=e}moveFromBound(e){const t=this.map.getSize();switch(this.canmove=!0,e){case 3:this.position.x=t.width,this.startPosition=new $(16*(this.position.x+1),16*this.position.y);break;case 2:this.position.x=-1,this.startPosition=new $(16*(this.position.x-1),16*this.position.y);break;case 0:this.position.y=t.height,this.startPosition=new $(16*this.position.x,16*(this.position.y+1));break;case 1:this.position.y=-1,this.startPosition=new $(16*this.position.x,16*(this.position.y-1))}this.targetPosition=this.startPosition.clone(),this.move(e)}runEvents(){this.map.onAfterPlayerOut(this.previousPosition),this.map.onAfterPlayerIn(this.position,this,this.game)}computeNewMapPosition(e,t=!1){const n=this.position.clone();switch(e){case 0:n.y-=1;break;case 1:n.y+=1;break;case 2:n.x+=1;break;case 3:n.x-=1}if(t){const e=this.map.getSize();n.x<=-1&&(n.x=e.width-1),n.y<=-1&&(n.y=e.height-1),n.x>=e.width&&(n.x=0),n.y>=e.height&&(n.y=0)}return n}}const L={Halley:{map:"\n      # # # # # # # # #\n      # # # . E . # # #\n      # # . . . . . # #\n      # $ . . . . . $ #\n      # $ . . . . . $ #\n      # $ . . . . . $ #\n      # # . . S . . # #\n      # # # . . . # # #\n      # # # # # # # # #\n    "},Encke:{map:"\n      # # # # # # # # # # #\n      # $ . . . . . . . $ #\n      # . . . . . . . . . #\n      # . . # # . # # . . #\n      # . . # $ . $ # . . #\n      # . . . . E . . . . #\n      # . . # $ . $ # . . #\n      # . . # # . # # . . #\n      # . . . . S . . . . #\n      # $ . . . . . . . $ #\n      # # # # # # # # # # #\n    "},Biela:{map:"\n      # # # # # # # # #\n      # # . . E . . # #\n      # # . . . . . # #\n      # $ > . . . < $ #\n      # $ # . # . # $ #\n      # $ < . . . > $ #\n      # # . . S . . # #\n      # # . . . . . # #\n      # # # # # # # # #\n    "},Faye:{map:"\n      # # # # # # # # #\n      # # # # E # # # #\n      # # # # . # # # #\n      # . . > . > . . #\n      # $ . # # # . $ #\n      # # ^ # $ # v # #\n      # # ^ . . . v # #\n      # . . . S . . . #\n      # # # # # # # # #\n    "},Brorsen:{map:"\n      # # # # # # # # #\n      # S . ! ! ! ! . #\n      # # # # # # ! . #\n      # $ $ $ $ $ # . #\n      # # # # ! ! # . #\n      # ! ! ! # ! # . #\n      # ! $ ! . ! # . #\n      # ! ! ! . . . E #\n      # # # # # # # # #\n    "},Tuttle:{map:"\n      # # # # # # # # #\n      # S # . . . . . #\n      # . ! # . . . $ #\n      # # ! $ # $ . . #\n      # . ! ! ! ! # . #\n      # . # . # # . . #\n      # . . . # . . . #\n      # . $ . # . . E #\n      # # # # # # # # #\n    "},Tempel:{map:"\n      # # # # # # # # #\n      # . . . S . . . #\n      # . . # . # . . #\n      # # # # $ # # # #\n      # . . $ H $ . . #\n      # . # # $ # # . #\n      # . . # . # . . #\n      # . . . E . . . #\n      # # # # # # # # #\n    "},Olbers:{map:"\n      # # # # # # # # #\n      # . . . . . . . #\n      # . . # # # . . #\n      # . # # $ # # . #\n      # S . $ J $ # . #\n      # . # # $ # # . #\n      # . . # # # . . #\n      # . . . E . . . #\n      # # # # # # # # #\n    "},Wolf:{map:"\n      # # # # # # # # #\n      # $ . . # . . $ #\n      # . . # # # . . #\n      # . . . # . . . #\n      # S . . B . . E #\n      # . . . # . . . #\n      # . . # # # . . #\n      # $ . . # . . $ #\n      # # # # # # # # #\n    "},Finlay:{map:"\n      # # # # # # # # #\n      # S . B . . . $ #\n      # . . # . # . . #\n      # . # . . . # . #\n      # . B . $ . # . #\n      # B # . . . # . #\n      # . . # # # # # #\n      # $ . . . . . E #\n      # # # # # # # # #\n    "},Brooks:{map:"\n      # # # # # # # # #\n      # S . . # . . . #\n      # . . . # # . $ #\n      # # # L = # . . #\n      # . # L T $ . . #\n      # . # # # # . . #\n      # . . . . . $ . #\n      # . . . E . . . #\n      # # # # # # # # #\n    "},Holmes:{map:"\n      # # # # # # # # #\n      # . . . . . . . #\n      # . S . . $ $ # #\n      # . . . # . . . #\n      # . . = ! ! ! ! #\n      # . . # . # # # #\n      # $ . # . . . . #\n      # . . # $ . . E #\n      # # # # # # # # #\n    "},Borrelly:{map:"\n      # # # # # # # # #\n      # S # # # . ! # #\n      # . . ! ! $ ! $ #\n      # # # ! ! . ! . #\n      # . . ! ! ! ! ! #\n      # . . . ! # . # #\n      # # # # ! # . . #\n      # . $ . $ # . E #\n      # # # # # # # # #\n    "},Westphal:{map:"\n      # # # # # # # # # # # #\n      # $ . = . . . . . . . #\n      # . . # . . $ . . . . #\n      # # H # . # # # . . . #\n      # . . . = S E . J . $ #\n      # # H # . # # # . . . #\n      # . . # . . $ . . . . #\n      # $ . = . . . . . . . #\n      # # # # # # # # # # # #\n    "},Kopff:{map:"\n      # # # # # # # # # # # # # # # # # # # #\n      # S . . . . . . . . . . . . # . . . $ #\n      # . # # # # # # # # # . # . # . # . . #\n      # . . . . # . . . . . . # . # # # . # #\n      # # # # . # . # # # # # # . # . . . . #\n      # . . . . # . # . # . . . . # . # # . #\n      # . # # . # . # . # . # # # # . # . . #\n      # . . # . . . . . # . . . . . . # . # #\n      # # . # # # # # . # # # # . # . # . . #\n      # . . # . . . # . # . . . . # . # # # #\n      # . # # . # . # . # # # # . # . . . . #\n      # . . . . # . # . # . . . . # # # # . #\n      # # # # # # . # . # . # # # # . # . . #\n      # . # . . . . # . # . . # . . . # . # #\n      # . . . # . # # . # # . # . # # # . . #\n      # . # # # . # . . . . . # . # . # # . #\n      # . # . . . # # # # # # # . # . . . . #\n      # . # # # # # . # . . . # . # . # # # #\n      # $ . . . . . . . . # . . . # . . . E #\n      # # # # # # # # # # # # # # # # # # # #\n    "},Schaumasse:{map:"\n      # # # # # # # # #\n      # $ . # S # $ . #\n      # . . ! ! ! . . #\n      # ! ! ! ! ! ! ! #\n      # ! $ ! B ! $ ! #\n      # ! ! ! ! ! ! ! #\n      # # # . . . # # #\n      # . . . . . . E #\n      # # # # # # # # #\n    "},Crommelin:{map:"\n      # # # # # # # # #\n      # S . . ! . . . #\n      # . $ # ! . $ . #\n      # # # # ! # # # #\n      # ! ! ! L ! ! ! #\n      # B # # ! # # . #\n      # . $ # ! . $ . #\n      # . . B ! # . E #\n      # # # # # # # # #\n    "},Reinmuth:{map:"\n      # # # # # # # # #\n      # $ . . E . . $ #\n      # $ $ . . . $ $ #\n      # # # # ^ # # # #\n      # $ B B $ B B $ #\n      # B # # ^ # # B #\n      # B # # ^ # # B #\n      # $ B B $ B B $ #\n      # B # # B # # ^ #\n      # B # # B # # ^ #\n      # $ B B $ B B $ #\n      # B # # ^ # # B #\n      # B # # ^ # # B #\n      # $ B B S B B $ #\n      # # # # # # # # #\n    "},Daniel:{screenWidth:13,screenHeight:13,map:"\n      # # # # # # # # # # # # #\n      # $ . . . . . B . . . $ #\n      # . . . . . . # . . . . #\n      # ^ # # # # # # B # # # #\n      # . . . . . . . . # . . #\n      # . $ . T = T . . # . $ #\n      # . $ . H $ H . . # . $ #\n      # . $ . F = T . . # . $ #\n      # . . . . . . . . # . . #\n      # ^ # B # # # # # # . . #\n      # . . . . . . . . # . . #\n      # . S . $ $ $ . . > . E #\n      # # # # # # # # # # # # #\n    "},Gale:{map:"\n      #  #  #  #  #  #  #  #  #\n      #  S  #  .  .  .  .  .  #\n      #  .  #  #  .  .  $  .  #\n      #  .  .  #  #  .  .  .  #\n      #  .  $  .  #  #  B2 #  #\n      #  .  $  $  .  .  .  .  #\n      #  #  .  $  .  .  .  .  #\n      #  #  #  .  .  .  .  E  #\n      #  #  #  #  #  #  #  #  #\n    "},Whipple:{map:"\n      #  #  #  #  #  #  #  #  #\n      #  S  .  .  #  .  .  .  #\n      #  .  $  .  #  .  $  .  #\n      #  .  .  #  .  .  .  .  #\n      #  v  v  #  B2 #  ^  ^  #\n      #  .  .  .  .  #  .  .  #\n      #  .  $  .  #  .  $  .  #\n      #  .  .  .  B  .  .  E  #\n      #  #  #  #  #  #  #  #  #\n    "},Forbes:{map:"\n      # # # # # # # # #\n      # # S . E . . # #\n      # . . . $ . . . #\n      # . # # # # 2 # #\n      # . # $ $ $ $ . #\n      # $ # . # . # . #\n      # . 6 B B B B B #\n      # . # $ $ $ $ # #\n      # # # # # # # # #\n    "},Oterma:{screenWidth:11,screenHeight:9,map:"\n      # # # # # # # # # # #\n      # $ . B . $ . B . $ #\n      # . . # . . . # . . #\n      # B # # # B # # # B #\n      # $ . B . S . B . $ #\n      # B # # # B # # # B #\n      # . . # . . . # . . #\n      # $ . B . E . B . $ #\n      # # # # # # # # # # #\n    "},Wirtanen:{map:"\n      # # # # # # # # #\n      # # # # E # # # #\n      # B . . . . . B #\n      # $ # # . # # $ #\n      # B . $ B $ . B #\n      # # # $ B $ # # #\n      # # # # . # # # #\n      # . . . S . . . #\n      # # # # # # # # #\n    "},Johnson:{map:"\n      # # # # # # # # #\n      # S . . # . # # #\n      # . . . B . . # #\n      # . . # # # . . #\n      # . $ T $ F $ . #\n      # . . . # . . . #\n      # # . . B . . . #\n      # # # . # . . E #\n      # # # # # # # # #\n    "},Arend:{map:"\n      # # # # # # # # #\n      # S # . # . . . #\n      # . # . # . # . #\n      # . 6 . 8 . $ . #\n      # B # # # . # . #\n      # $ < . < . $ . #\n      # . # . # . # . #\n      # . # . # . . E #\n      # # # # # # # # #\n    "},Harrington:{map:"\n      # # # # . # # # #\n      # S # # . . . . #\n      # . # # # # # . #\n      # . # . . # # . #\n      . . # # $ # # . .\n      # # # # . # # # #\n      . . . . . # . . .\n      # . . # . # . E #\n      # # # # . # # # #\n    "},Tsuchinshan:{map:"\n      #  #  #  #  #  #  #  #  #\n      #  $  B  $  #  .  .  #  #\n      #  B  2  B2 $  T  .  .  #\n      #  S  #  B  #  B  #  .  #\n      #  B  2  B2 $  J  .  .  #\n      #  .  #  $  #  $  #  .  #\n      #  .  #  B  #  #  #  .  #\n      #  .  .  .  .  .  .  E  #\n      #  #  #  #  #  #  #  #  #\n    "},Wild:{map:"\n      # # # # # # # # #\n      # . . . . < . $ #\n      # # . # v # # ^ #\n      # . . > $ B . . #\n      # S # # F B B E #\n      # . . > $ B . . #\n      # # . # ^ # # v #\n      # . . . . < . $ #\n      # # # # # # # # #\n    "},Kojima:{map:"\n      # # # # # # # # #\n      # S # . $ = $ . #\n      # . # . . # . . #\n      # $ = . B # B T #\n      # . F . J . T . #\n      # F B # # . B $ #\n      # . . # . . # . #\n      # . $ = $ . # E #\n      # # # # # # # # #\n    "},Klemola:{screenWidth:10,screenHeight:10,map:"\n      # # # # # # # # # #\n      # # # . . . . # # #\n      # # . . . . . . # #\n      # . . J J L L . . #\n      # S . H J $ H . . #\n      # . . H $ F H . E #\n      # . . T T F F . . #\n      # # . . . . . . # #\n      # # # . . . . # # #\n      # # # # # # # # # #\n    "},Taylor:{map:"\n      # # # # # # # # # # # # #\n      # . . . . . # . . . . . #\n      # . $ . . . # . . . $ . #\n      # . . . # F > . # . . . #\n      # . . # F J . L T # . . #\n      # . . . J . . . L T . . #\n      # # # ^ . . S . . v # # #\n      # . . L T . E . F . . . #\n      # . . # L T . F J # . . #\n      # . . . # . < J # . . . #\n      # . $ . . . # . . . $ . #\n      # . . . . . # . . . . . #\n      # # # # # # # # # # # # #\n    "},Kohoutek:{screenWidth:13,screenHeight:13,map:"\n      # # . # # # # # # # . # #\n      # . . . # . . . # . . . #\n      . . $ . # . $ . B . $ . .\n      # . . . # . . . # . . . #\n      # # B # # # B # # # B # #\n      # . . . # . . . # . . . #\n      # . $ . # . S . B . $ . #\n      # . . . # . . . # . . . #\n      # # B # # # B # # # B # #\n      # . . . # . . . # . . . #\n      # . $ . # . E . # . $ . #\n      # . . . # . . . # . . . #\n      # # . # # # # # # # . # #\n    "},Clark:{map:"\n      #  #  #  #  #  #  #  #  #\n      #  S  #  $  #  $  #  $  #\n      #  $  #  $  B  T  B  $  #\n      #  $  #  $  #  $  #  $  #\n      #  $  B  F  B2 $  #  $  #\n      #  $  #  $  #  $  #  $  #\n      #  $  #  $  B  J  B  $  #\n      #  $  B  $  #  $  #  E  #\n      #  #  #  #  #  #  #  #  #\n    "},Longmore:{map:"\n      #  #  #  #  #  #  #  #  #\n      #  $  L  $  8  =  8  .  #\n      #  .  F  B2 #  .  6  .  #\n      #  H  #  4  #  4  #  #  #\n      #  .  .  .  .  .  .  .  #\n      #  .  .  .  S  .  .  .  #\n      #  #  .  .  E  .  .  #  #\n      #  #  #  .  .  .  #  #  #\n      #  #  #  #  #  #  #  #  #\n    "},Gunn:{screenWidth:13,screenHeight:13,map:"\n      # # # # # # # # # # # # #\n      # $ . . . # $ . ! ! . $ #\n      # . . . . # . . ! ! . . #\n      # # # ! ! T ! ! ! ! # # #\n      # $ . ! ! ! B ! ! ! . $ #\n      # # v ! ! . # # ! ! # # #\n      # . . ! ! . $ . ! ! . $ #\n      # # # ! ! # B . ! ! # # #\n      # S . ! ! # ! ! ! ! . $ #\n      # # ! ! ! ! ! ! # ! # # #\n      # . . ! ! . . . # . . . #\n      # $ . ! ! . $ . # . . E #\n      # # # # # # # # # # # # #\n    "},Gehrels:{map:"\n      # # # # # # # # #\n      # ! . . # . . ! #\n      # ! $ . # . $ ! #\n      # ! . J B L . ! #\n      # ^ # H # H # ^ #\n      # ! $ L ! J $ ! #\n      # ! . ! ! ! . ! #\n      # ! S # E # . ! #\n      # # # # # # # # #\n    "},Helin:{map:"\n      # # # # # # # # #\n      # S . B . # . $ #\n      # . $ J $ 6 . . #\n      # . B # . # # 4 #\n      # B $ . J v . . #\n      # 4 # # . < v # #\n      # . . B ^ < . $ #\n      # $ . < . $ < E #\n      # # # # # # # # #\n    "},Russell:{screenWidth:11,screenHeight:11,map:"\n      # # # . # # # . # # #\n      # . . . $ S $ . . . #\n      # # # # # # # # # . #\n      B . $ . # . . $ # . .\n      # . # # # B # . 6 B #\n      # L . # $ . # # # . #\n      # . # # # B # . # . #\n      . . . . = . # . $ . .\n      # . # . # . # # # # #\n      # $ # . # . . . . E #\n      # # # . # # # . # # #\n    "},Giclas:{screenWidth:13,screenHeight:13,map:"\n      # # # # # # # # # # # # #\n      # . . . . . # . . . . . #\n      # # . $ . . # . . $ . # #\n      # . # . . F = T . . # . #\n      # . . # . H . H . # . . #\n      # . $ . F J . L T . $ . #\n      # . . . H . E . H . . . #\n      # # # F J . . . L T # # #\n      # . . H . . . . . H . . #\n      # . . L = = 8 = = J . . #\n      # $ . B . = 2 = . B . $ #\n      # . . # . . S . . # . . #\n      # # # # # # # # # # # # #\n    "},Boethin:{screenWidth:13,screenHeight:9,map:"\n      # # # # # # # # # # # # #\n      # $ . B . . $ . . B . $ #\n      # . F = T # H # F = T . #\n      # . H $ H $ H $ H $ . . #\n      # # 4 = J # H # 4 = = # #\n      # . H . . . H . H . . . #\n      # . H . S . H . H . E . #\n      # . . . . . . . . . . . #\n      # # # # # # # # # # # # #\n    "},Bus:{screenWidth:13,screenHeight:10,map:"\n      # # # # # # # # # # # # #\n      # . . B . $ # $ . B . . #\n      # . $ . # . # . # . $ . #\n      # . . # # F B T # # . . #\n      # . B 4 $ . . . $ 6 B . #\n      # # # . # . . . # . # # #\n      # # . L B # B # B J . # #\n      # # . B . . S . . B . # #\n      # . $ . # # E # # . $ . #\n      # # # # # # # # # # # # #\n    "},Howell:{map:"\n      # # # # # # # # #\n      # $ . . # . . $ #\n      # . F = 8 = T . #\n      # . H B S B H . #\n      # # 4 ! ! ! 6 # #\n      # . H B E B H . #\n      # . L = 2 = J . #\n      # $ . . # . . $ #\n      # # # # # # # # #\n    "},Sanguin:{map:"\n      # # # # # # # # #\n      # $ . . F . . . #\n      # # # B H B S . #\n      # . B . H . B . #\n      # L = = B = = J #\n      # . B . H . B $ #\n      # $ # B H B # # #\n      # E # . L . $ . #\n      # # # # # # # # #\n    "},Lovas:{map:"\n      # # # # # # # # #\n      # S # . B . # . #\n      # . B $ # $ B # #\n      # . J . B . J . #\n      # . B # . # # . #\n      # . J $ J $ # . #\n      # E # # $ # # . #\n      # . < . B . . $ #\n      # # # # # # # # #\n    "},Chiron:{screenWidth:13,screenHeight:13,map:"\n      # # # # # # # # # # # # #\n      # ! ! ! ! # ! ! ! ! ! # #\n      # ! $ ! ! ! ! ! ! ! T . #\n      # ! ! ! ! ! ! ! ! # . . #\n      # ! ! ! ! # B # # . $ . #\n      # ! ! ! # . . . # . . . #\n      # 6 # # # . S . # # # 6 #\n      # . . . # . E . # . . . #\n      # . $ . # # B # # . $ . #\n      # . . # . . H . . # . . #\n      # . L = = T 6 F = = J . #\n      # # . . . L 2 J . . . . #\n      # # # # # # # # # # # # #\n    "},Machholz:{map:"\n      # # . # . # . # #\n      # $ . # $ # . $ #\n      . # B # . # B # .\n      T . . F H T . . F\n      4 = = = S = = = 6\n      J . . L H J . . L\n      . # B # . # B # .\n      # $ . # $ # . $ #\n      # # . # E # . # #\n    "},Takamizawa:{screenWidth:11,screenHeight:11,map:"\n      # # # # # # # # # # # # #\n      # E . . . B . $ . $ . . #\n      # . . . . # # # # # # . #\n      # # # # B T $ $ $ $ . . #\n      # $ . . . H $ $ $ $ # . #\n      # # # $ . L = F = = T # #\n      # # # F = = = H = = J # #\n      # . . H . $ . H . $ . # #\n      # . . H # # # H # # # . #\n      # . . H . $ . ! . $ $ . #\n      # . . . . $ . ! . $ $ . #\n      # . . . S . . B . . . . #\n      # # # # # # # # # # # # #\n    "},Kowal:{screenWidth:13,screenHeight:13,map:"\n      # # # # # # # # # # # # #\n      # . . . # . . . # . . . #\n      # . $ . # . E . # . $ . #\n      # . . . F T . F T . . . #\n      # . . F J L = J L T . . #\n      # # # H $ . # . $ H # # #\n      # . . L T . # . F J . . #\n      # . . . L T # F J . . . #\n      # . . . . L F J . . . . #\n      # # . . . . H . . . . # #\n      # # # . . . . . . . # # #\n      # # # # . . S . . # # # #\n      # # # # # # # # # # # # #\n    "},Hartley:{screenWidth:13,screenHeight:13,map:"\n      # # # # # # # # # # # # #\n      # . . . # . . . # . . . #\n      # . $ . 4 . $ . 6 . $ . #\n      # . . . # . . . # . . . #\n      # # # 8 B F # T B 8 # # #\n      # . . . # . . . # . . . #\n      # . $ . 6 . S . 4 . $ . #\n      # . . . # . . . # . . . #\n      # # # 2 B L # J B 2 # # #\n      # . . . # . . . # . . . #\n      # . $ . 4 . E . 6 . $ . #\n      # . . . # . . . # . . . #\n      # # # # # # # # # # # # #\n    "}};function A(e){let t=e.replace(/^ +/gm,"");t=t.replace(/ +/g," ");let n=t.split(/\n/);n=n.filter(e=>e.length>0);const i=[];for(const e of n){const t=e.split(" ");i.push(t)}return i}class M{getLevels(){const e={};let t=1;for(const[n,i]of Object.entries(L)){const r={map:A(i.map),number:t,name:n,screenWidth:"screenWidth"in i?i.screenWidth:9,screenHeight:"screenHeight"in i?i.screenHeight:9};e[n]=r,t+=1}return e}}class T{constructor(e){this.levelManager=e}getLevels(){const e={},t=this.getLevelsUser();let n=null;for(const[i,r]of Object.entries(this.levelManager.getLevels())){let o=!1;o=!!t[i].success||(null===n||n.user.success);const s={fixed:r,dynamic:{accessible:o},user:t[i]};e[i]=s,n=s}return e}successfulLevel(e){const t=this.getStoredLevels();t[e].success=!0,this.saveLevels(t)}reset(){localStorage.clear()}getNextLevelOf(e){const t=this.getLevels(),n=Object.keys(t),i=n.indexOf(e)+1,r=n[i];return r in t?t[r]:null}areAllLevelsSucceeded(){const e=this.getLevels();for(const[t,n]of Object.entries(e))if(!n.user.success)return!1;return!0}getLevelsUser(){const e={};for(const[t]of Object.entries(this.levelManager.getLevels()))e[t]={success:!1};const t=this.getStoredLevels();for(const[n,i]of Object.entries(t))n in e&&(e[n]=i);return this.saveLevels(e),e}getStoredLevels(){if(null!==localStorage.getItem("levels")){const e=localStorage.getItem("levels");let t={};try{t=JSON.parse(e)}catch(e){return{}}return t}return{}}saveLevels(e){localStorage.setItem("levels",JSON.stringify(e))}}const P=new class{constructor(){const e=new M;this.storage=new T(e)}getStorage(){return this.storage}loadLevels(){this.levels=this.storage.getLevels()}getLevels(){return this.levels}},z=new k(144,144),H=z.clone();function j(e=!1){const t=e?H:z,n=document.getElementById("topbar"),i=n instanceof HTMLElement?n.clientHeight:0,r=window.innerWidth/t.width,o=(window.innerHeight-i)/t.height,s=Math.min(r,o),a=t.width*s,l=t.height*s;return{size:new k(a,l),zoom:s}}class C{constructor(e,t){this.gameScreen=e,this.canvas=document.getElementById("game"),this.ctx=this.canvas.getContext("2d"),this.lastUpdate=Date.now(),this.zoom=1,this.listen(),this.keyboard=this.gameScreen.getKeyboard(),this.pointer=this.gameScreen.getPointer(),this.joystick=new x,this.joystick.setScale(this.zoom),this.currentLevelName=t,this.storage=P.getStorage();this.storage.getLevels()[this.currentLevelName].dynamic.accessible||r.a.route.set("/choose-level"),this.runLevel(),this.update()}update(){const e=Date.now(),t=(e-this.lastUpdate)/1e3;if(this.lastUpdate=e,this.pointer.press()){const e=document.getElementById("topbar"),t=this.pointer.getLastEvent().target;if(!e.contains(t)){const e=this.pointer.getPosition().clone();this.joystick.setStartPosition(e),this.joystick.show()}}this.pointer.release()&&this.joystick.hide(),this.keyboard.press("KeyR")&&this.runLevel(),this.updateCamera(t),this.movePlayer(t),this.map.update(t),this.player.update(t),this.render(this.ctx),this.pointer.update(t),this.animationFrame=requestAnimationFrame(()=>this.update())}render(e){e.clearRect(0,0,this.canvas.width,this.canvas.height),e.fillStyle="black",e.fillRect(0,0,this.canvas.width,this.canvas.height);const t=this.map.getSize().clone();t.width*=16,t.height*=16;const n=c.getImage("background"),i=e.createPattern(n,"repeat");e.save(),e.translate(this.camera.getPosition().x,this.camera.getPosition().y),e.beginPath(),e.rect(0,0,t.width,t.height),e.fillStyle=i,e.fill(),this.map.render(e),this.player.render(e),e.restore(),this.joystick.render()}listen(){window.addEventListener("resize",this)}unlisten(){window.removeEventListener("resize",this)}handleEvent(e){switch(e.type){case"resize":this.resize(e)}}stop(){cancelAnimationFrame(this.animationFrame)}getZoom(){return this.zoom}getMap(){return this.map}nextLevel(){this.storage.successfulLevel(this.currentLevelName);const e=this.storage.getNextLevelOf(this.currentLevelName);if(e){const t=e.fixed.name;r.a.route.set("/level/"+t,{},{replace:!0})}else r.a.route.set("/end-game")}runLevel(){const e=this.storage.getLevels()[this.currentLevelName];var t,n;t=e.fixed.screenWidth,n=e.fixed.screenHeight,H.width=16*t,H.height=16*n,this.map=new S(this.storage.getLevels()[this.currentLevelName].fixed.map),this.camera=new o(new $(0,0),new k(100,100)),this.player=new E(this),this.resize()}resize(e=null){const t=j(!0);this.zoom=t.zoom,this.canvas.width=t.size.width/t.zoom,this.canvas.height=t.size.height/t.zoom,this.canvas.style.width=t.size.width+"px",this.canvas.style.height=t.size.height+"px",this.joystick.setScale(this.zoom),ce.resize()}getScreenSize(){return H}getJoystick(){return this.joystick}updateCamera(e){const t=this.getScreenSize().clone(),n=this.map.getDisplayedSize().clone(),i=this.player.getDisplayPosition().clone();i.x=-i.x,i.y=-i.y,i.x-=8,i.y-=8,i.x+=t.width/2,i.y+=t.height/2,i.x=s(i.x,-n.width+t.width,0),i.y=s(i.y,-n.height+t.height,0),this.camera.setPosition(i)}movePlayer(e){if(this.player.isAbleToMove()){let e=!1;(this.keyboard.down("ArrowUp")||this.keyboard.down("KeyW"))&&(0===this.player.getDirection()?e=!0:this.player.move(0)),(this.keyboard.down("ArrowDown")||this.keyboard.down("KeyS"))&&(1===this.player.getDirection()?e=!0:this.player.move(1)),(this.keyboard.down("ArrowRight")||this.keyboard.down("KeyD"))&&(2===this.player.getDirection()?e=!0:this.player.move(2)),(this.keyboard.down("ArrowLeft")||this.keyboard.down("KeyA"))&&(3===this.player.getDirection()?e=!0:this.player.move(3)),e&&this.player.move(this.player.getDirection())}this.updatePlayerFromJoystick()}updatePlayerFromJoystick(){if(this.pointer.down()){const e=document.getElementById("topbar"),t=this.pointer.getLastEvent().target;if(!e.contains(t)){this.joystick.setPointerPosition(this.pointer.getPosition());const e=this.getJoystick().getAxisValues(),t=.65;Math.abs(e.x)>Math.abs(e.y)?(e.x>=t&&this.player.move(2),e.x<=-t&&this.player.move(3)):(e.y>=t&&this.player.move(1),e.y<=-t&&this.player.move(0))}}}}class I{view(e){const t=e.attrs.level,n=[];n.push("level"),n.push(t.dynamic.accessible?"accessible":"unaccessible"),n.push(t.user.success?"success":"unsuccess");const i=n.join(" ");return r()("div",{class:i},[r()(r.a.route.Link,{href:"/level/"+t.fixed.name,onclick:e=>this.gotoLevel(e,t.fixed.name)},t.fixed.number)])}oncreate(){ce.resize()}gotoLevel(e,t){e.preventDefault();P.getStorage().getLevels()[t].dynamic.accessible&&r.a.route.set("/level/:level",{level:t})}}class O{oninit(){P.loadLevels()}view(e){const t=P.getLevels(),n=Object.values(t).map(e=>{const t={level:e};return r()(I,t)});return[r()("div",{id:"topbar"},[r()("div",{class:"topbar-gamename"},"Bobby"),r()("div",{class:"topbar-menu"},[r()(r.a.route.Link,{href:"/",class:"topbar-button"},"Retour")])]),r()("div",{class:"main-wrapper main-wrapper-unaligned",role:"main"},[r()("div",{class:"main-content"},[r()("div",{class:"levels"},n)])])]}}function F(e,t){return Math.floor(Math.random()*(t-e+1))+e}const R=["#222","#177355","#053123","#cf5600","#642d06"];class N{constructor(e){this.position=new $(0,0),this.position.x=F(0,e),this.position.y=0,this.velocity=new $(0,0),this.velocity.x=F(-40,40),this.velocity.y=F(180,360),this.color=R[F(0,R.length-1)],this.length=F(10,16),this.angle=F(-10,10)}update(e){this.velocity.y+=120*e,this.position.x+=this.velocity.x*e,this.position.y+=this.velocity.y*e}render(e){e.beginPath(),e.lineWidth=this.length/2,e.strokeStyle=this.color,e.moveTo(this.position.x,this.position.y),e.lineTo(this.position.x+this.angle,this.position.y+this.length),e.stroke()}isOutOfHeight(e){return this.position.y>e}}class D{constructor(){this.canvas=document.getElementById("game"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=800,this.canvas.height=500,this.lastUpdate=Date.now(),this.particles=[],this.listen(),this.resize(),this.update()}update(){const e=Date.now(),t=(e-this.lastUpdate)/1e3;this.lastUpdate=e,Math.random()>.7&&this.particles.push(new N(this.canvas.width));for(const e of this.particles)e.update(t),e.isOutOfHeight(this.canvas.height)&&(this.particles=this.particles.filter(t=>t!==e));this.render(this.ctx),this.animationFrame=requestAnimationFrame(()=>this.update())}stop(){cancelAnimationFrame(this.animationFrame)}render(e){e.clearRect(0,0,this.canvas.width,this.canvas.height);for(const t of this.particles)t.render(e)}listen(){window.addEventListener("resize",this)}unlisten(){window.removeEventListener("resize",this)}handleEvent(e){switch(e.type){case"resize":this.resize(e)}}resize(e=null){const t=j(!0);this.canvas.width=t.size.width,this.canvas.height=t.size.height,this.canvas.style.width=t.size.width+"px",this.canvas.style.height=t.size.height+"px",ce.resize()}}class J{view(){return[r()("div",{id:"topbar"},[r()("div",{class:"topbar-gamename"},"Bobby"),r()("div",{class:"topbar-menu"},[r()(r.a.route.Link,{href:"/",class:"topbar-button"},"Aller à l'écran d'accueil")])]),r()("div",{id:"app-wrapper",role:"main"},[r()("canvas",{id:"game"}),r()("div",{id:"end-game"},[r()("p",{class:"center"},"Félicitations, vous avez fini le jeu. 🎉"),r()("p",{class:"center"},"🥳 Merci d'avoir joué !")])])]}oncreate(e){P.getStorage().areAllLevelsSucceeded()||r.a.route.set("/choose-level"),ce.resize(),this.endGame=new D}onremove(e){this.endGame.stop(),this.endGame.unlisten()}}class _{constructor(){this.keys={},this.lasts=[],this.listen()}listen(){document.addEventListener("keyup",this),document.addEventListener("keydown",this)}unlisten(){document.removeEventListener("keyup",this),document.removeEventListener("keydown",this)}handleEvent(e){switch(e.type){case"keyup":this.onkeyup(e);break;case"keydown":this.onkeydown(e)}}up(e){return!this.keys[e]}down(e){return this.keys[e]}press(e){const t=this.keys[e];return this.keys[e]=!1,t}release(e){const t=this.lasts[this.lasts.indexOf(e)];return void 0!==t&&this.lasts.splice(this.lasts.indexOf(e),1),t===e}onkeyup(e){this.lasts.push(e.code),this.keys[e.code]=!1}onkeydown(e){this.keys[e.code]=!0}}class W{constructor(){this.position=new $(0,0)}setPosition(e){this.position=e}getPosition(){return this.position}}var U;!function(e){e[e.None=0]="None",e[e.Top=1]="Top",e[e.Bottom=2]="Bottom"}(U||(U={}));class q extends W{constructor(e=null){super(),this.click=null,this.mtime=0,this.loose=null,this.wheelValue=0,this.element=e instanceof HTMLElement?e:document.body,this.lastEvent=null,this.listen()}listen(){this.element.addEventListener("mousedown",this),this.element.addEventListener("mousemove",this),this.element.addEventListener("mouseup",this),this.element.addEventListener("wheel",this)}unlisten(){this.element.removeEventListener("mousedown",this),this.element.removeEventListener("mousemove",this),this.element.removeEventListener("mouseup",this),this.element.removeEventListener("wheel",this)}handleEvent(e){switch(this.lastEvent=e,e.type){case"mousedown":this.onMouseDown(e);break;case"mousemove":this.onMouseMove(e);break;case"mouseup":this.onMouseUp(e);break;case"wheel":this.onWheel(e)}}update(){this.mtime+=1,this.wheelValue=0}up(){return null===this.click}down(){return null!==this.click}press(){return this.click===this.mtime}release(){return this.loose===this.mtime}wheel(){return this.wheelValue<0?U.Top:this.wheelValue>0?U.Bottom:U.None}getLastEvent(){return this.lastEvent}onMouseDown(e){this.onMouseMove(e),this.click=this.mtime}onMouseMove(e){const t=new $(e.pageX-this.element.offsetLeft,e.pageY-this.element.offsetTop);this.setPosition(t)}onMouseUp(e){this.loose=this.mtime,this.click=null}onWheel(e){this.wheelValue=e.deltaY}}class K extends W{constructor(e=null){super(),this.click=null,this.mtime=0,this.loose=null,this.element=e instanceof HTMLElement?e:document.body,this.lastEvent=null,this.listen()}listen(){this.element.addEventListener("touchstart",this),this.element.addEventListener("touchmove",this),this.element.addEventListener("touchend",this)}unlisten(){this.element.removeEventListener("touchstart",this),this.element.removeEventListener("touchmove",this),this.element.removeEventListener("touchend",this)}handleEvent(e){switch(this.lastEvent=e,e.type){case"touchstart":this.onTouchDown(e);break;case"touchmove":this.onTouchMove(e);break;case"touchend":this.onTouchUp(e)}}update(){this.mtime+=1}up(){return null===this.click}down(){return null!==this.click}press(){return this.click===this.mtime}release(){return this.loose===this.mtime}wheel(){return U.None}getLastEvent(){return this.lastEvent}onTouchDown(e){this.onTouchMove(e),this.click=this.mtime}onTouchMove(e){const t=new $(e.targetTouches[0].pageX-this.element.offsetLeft,e.targetTouches[0].pageY-this.element.offsetTop);this.setPosition(t)}onTouchUp(e){this.loose=this.mtime,this.click=null}}class V{view(){return[r()("div",{id:"topbar"},[r()("div",{class:"topbar-level"},"Niveau X/Y"),r()("div",{class:"topbar-menu"},[r()("button",{onclick:Y,class:"topbar-button",title:"Recommencer le niveau"},"⟳"),r()("button",{onclick:G,class:"topbar-button topbar-button-menu"},"Menu"),r()("nav",{class:"topbar-menu-nav"},[r()("button",{onclick:Y,class:"topbar-nav-button"},"Recommencer le niveau"),r()(r.a.route.Link,{href:"/choose-level",class:"topbar-nav-button"},"Retourner au menu")])])]),r()("div",{id:"app-wrapper",role:"main"},[r()("canvas",{id:"game"}),r()("canvas",{id:"joystick",style:"display: none;"})])]}oncreate(e){ce.resize(),this.keyboard=new _,!function(){const e=" -webkit- -moz- -o- -ms- ".split(" ");if("ontouchstart"in window)return!0;const t=["(",e.join("touch-enabled),("),"heartz",")"].join("");return n=t,window.matchMedia(n).matches;var n}()?this.pointer=new q:this.pointer=new K;const t=e.attrs.level;this.game=new C(this,t),X(t),document.addEventListener("click",Q),document.body.classList.add("bg-dark","overflow-hidden")}onupdate(e){const t=e.attrs;this.game.stop(),this.game.unlisten();const n=t.level;this.game=new C(this,n),X(n)}onremove(e){this.game.stop(),this.game.unlisten(),document.removeEventListener("click",Q),document.body.classList.remove("bg-dark","overflow-hidden"),this.keyboard.unlisten(),this.pointer.unlisten()}getKeyboard(){return this.keyboard}getPointer(){return this.pointer}}function G(e){e.redraw=!1;const t=document.querySelector(".topbar-menu-nav");t instanceof HTMLElement&&t.classList.toggle("topbar-menu-nav-displayed")}function Y(e){e.redraw=!0;const t=document.querySelector(".topbar-menu-nav");t instanceof HTMLElement&&t.classList.remove("topbar-menu-nav-displayed")}function X(e){const t=document.querySelector(".topbar-level");if(t instanceof HTMLElement){const n=P.getStorage().getLevels(),i=Object.keys(n).length,r=n[e].fixed.number;t.innerText=`${r}/${i}`}}function Q(e){const t=document.querySelector(".topbar-button-menu"),n=document.querySelector(".topbar-menu-nav"),i=e.target;n.contains(i)||i===t||n.classList.remove("topbar-menu-nav-displayed")}class Z{view(){return[r()("div",{id:"topbar"},[r()("div",{class:"topbar-gamename"},"Bobby"),r()("div",{class:"topbar-menu"},[r()(r.a.route.Link,{href:"/",class:"topbar-button"},"Retour")])]),r()("div",{class:"main-wrapper main-wrapper-unaligned",role:"main"},[r()("div",{class:"main-content"},[r()("h2","Touches"),r()("p","Déplacer le personnage avec les flèches directionnelles 🡨 🡪 🡩 🡫 ou ZQSD, ou bien via la souris ou l'écran tactile (appuyer n'importe où pour faire apparaitre le joystick)."),r()("h2","Objectif"),r()("p","Réussir tous les niveaux."),r()("p","Pour chaque niveau, récupérer toutes les pièces puis atteindre la sortie."),r()("h2","Blocs"),r()("p","Les rochers vous bloque."),r()("p","Les tapis roulant vous emmène dans une direction donnée."),r()("p","Les boutons ne vous permettent qu'un nombre restreint de passages."),r()("p","Les tourniquets vous bloque certaines directions et tournent dans le sens horaire quand vous en sortez."),r()("p","La glace vous fait glisser jusqu'au prochain vide ou bloc solide que vous rencontrez.")])])]}oncreate(){ce.resize()}}class ee{view(){return[r()("div",{id:"topbar"},[r()("div",{class:"topbar-gamename"},"Bobby")]),r()("div",{class:"main-wrapper",role:"main"},[r()("div",{class:"main-content"},[r()("h1",{class:"logo"},"Bobby"),r()(r.a.route.Link,{href:"/choose-level",class:"btn-play"},"Jouer")])]),r()("div",{id:"bottombar"},[r()(r.a.route.Link,{href:"/help",class:"btn"},"Instructions"),r()(r.a.route.Link,{href:"/credits",class:"btn"},"Crédits"),r()(r.a.route.Link,{href:"/options",class:"btn"},"Options")])]}oncreate(){ce.resize()}}class te{view(){return[r()("div",{id:"topbar"},[r()("div",{class:"topbar-gamename"},"Bobby"),r()("div",{class:"topbar-menu"},[r()(r.a.route.Link,{href:"/",class:"topbar-button"},"Retour")])]),r()("div",{class:"main-wrapper",role:"main"},[r()("div",{class:"main-content"},[r()("button",{onclick:ne,class:"btn"},"Remise à zéro"),r()("p",{class:"center"},"Cela effacera votre progression et vous ramènera au niveau 1.")])])]}oncreate(){ce.resize()}}function ne(e){confirm("Êtes-vous sûr de vouloir effacer votre progression ?")&&(P.getStorage().reset(),alert("Votre progression a bien été effacée."))}const ie=["Yannick A. « Pif » : idée, code, graphisme."],re=["Merci à Aur36 pour son aide sur la réalisation de niveaux, ses nombreux\n  tests et retours et son enthousiasme sans limite.","Merci à oräkle - Ethan G. pour son assistance graphique.","Merci à Alceste_ pour ses améliorations de code et de fonctionnement\n  global.","Merci à Polyson pour sa proposition de niveaux à bords ouverts et ses divers\n  conseils et retours.","Merci aux membres du groupe de développement dont je fais partie pour leur\n  soutien dans le développement du projet, et pour leurs divers retours."];class oe{view(){return[r()("div",{id:"topbar"},[r()("div",{class:"topbar-gamename"},"Bobby"),r()("div",{class:"topbar-menu"},[r()(r.a.route.Link,{href:"/",class:"topbar-button"},"Retour")])]),r()("div",{class:"main-wrapper main-wrapper-unaligned",role:"main"},[r()("div",{class:"main-content"},[r()("h2","Crédits"),ie.map(e=>r()("p",e)),r()("h2","Remerciements"),re.map(e=>r()("p",e)),r()("h2","Code source"),r()("p","Code source sous licence libre AGPLv3+."),r()("p",[r()("a",{href:"https://gitlab.com/yannicka/bobby"},"https://gitlab.com/yannicka/bobby")])])])]}oncreate(){ce.resize()}}var se=n.p+"7ff4cd8bde819c245725fc7bd2aa13c5.png",ae=n.p+"d97d7a9c3693111bc7afc3f0d2c0d00f.png",le=n.p+"b2040711e41243c1d0d633d0da9e73e7.png";class ce{constructor(){const e=c.load({background:se,player:ae,tiles:le});this.app=document.getElementById("app"),Promise.all(e).then(()=>{this.init()})}init(){window.addEventListener("resize",ce.resize),r.a.route(this.app,"/",{"/":ee,"/options":te,"/help":Z,"/credits":oe,"/choose-level":O,"/level/:level":V,"/end-game":J}),ce.resize()}static resize(e=null){const t=document.getElementById("app"),n=j(!!document.getElementById("game")),i=window.innerHeight;t.style.width=n.size.width+"px",t.style.height=i+"px"}}var ue=n(15);n(28);new ce;ue.install()}]);